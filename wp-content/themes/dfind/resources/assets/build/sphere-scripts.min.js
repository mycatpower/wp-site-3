"use strict";var THREE={REVISION:"74"};"function"==typeof define&&define.amd?define("three",THREE):"undefined"!=typeof exports&&"undefined"!=typeof module&&(module.exports=THREE),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Math.sign&&(Math.sign=function(t){return 0>t?-1:0<t?1:+t;}),void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function get(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1];}}),void 0===Object.assign&&Object.defineProperty(Object,"assign",{writable:!0,configurable:!0,value:function value(t){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var e=Object(t),r=1,i=arguments.length;r!==i;++r){if(null!=(n=arguments[r]))for(var n=Object(n),o=Object.keys(n),a=0,s=o.length;a!==s;++a){var h=o[a],c=Object.getOwnPropertyDescriptor(n,h);void 0!==c&&c.enumerable&&(e[h]=n[h]);}}return e;}}),THREE.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.MinEquation=103,THREE.MaxEquation=104,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.NeverDepth=0,THREE.AlwaysDepth=1,THREE.LessDepth=2,THREE.LessEqualDepth=3,THREE.EqualDepth=4,THREE.GreaterEqualDepth=5,THREE.GreaterDepth=6,THREE.NotEqualDepth=7,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.UVMapping=300,THREE.CubeReflectionMapping=301,THREE.CubeRefractionMapping=302,THREE.EquirectangularReflectionMapping=303,THREE.EquirectangularRefractionMapping=304,THREE.SphericalReflectionMapping=305,THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.HalfFloatType=1025,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGBEFormat=THREE.RGBAFormat,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.RGB_PVRTC_4BPPV1_Format=2100,THREE.RGB_PVRTC_2BPPV1_Format=2101,THREE.RGBA_PVRTC_4BPPV1_Format=2102,THREE.RGBA_PVRTC_2BPPV1_Format=2103,THREE.RGB_ETC1_Format=2151,THREE.LoopOnce=2200,THREE.LoopRepeat=2201,THREE.LoopPingPong=2202,THREE.InterpolateDiscrete=2300,THREE.InterpolateLinear=2301,THREE.InterpolateSmooth=2302,THREE.ZeroCurvatureEnding=2400,THREE.ZeroSlopeEnding=2401,THREE.WrapAroundEnding=2402,THREE.TrianglesDrawMode=0,THREE.TriangleStripDrawMode=1,THREE.TriangleFanDrawMode=2,THREE.Color=function(t){return 3===arguments.length?this.fromArray(arguments):this.set(t);},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function set(t){return t instanceof THREE.Color?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this;},setScalar:function setScalar(t){this.b=this.g=this.r=t;},setHex:function setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this;},setRGB:function setRGB(t,e,r){return this.r=t,this.g=e,this.b=r,this;},setHSL:function(){function t(t,e,r){return 0>r&&(r+=1),1<r&&(r-=1),r<1/6?t+6*(e-t)*r:.5>r?e:r<2/3?t+6*(e-t)*(2/3-r):t;}return function(e,r,i){return e=THREE.Math.euclideanModulo(e,1),r=THREE.Math.clamp(r,0,1),i=THREE.Math.clamp(i,0,1),0===r?this.r=this.g=this.b=i:(i=2*i-(r=.5>=i?i*(1+r):i+r-i*r),this.r=t(i,r,e+1/3),this.g=t(i,r,e),this.b=t(i,r,e-1/3)),this;};}(),setStyle:function setStyle(t){function e(e){void 0!==e&&1>parseFloat(e)&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.");}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var i=r[2];switch(r[1]){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i)){i=parseFloat(r[1])/360;var n=parseInt(r[2],10)/100,o=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(i,n,o);}}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(t)){if(3===(i=(r=r[1]).length))return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,this;if(6===i)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,this;}return t&&0<t.length&&(void 0!==(r=THREE.ColorKeywords[t])?this.setHex(r):console.warn("THREE.Color: Unknown color "+t)),this;},clone:function clone(){return new this.constructor(this.r,this.g,this.b);},copy:function copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this;},copyGammaToLinear:function copyGammaToLinear(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this;},copyLinearToGamma:function copyLinearToGamma(t,e){void 0===e&&(e=2);var r=0<e?1/e:1;return this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this;},convertGammaToLinear:function convertGammaToLinear(){var t=this.r,e=this.g,r=this.b;return this.r=t*t,this.g=e*e,this.b=r*r,this;},convertLinearToGamma:function convertLinearToGamma(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this;},getHex:function getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0;},getHexString:function getHexString(){return("000000"+this.getHex().toString(16)).slice(-6);},getHSL:function getHSL(t){t=t||{h:0,s:0,l:0};var e,r=this.r,i=this.g,n=this.b,o=Math.max(r,i,n),a=((h=Math.min(r,i,n))+o)/2;if(h===o)h=e=0;else{var s=o-h,h=.5>=a?s/(o+h):s/(2-o-h);switch(o){case r:e=(i-n)/s+(i<n?6:0);break;case i:e=(n-r)/s+2;break;case n:e=(r-i)/s+4;}e/=6;}return t.h=e,t.s=h,t.l=a,t;},getStyle:function getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")";},offsetHSL:function offsetHSL(t,e,r){var i=this.getHSL();return i.h+=t,i.s+=e,i.l+=r,this.setHSL(i.h,i.s,i.l),this;},add:function add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this;},addColors:function addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this;},addScalar:function addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this;},multiply:function multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this;},multiplyScalar:function multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this;},lerp:function lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this;},equals:function equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b;},fromArray:function fromArray(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this;},toArray:function toArray(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t;}},THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},THREE.Quaternion=function(t,e,r,i){this._x=t||0,this._y=e||0,this._z=r||0,this._w=void 0!==i?i:1;},THREE.Quaternion.prototype={constructor:THREE.Quaternion,get x(){return this._x;},set x(t){this._x=t,this.onChangeCallback();},get y(){return this._y;},set y(t){this._y=t,this.onChangeCallback();},get z(){return this._z;},set z(t){this._z=t,this.onChangeCallback();},get w(){return this._w;},set w(t){this._w=t,this.onChangeCallback();},set:function set(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._w=i,this.onChangeCallback(),this;},clone:function clone(){return new this.constructor(this._x,this._y,this._z,this._w);},copy:function copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this;},setFromEuler:function setFromEuler(t,e){if(!1==t instanceof THREE.Euler)throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var r=Math.cos(t._x/2),i=Math.cos(t._y/2),n=Math.cos(t._z/2),o=Math.sin(t._x/2),a=Math.sin(t._y/2),s=Math.sin(t._z/2),h=t.order;return"XYZ"===h?(this._x=o*i*n+r*a*s,this._y=r*a*n-o*i*s,this._z=r*i*s+o*a*n,this._w=r*i*n-o*a*s):"YXZ"===h?(this._x=o*i*n+r*a*s,this._y=r*a*n-o*i*s,this._z=r*i*s-o*a*n,this._w=r*i*n+o*a*s):"ZXY"===h?(this._x=o*i*n-r*a*s,this._y=r*a*n+o*i*s,this._z=r*i*s+o*a*n,this._w=r*i*n-o*a*s):"ZYX"===h?(this._x=o*i*n-r*a*s,this._y=r*a*n+o*i*s,this._z=r*i*s-o*a*n,this._w=r*i*n+o*a*s):"YZX"===h?(this._x=o*i*n+r*a*s,this._y=r*a*n+o*i*s,this._z=r*i*s-o*a*n,this._w=r*i*n-o*a*s):"XZY"===h&&(this._x=o*i*n-r*a*s,this._y=r*a*n-o*i*s,this._z=r*i*s+o*a*n,this._w=r*i*n+o*a*s),!1!==e&&this.onChangeCallback(),this;},setFromAxisAngle:function setFromAxisAngle(t,e){var r=e/2,i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this.onChangeCallback(),this;},setFromRotationMatrix:function setFromRotationMatrix(t){var e=(r=t.elements)[0];t=r[4];var r,i=r[8],n=r[1],o=r[5],a=r[9],s=r[2],h=r[6],c=e+o+(r=r[10]);return 0<c?(e=.5/Math.sqrt(c+1),this._w=.25/e,this._x=(h-a)*e,this._y=(i-s)*e,this._z=(n-t)*e):e>o&&e>r?(e=2*Math.sqrt(1+e-o-r),this._w=(h-a)/e,this._x=.25*e,this._y=(t+n)/e,this._z=(i+s)/e):o>r?(e=2*Math.sqrt(1+o-e-r),this._w=(i-s)/e,this._x=(t+n)/e,this._y=.25*e,this._z=(a+h)/e):(e=2*Math.sqrt(1+r-e-o),this._w=(n-t)/e,this._x=(i+s)/e,this._y=(a+h)/e,this._z=.25*e),this.onChangeCallback(),this;},setFromUnitVectors:function(){var t,e;return function(r,i){return void 0===t&&(t=new THREE.Vector3()),1e-6>(e=r.dot(i)+1)?(e=0,Math.abs(r.x)>Math.abs(r.z)?t.set(-r.y,r.x,0):t.set(0,-r.z,r.y)):t.crossVectors(r,i),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize(),this;};}(),inverse:function inverse(){return this.conjugate().normalize(),this;},conjugate:function conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this;},dot:function dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w;},lengthSq:function lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w;},length:function length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w);},normalize:function normalize(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this.onChangeCallback(),this;},multiply:function multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t);},multiplyQuaternions:function multiplyQuaternions(t,e){var r=t._x,i=t._y,n=t._z,o=t._w,a=e._x,s=e._y,h=e._z,c=e._w;return this._x=r*c+o*a+i*h-n*s,this._y=i*c+o*s+n*a-r*h,this._z=n*c+o*h+r*s-i*a,this._w=o*c-r*a-i*s-n*h,this.onChangeCallback(),this;},slerp:function slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);var r=this._x,i=this._y,n=this._z,o=this._w;if(0>(h=o*t._w+r*t._x+i*t._y+n*t._z)?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,h=-h):this.copy(t),1<=h)return this._w=o,this._x=r,this._y=i,this._z=n,this;var a=Math.sqrt(1-h*h);if(.001>Math.abs(a))return this._w=.5*(o+this._w),this._x=.5*(r+this._x),this._y=.5*(i+this._y),this._z=.5*(n+this._z),this;var s=Math.atan2(a,h),h=Math.sin((1-e)*s)/a;a=Math.sin(e*s)/a;return this._w=o*h+this._w*a,this._x=r*h+this._x*a,this._y=i*h+this._y*a,this._z=n*h+this._z*a,this.onChangeCallback(),this;},equals:function equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w;},fromArray:function fromArray(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this;},toArray:function toArray(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t;},onChange:function onChange(t){return this.onChangeCallback=t,this;},onChangeCallback:function onChangeCallback(){}},Object.assign(THREE.Quaternion,{slerp:function slerp(t,e,r,i){return r.copy(t).slerp(e,i);},slerpFlat:function slerpFlat(t,e,r,i,n,o,a){var s=r[i+0],h=r[i+1],c=r[i+2];r=r[i+3],i=n[o+0];var l=n[o+1],u=n[o+2];if(r!==(n=n[o+3])||s!==i||h!==l||c!==u){o=1-a;var d=s*i+h*l+c*u+r*n,p=0<=d?1:-1,E=1-d*d;E>Number.EPSILON&&(E=Math.sqrt(E),d=Math.atan2(E,d*p),o=Math.sin(o*d)/E,a=Math.sin(a*d)/E),s=s*o+i*(p*=a),h=h*o+l*p,c=c*o+u*p,r=r*o+n*p,o===1-a&&(s*=a=1/Math.sqrt(s*s+h*h+c*c+r*r),h*=a,c*=a,r*=a);}t[e]=s,t[e+1]=h,t[e+2]=c,t[e+3]=r;}}),THREE.Vector2=function(t,e){this.x=t||0,this.y=e||0;},THREE.Vector2.prototype={constructor:THREE.Vector2,get width(){return this.x;},set width(t){this.x=t;},get height(){return this.y;},set height(t){this.y=t;},set:function set(t,e){return this.x=t,this.y=e,this;},setScalar:function setScalar(t){return this.y=this.x=t,this;},setX:function setX(t){return this.x=t,this;},setY:function setY(t){return this.y=t,this;},setComponent:function setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t);}},getComponent:function getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t);}},clone:function clone(){return new this.constructor(this.x,this.y);},copy:function copy(t){return this.x=t.x,this.y=t.y,this;},add:function add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this);},addScalar:function addScalar(t){return this.x+=t,this.y+=t,this;},addVectors:function addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this;},addScaledVector:function addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this;},sub:function sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this);},subScalar:function subScalar(t){return this.x-=t,this.y-=t,this;},subVectors:function subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this;},multiply:function multiply(t){return this.x*=t.x,this.y*=t.y,this;},multiplyScalar:function multiplyScalar(t){return isFinite(t)?(this.x*=t,this.y*=t):this.y=this.x=0,this;},divide:function divide(t){return this.x/=t.x,this.y/=t.y,this;},divideScalar:function divideScalar(t){return this.multiplyScalar(1/t);},min:function min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this;},max:function max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this;},clamp:function clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this;},clampScalar:function(){var t,e;return function(r,i){return void 0===t&&(t=new THREE.Vector2(),e=new THREE.Vector2()),t.set(r,r),e.set(i,i),this.clamp(t,e);};}(),clampLength:function clampLength(t,e){var r=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,r))/r),this;},floor:function floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this;},ceil:function ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this;},round:function round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this;},roundToZero:function roundToZero(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this;},negate:function negate(){return this.x=-this.x,this.y=-this.y,this;},dot:function dot(t){return this.x*t.x+this.y*t.y;},lengthSq:function lengthSq(){return this.x*this.x+this.y*this.y;},length:function length(){return Math.sqrt(this.x*this.x+this.y*this.y);},lengthManhattan:function lengthManhattan(){return Math.abs(this.x)+Math.abs(this.y);},normalize:function normalize(){return this.divideScalar(this.length());},angle:function angle(){var t=Math.atan2(this.y,this.x);return 0>t&&(t+=2*Math.PI),t;},distanceTo:function distanceTo(t){return Math.sqrt(this.distanceToSquared(t));},distanceToSquared:function distanceToSquared(t){var e=this.x-t.x;return e*e+(t=this.y-t.y)*t;},setLength:function setLength(t){return this.multiplyScalar(t/this.length());},lerp:function lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this;},lerpVectors:function lerpVectors(t,e,r){return this.subVectors(e,t).multiplyScalar(r).add(t),this;},equals:function equals(t){return t.x===this.x&&t.y===this.y;},fromArray:function fromArray(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this;},toArray:function toArray(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t;},fromAttribute:function fromAttribute(t,e,r){return void 0===r&&(r=0),e=e*t.itemSize+r,this.x=t.array[e],this.y=t.array[e+1],this;},rotateAround:function rotateAround(t,e){var r=Math.cos(e),i=Math.sin(e),n=this.x-t.x,o=this.y-t.y;return this.x=n*r-o*i+t.x,this.y=n*i+o*r+t.y,this;}},THREE.Vector3=function(t,e,r){this.x=t||0,this.y=e||0,this.z=r||0;},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function set(t,e,r){return this.x=t,this.y=e,this.z=r,this;},setScalar:function setScalar(t){return this.z=this.y=this.x=t,this;},setX:function setX(t){return this.x=t,this;},setY:function setY(t){return this.y=t,this;},setZ:function setZ(t){return this.z=t,this;},setComponent:function setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t);}},getComponent:function getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t);}},clone:function clone(){return new this.constructor(this.x,this.y,this.z);},copy:function copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this;},add:function add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this);},addScalar:function addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this;},addVectors:function addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this;},addScaledVector:function addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this;},sub:function sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this);},subScalar:function subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this;},subVectors:function subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this;},multiply:function multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this);},multiplyScalar:function multiplyScalar(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):this.z=this.y=this.x=0,this;},multiplyVectors:function multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this;},applyEuler:function(){var t;return function(e){return!1==e instanceof THREE.Euler&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new THREE.Quaternion()),this.applyQuaternion(t.setFromEuler(e)),this;};}(),applyAxisAngle:function(){var t;return function(e,r){return void 0===t&&(t=new THREE.Quaternion()),this.applyQuaternion(t.setFromAxisAngle(e,r)),this;};}(),applyMatrix3:function applyMatrix3(t){var e=this.x,r=this.y,i=this.z;return t=t.elements,this.x=t[0]*e+t[3]*r+t[6]*i,this.y=t[1]*e+t[4]*r+t[7]*i,this.z=t[2]*e+t[5]*r+t[8]*i,this;},applyMatrix4:function applyMatrix4(t){var e=this.x,r=this.y,i=this.z;return t=t.elements,this.x=t[0]*e+t[4]*r+t[8]*i+t[12],this.y=t[1]*e+t[5]*r+t[9]*i+t[13],this.z=t[2]*e+t[6]*r+t[10]*i+t[14],this;},applyProjection:function applyProjection(t){var e=this.x,r=this.y,i=this.z,n=1/((t=t.elements)[3]*e+t[7]*r+t[11]*i+t[15]);return this.x=(t[0]*e+t[4]*r+t[8]*i+t[12])*n,this.y=(t[1]*e+t[5]*r+t[9]*i+t[13])*n,this.z=(t[2]*e+t[6]*r+t[10]*i+t[14])*n,this;},applyQuaternion:function applyQuaternion(t){var e=this.x,r=this.y,i=this.z,n=t.x,o=t.y,a=t.z,s=(t=t.w)*e+o*i-a*r,h=t*r+a*e-n*i,c=t*i+n*r-o*e;e=-n*e-o*r-a*i;return this.x=s*t+e*-n+h*-a-c*-o,this.y=h*t+e*-o+c*-n-s*-a,this.z=c*t+e*-a+s*-o-h*-n,this;},project:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4()),t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyProjection(t);};}(),unproject:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4()),t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyProjection(t);};}(),transformDirection:function transformDirection(t){var e=this.x,r=this.y,i=this.z;return t=t.elements,this.x=t[0]*e+t[4]*r+t[8]*i,this.y=t[1]*e+t[5]*r+t[9]*i,this.z=t[2]*e+t[6]*r+t[10]*i,this.normalize(),this;},divide:function divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this;},divideScalar:function divideScalar(t){return this.multiplyScalar(1/t);},min:function min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this;},max:function max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this;},clamp:function clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this;},clampScalar:function(){var t,e;return function(r,i){return void 0===t&&(t=new THREE.Vector3(),e=new THREE.Vector3()),t.set(r,r,r),e.set(i,i,i),this.clamp(t,e);};}(),clampLength:function clampLength(t,e){var r=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,r))/r),this;},floor:function floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this;},ceil:function ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this;},round:function round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this;},roundToZero:function roundToZero(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this;},negate:function negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this;},dot:function dot(t){return this.x*t.x+this.y*t.y+this.z*t.z;},lengthSq:function lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z;},length:function length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);},lengthManhattan:function lengthManhattan(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z);},normalize:function normalize(){return this.divideScalar(this.length());},setLength:function setLength(t){return this.multiplyScalar(t/this.length());},lerp:function lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this;},lerpVectors:function lerpVectors(t,e,r){return this.subVectors(e,t).multiplyScalar(r).add(t),this;},cross:function cross(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var r=this.x,i=this.y,n=this.z;return this.x=i*t.z-n*t.y,this.y=n*t.x-r*t.z,this.z=r*t.y-i*t.x,this;},crossVectors:function crossVectors(t,e){var r=t.x,i=t.y,n=t.z,o=e.x,a=e.y,s=e.z;return this.x=i*s-n*a,this.y=n*o-r*s,this.z=r*a-i*o,this;},projectOnVector:function(){var t,e;return function(r){return void 0===t&&(t=new THREE.Vector3()),t.copy(r).normalize(),e=this.dot(t),this.copy(t).multiplyScalar(e);};}(),projectOnPlane:function(){var t;return function(e){return void 0===t&&(t=new THREE.Vector3()),t.copy(this).projectOnVector(e),this.sub(t);};}(),reflect:function(){var t;return function(e){return void 0===t&&(t=new THREE.Vector3()),this.sub(t.copy(e).multiplyScalar(2*this.dot(e)));};}(),angleTo:function angleTo(t){return t=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq()),Math.acos(THREE.Math.clamp(t,-1,1));},distanceTo:function distanceTo(t){return Math.sqrt(this.distanceToSquared(t));},distanceToSquared:function distanceToSquared(t){var e=this.x-t.x,r=this.y-t.y;return e*e+r*r+(t=this.z-t.z)*t;},setFromMatrixPosition:function setFromMatrixPosition(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this;},setFromMatrixScale:function setFromMatrixScale(t){var e=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),r=this.set(t.elements[4],t.elements[5],t.elements[6]).length();return t=this.set(t.elements[8],t.elements[9],t.elements[10]).length(),this.x=e,this.y=r,this.z=t,this;},setFromMatrixColumn:function setFromMatrixColumn(t,e){var r=4*t,i=e.elements;return this.x=i[r],this.y=i[r+1],this.z=i[r+2],this;},equals:function equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z;},fromArray:function fromArray(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this;},toArray:function toArray(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t;},fromAttribute:function fromAttribute(t,e,r){return void 0===r&&(r=0),e=e*t.itemSize+r,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this;}},THREE.Vector4=function(t,e,r,i){this.x=t||0,this.y=e||0,this.z=r||0,this.w=void 0!==i?i:1;},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function set(t,e,r,i){return this.x=t,this.y=e,this.z=r,this.w=i,this;},setScalar:function setScalar(t){return this.w=this.z=this.y=this.x=t,this;},setX:function setX(t){return this.x=t,this;},setY:function setY(t){return this.y=t,this;},setZ:function setZ(t){return this.z=t,this;},setW:function setW(t){return this.w=t,this;},setComponent:function setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t);}},getComponent:function getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t);}},clone:function clone(){return new this.constructor(this.x,this.y,this.z,this.w);},copy:function copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this;},add:function add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this);},addScalar:function addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this;},addVectors:function addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this;},addScaledVector:function addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this;},sub:function sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this);},subScalar:function subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this;},subVectors:function subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this;},multiplyScalar:function multiplyScalar(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):this.w=this.z=this.y=this.x=0,this;},applyMatrix4:function applyMatrix4(t){var e=this.x,r=this.y,i=this.z,n=this.w;return t=t.elements,this.x=t[0]*e+t[4]*r+t[8]*i+t[12]*n,this.y=t[1]*e+t[5]*r+t[9]*i+t[13]*n,this.z=t[2]*e+t[6]*r+t[10]*i+t[14]*n,this.w=t[3]*e+t[7]*r+t[11]*i+t[15]*n,this;},divideScalar:function divideScalar(t){return this.multiplyScalar(1/t);},setAxisAngleFromQuaternion:function setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this;},setAxisAngleFromRotationMatrix:function setAxisAngleFromRotationMatrix(t){var e,r,i,n=(t=t.elements)[0];i=t[4];var o=t[8],a=t[1],s=t[5],h=t[9];r=t[2],e=t[6];var c=t[10];return .01>Math.abs(i-a)&&.01>Math.abs(o-r)&&.01>Math.abs(h-e)?.1>Math.abs(i+a)&&.1>Math.abs(o+r)&&.1>Math.abs(h+e)&&.1>Math.abs(n+s+c-3)?(this.set(1,0,0,0),this):(t=Math.PI,c=(c+1)/2,i=(i+a)/4,o=(o+r)/4,h=(h+e)/4,(n=(n+1)/2)>(s=(s+1)/2)&&n>c?.01>n?(e=0,i=r=.707106781):(r=i/(e=Math.sqrt(n)),i=o/e):s>c?.01>s?(e=.707106781,r=0,i=.707106781):(e=i/(r=Math.sqrt(s)),i=h/r):.01>c?(r=e=.707106781,i=0):(e=o/(i=Math.sqrt(c)),r=h/i),this.set(e,r,i,t),this):(t=Math.sqrt((e-h)*(e-h)+(o-r)*(o-r)+(a-i)*(a-i)),.001>Math.abs(t)&&(t=1),this.x=(e-h)/t,this.y=(o-r)/t,this.z=(a-i)/t,this.w=Math.acos((n+s+c-1)/2),this);},min:function min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this;},max:function max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this;},clamp:function clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this;},clampScalar:function(){var t,e;return function(r,i){return void 0===t&&(t=new THREE.Vector4(),e=new THREE.Vector4()),t.set(r,r,r,r),e.set(i,i,i,i),this.clamp(t,e);};}(),floor:function floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this;},ceil:function ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this;},round:function round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this;},roundToZero:function roundToZero(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this;},negate:function negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this;},dot:function dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w;},lengthSq:function lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;},length:function length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);},lengthManhattan:function lengthManhattan(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w);},normalize:function normalize(){return this.divideScalar(this.length());},setLength:function setLength(t){return this.multiplyScalar(t/this.length());},lerp:function lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this;},lerpVectors:function lerpVectors(t,e,r){return this.subVectors(e,t).multiplyScalar(r).add(t),this;},equals:function equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w;},fromArray:function fromArray(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this;},toArray:function toArray(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t;},fromAttribute:function fromAttribute(t,e,r){return void 0===r&&(r=0),e=e*t.itemSize+r,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this.w=t.array[e+3],this;}},THREE.Euler=function(t,e,r,i){this._x=t||0,this._y=e||0,this._z=r||0,this._order=i||THREE.Euler.DefaultOrder;},THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),THREE.Euler.DefaultOrder="XYZ",THREE.Euler.prototype={constructor:THREE.Euler,get x(){return this._x;},set x(t){this._x=t,this.onChangeCallback();},get y(){return this._y;},set y(t){this._y=t,this.onChangeCallback();},get z(){return this._z;},set z(t){this._z=t,this.onChangeCallback();},get order(){return this._order;},set order(t){this._order=t,this.onChangeCallback();},set:function set(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._order=i||this._order,this.onChangeCallback(),this;},clone:function clone(){return new this.constructor(this._x,this._y,this._z,this._order);},copy:function copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this;},setFromRotationMatrix:function setFromRotationMatrix(t,e,r){var i=THREE.Math.clamp;t=(u=t.elements)[0];var n=u[4],o=u[8],a=u[1],s=u[5],h=u[9],c=u[2],l=u[6],u=u[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(i(o,-1,1)),.99999>Math.abs(o)?(this._x=Math.atan2(-h,u),this._z=Math.atan2(-n,t)):(this._x=Math.atan2(l,s),this._z=0)):"YXZ"===e?(this._x=Math.asin(-i(h,-1,1)),.99999>Math.abs(h)?(this._y=Math.atan2(o,u),this._z=Math.atan2(a,s)):(this._y=Math.atan2(-c,t),this._z=0)):"ZXY"===e?(this._x=Math.asin(i(l,-1,1)),.99999>Math.abs(l)?(this._y=Math.atan2(-c,u),this._z=Math.atan2(-n,s)):(this._y=0,this._z=Math.atan2(a,t))):"ZYX"===e?(this._y=Math.asin(-i(c,-1,1)),.99999>Math.abs(c)?(this._x=Math.atan2(l,u),this._z=Math.atan2(a,t)):(this._x=0,this._z=Math.atan2(-n,s))):"YZX"===e?(this._z=Math.asin(i(a,-1,1)),.99999>Math.abs(a)?(this._x=Math.atan2(-h,s),this._y=Math.atan2(-c,t)):(this._x=0,this._y=Math.atan2(o,u))):"XZY"===e?(this._z=Math.asin(-i(n,-1,1)),.99999>Math.abs(n)?(this._x=Math.atan2(l,s),this._y=Math.atan2(o,t)):(this._x=Math.atan2(-h,u),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==r&&this.onChangeCallback(),this;},setFromQuaternion:function(){var t;return function(e,r,i){return void 0===t&&(t=new THREE.Matrix4()),t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,r,i),this;};}(),setFromVector3:function setFromVector3(t,e){return this.set(t.x,t.y,t.z,e||this._order);},reorder:function(){var t=new THREE.Quaternion();return function(e){t.setFromEuler(this),this.setFromQuaternion(t,e);};}(),equals:function equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order;},fromArray:function fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this;},toArray:function toArray(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t;},toVector3:function toVector3(t){return t?t.set(this._x,this._y,this._z):new THREE.Vector3(this._x,this._y,this._z);},onChange:function onChange(t){return this.onChangeCallback=t,this;},onChangeCallback:function onChangeCallback(){}},THREE.Line3=function(t,e){this.start=void 0!==t?t:new THREE.Vector3(),this.end=void 0!==e?e:new THREE.Vector3();},THREE.Line3.prototype={constructor:THREE.Line3,set:function set(t,e){return this.start.copy(t),this.end.copy(e),this;},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(t){return this.start.copy(t.start),this.end.copy(t.end),this;},center:function center(t){return(t||new THREE.Vector3()).addVectors(this.start,this.end).multiplyScalar(.5);},delta:function delta(t){return(t||new THREE.Vector3()).subVectors(this.end,this.start);},distanceSq:function distanceSq(){return this.start.distanceToSquared(this.end);},distance:function distance(){return this.start.distanceTo(this.end);},at:function at(t,e){var r=e||new THREE.Vector3();return this.delta(r).multiplyScalar(t).add(this.start);},closestPointToPointParameter:function(){var t=new THREE.Vector3(),e=new THREE.Vector3();return function(r,i){t.subVectors(r,this.start),e.subVectors(this.end,this.start);var n=e.dot(e);n=e.dot(t)/n;return i&&(n=THREE.Math.clamp(n,0,1)),n;};}(),closestPointToPoint:function closestPointToPoint(t,e,r){return t=this.closestPointToPointParameter(t,e),r=r||new THREE.Vector3(),this.delta(r).multiplyScalar(t).add(this.start);},applyMatrix4:function applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this;},equals:function equals(t){return t.start.equals(this.start)&&t.end.equals(this.end);}},THREE.Box2=function(t,e){this.min=void 0!==t?t:new THREE.Vector2(1/0,1/0),this.max=void 0!==e?e:new THREE.Vector2(-1/0,-1/0);},THREE.Box2.prototype={constructor:THREE.Box2,set:function set(t,e){return this.min.copy(t),this.max.copy(e),this;},setFromPoints:function setFromPoints(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++){this.expandByPoint(t[e]);}return this;},setFromCenterAndSize:function(){var t=new THREE.Vector2();return function(e,r){var i=t.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this;};}(),clone:function clone(){return new this.constructor().copy(this);},copy:function copy(t){return this.min.copy(t.min),this.max.copy(t.max),this;},makeEmpty:function makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this;},isEmpty:function isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y;},center:function center(t){return(t||new THREE.Vector2()).addVectors(this.min,this.max).multiplyScalar(.5);},size:function size(t){return(t||new THREE.Vector2()).subVectors(this.max,this.min);},expandByPoint:function expandByPoint(t){return this.min.min(t),this.max.max(t),this;},expandByVector:function expandByVector(t){return this.min.sub(t),this.max.add(t),this;},expandByScalar:function expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this;},containsPoint:function containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y);},containsBox:function containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y;},getParameter:function getParameter(t,e){return(e||new THREE.Vector2()).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y));},intersectsBox:function intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y);},clampPoint:function clampPoint(t,e){return(e||new THREE.Vector2()).copy(t).clamp(this.min,this.max);},distanceToPoint:function(){var t=new THREE.Vector2();return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length();};}(),intersect:function intersect(t){return this.min.max(t.min),this.max.min(t.max),this;},union:function union(t){return this.min.min(t.min),this.max.max(t.max),this;},translate:function translate(t){return this.min.add(t),this.max.add(t),this;},equals:function equals(t){return t.min.equals(this.min)&&t.max.equals(this.max);}},THREE.Box3=function(t,e){this.min=void 0!==t?t:new THREE.Vector3(1/0,1/0,1/0),this.max=void 0!==e?e:new THREE.Vector3(-1/0,-1/0,-1/0);},THREE.Box3.prototype={constructor:THREE.Box3,set:function set(t,e){return this.min.copy(t),this.max.copy(e),this;},setFromArray:function setFromArray(t){this.makeEmpty();for(var e=1/0,r=1/0,i=1/0,n=-1/0,o=-1/0,a=-1/0,s=0,h=t.length;s<h;s+=3){var c=t[s],l=t[s+1],u=t[s+2];c<e&&(e=c),l<r&&(r=l),u<i&&(i=u),c>n&&(n=c),l>o&&(o=l),u>a&&(a=u);}this.min.set(e,r,i),this.max.set(n,o,a);},setFromPoints:function setFromPoints(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++){this.expandByPoint(t[e]);}return this;},setFromCenterAndSize:function(){var t=new THREE.Vector3();return function(e,r){var i=t.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this;};}(),setFromObject:function(){var t;return function(e){void 0===t&&(t=new THREE.Box3());var r=this;return this.makeEmpty(),e.updateMatrixWorld(!0),e.traverse(function(e){var i=e.geometry;void 0!==i&&(null===i.boundingBox&&i.computeBoundingBox(),t.copy(i.boundingBox),t.applyMatrix4(e.matrixWorld),r.union(t));}),this;};}(),clone:function clone(){return new this.constructor().copy(this);},copy:function copy(t){return this.min.copy(t.min),this.max.copy(t.max),this;},makeEmpty:function makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this;},isEmpty:function isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z;},center:function center(t){return(t||new THREE.Vector3()).addVectors(this.min,this.max).multiplyScalar(.5);},size:function size(t){return(t||new THREE.Vector3()).subVectors(this.max,this.min);},expandByPoint:function expandByPoint(t){return this.min.min(t),this.max.max(t),this;},expandByVector:function expandByVector(t){return this.min.sub(t),this.max.add(t),this;},expandByScalar:function expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this;},containsPoint:function containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z);},containsBox:function containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z;},getParameter:function getParameter(t,e){return(e||new THREE.Vector3()).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z));},intersectsBox:function intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z);},intersectsSphere:function(){var t;return function(e){return void 0===t&&(t=new THREE.Vector3()),this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius;};}(),intersectsPlane:function intersectsPlane(t){var e,r;return 0<t.normal.x?(e=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,r=t.normal.x*this.min.x),0<t.normal.y?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=t.constant&&r>=t.constant;},clampPoint:function clampPoint(t,e){return(e||new THREE.Vector3()).copy(t).clamp(this.min,this.max);},distanceToPoint:function(){var t=new THREE.Vector3();return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length();};}(),getBoundingSphere:function(){var t=new THREE.Vector3();return function(e){return(e=e||new THREE.Sphere()).center=this.center(),e.radius=.5*this.size(t).length(),e;};}(),intersect:function intersect(t){return this.min.max(t.min),this.max.min(t.max),this;},union:function union(t){return this.min.min(t.min),this.max.max(t.max),this;},applyMatrix4:function(){var t=[new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3()];return function(e){return t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(t),this;};}(),translate:function translate(t){return this.min.add(t),this.max.add(t),this;},equals:function equals(t){return t.min.equals(this.min)&&t.max.equals(this.max);}},THREE.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.");},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function set(t,e,r,i,n,o,a,s,h){var c=this.elements;return c[0]=t,c[3]=e,c[6]=r,c[1]=i,c[4]=n,c[7]=o,c[2]=a,c[5]=s,c[8]=h,this;},identity:function identity(){return this.set(1,0,0,0,1,0,0,0,1),this;},clone:function clone(){return new this.constructor().fromArray(this.elements);},copy:function copy(t){return t=t.elements,this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this;},applyToVector3Array:function(){var t;return function(e,r,i){void 0===t&&(t=new THREE.Vector3()),void 0===r&&(r=0),void 0===i&&(i=e.length);for(var n=0;n<i;n+=3,r+=3){t.fromArray(e,r),t.applyMatrix3(this),t.toArray(e,r);}return e;};}(),applyToBuffer:function(){var t;return function(e,r,i){void 0===t&&(t=new THREE.Vector3()),void 0===r&&(r=0),void 0===i&&(i=e.length/e.itemSize);for(var n=0;n<i;n++,r++){t.x=e.getX(r),t.y=e.getY(r),t.z=e.getZ(r),t.applyMatrix3(this),e.setXYZ(t.x,t.y,t.z);}return e;};}(),multiplyScalar:function multiplyScalar(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this;},determinant:function determinant(){var t,e=(t=this.elements)[0],r=t[1],i=t[2],n=t[3],o=t[4],a=t[5],s=t[6],h=t[7];return e*o*(t=t[8])-e*a*h-r*n*t+r*a*s+i*n*h-i*o*s;},getInverse:function getInverse(t,e){var r=t.elements,i=this.elements;if(i[0]=r[10]*r[5]-r[6]*r[9],i[1]=-r[10]*r[1]+r[2]*r[9],i[2]=r[6]*r[1]-r[2]*r[5],i[3]=-r[10]*r[4]+r[6]*r[8],i[4]=r[10]*r[0]-r[2]*r[8],i[5]=-r[6]*r[0]+r[2]*r[4],i[6]=r[9]*r[4]-r[5]*r[8],i[7]=-r[9]*r[0]+r[1]*r[8],i[8]=r[5]*r[0]-r[1]*r[4],0===(r=r[0]*i[0]+r[1]*i[3]+r[2]*i[6])){if(e)throw Error("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0");return console.warn("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0"),this.identity(),this;}return this.multiplyScalar(1/r),this;},transpose:function transpose(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this;},flattenToArrayOffset:function flattenToArrayOffset(t,e){var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t;},getNormalMatrix:function getNormalMatrix(t){return this.getInverse(t).transpose(),this;},transposeIntoArray:function transposeIntoArray(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this;},fromArray:function fromArray(t){return this.elements.set(t),this;},toArray:function toArray(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]];}},THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.");},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function set(t,e,r,i,n,o,a,s,h,c,l,u,d,p,E,f){var m=this.elements;return m[0]=t,m[4]=e,m[8]=r,m[12]=i,m[1]=n,m[5]=o,m[9]=a,m[13]=s,m[2]=h,m[6]=c,m[10]=l,m[14]=u,m[3]=d,m[7]=p,m[11]=E,m[15]=f,this;},identity:function identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this;},clone:function clone(){return new THREE.Matrix4().fromArray(this.elements);},copy:function copy(t){return this.elements.set(t.elements),this;},copyPosition:function copyPosition(t){var e=this.elements;return t=t.elements,e[12]=t[12],e[13]=t[13],e[14]=t[14],this;},extractBasis:function extractBasis(t,e,r){var i=this.elements;return t.set(i[0],i[1],i[2]),e.set(i[4],i[5],i[6]),r.set(i[8],i[9],i[10]),this;},makeBasis:function makeBasis(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this;},extractRotation:function(){var t;return function(e){void 0===t&&(t=new THREE.Vector3());var r=this.elements;e=e.elements;var i=1/t.set(e[0],e[1],e[2]).length(),n=1/t.set(e[4],e[5],e[6]).length(),o=1/t.set(e[8],e[9],e[10]).length();return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[4]=e[4]*n,r[5]=e[5]*n,r[6]=e[6]*n,r[8]=e[8]*o,r[9]=e[9]*o,r[10]=e[10]*o,this;};}(),makeRotationFromEuler:function makeRotationFromEuler(t){!1==t instanceof THREE.Euler&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,r=t.x,i=t.y,n=t.z,o=Math.cos(r),a=(r=Math.sin(r),Math.cos(i)),s=(i=Math.sin(i),Math.cos(n));n=Math.sin(n);if("XYZ"===t.order){t=o*s;var h=o*n,c=r*s,l=r*n;e[0]=a*s,e[4]=-a*n,e[8]=i,e[1]=h+c*i,e[5]=t-l*i,e[9]=-r*a,e[2]=l-t*i,e[6]=c+h*i,e[10]=o*a;}else"YXZ"===t.order?(t=a*s,h=a*n,c=i*s,l=i*n,e[0]=t+l*r,e[4]=c*r-h,e[8]=o*i,e[1]=o*n,e[5]=o*s,e[9]=-r,e[2]=h*r-c,e[6]=l+t*r,e[10]=o*a):"ZXY"===t.order?(t=a*s,h=a*n,c=i*s,l=i*n,e[0]=t-l*r,e[4]=-o*n,e[8]=c+h*r,e[1]=h+c*r,e[5]=o*s,e[9]=l-t*r,e[2]=-o*i,e[6]=r,e[10]=o*a):"ZYX"===t.order?(t=o*s,h=o*n,c=r*s,l=r*n,e[0]=a*s,e[4]=c*i-h,e[8]=t*i+l,e[1]=a*n,e[5]=l*i+t,e[9]=h*i-c,e[2]=-i,e[6]=r*a,e[10]=o*a):"YZX"===t.order?(t=o*a,h=o*i,c=r*a,l=r*i,e[0]=a*s,e[4]=l-t*n,e[8]=c*n+h,e[1]=n,e[5]=o*s,e[9]=-r*s,e[2]=-i*s,e[6]=h*n+c,e[10]=t-l*n):"XZY"===t.order&&(t=o*a,h=o*i,c=r*a,l=r*i,e[0]=a*s,e[4]=-n,e[8]=i*s,e[1]=t*n+l,e[5]=o*s,e[9]=h*n-c,e[2]=c*n-h,e[6]=r*s,e[10]=l*n+t);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this;},makeRotationFromQuaternion:function makeRotationFromQuaternion(t){var e=this.elements,r=t.x,i=t.y,n=t.z,o=t.w,a=n+n;t=r*(c=r+r);var s=r*(l=i+i),h=(r=r*a,i*l),c=(i=i*a,n=n*a,o*c),l=o*l;o*=a;return e[0]=1-(h+n),e[4]=s-o,e[8]=r+l,e[1]=s+o,e[5]=1-(t+n),e[9]=i-c,e[2]=r-l,e[6]=i+c,e[10]=1-(t+h),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this;},lookAt:function(){var t,e,r;return function(i,n,o){void 0===t&&(t=new THREE.Vector3()),void 0===e&&(e=new THREE.Vector3()),void 0===r&&(r=new THREE.Vector3());var a=this.elements;return r.subVectors(i,n).normalize(),0===r.lengthSq()&&(r.z=1),t.crossVectors(o,r).normalize(),0===t.lengthSq()&&(r.x+=1e-4,t.crossVectors(o,r).normalize()),e.crossVectors(r,t),a[0]=t.x,a[4]=e.x,a[8]=r.x,a[1]=t.y,a[5]=e.y,a[9]=r.y,a[2]=t.z,a[6]=e.z,a[10]=r.z,this;};}(),multiply:function multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t);},multiplyMatrices:function multiplyMatrices(t,e){var r=t.elements,i=e.elements,n=this.elements,o=r[0],a=r[4],s=r[8],h=r[12],c=r[1],l=r[5],u=r[9],d=r[13],p=r[2],E=r[6],f=r[10],m=r[14],g=r[3],T=r[7],v=r[11],y=(r=r[15],i[0]),R=i[4],H=i[8],x=i[12],b=i[1],_=i[5],M=i[9],w=i[13],S=i[2],C=i[6],L=i[10],A=i[14],P=i[3],k=i[7],I=i[11];i=i[15];return n[0]=o*y+a*b+s*S+h*P,n[4]=o*R+a*_+s*C+h*k,n[8]=o*H+a*M+s*L+h*I,n[12]=o*x+a*w+s*A+h*i,n[1]=c*y+l*b+u*S+d*P,n[5]=c*R+l*_+u*C+d*k,n[9]=c*H+l*M+u*L+d*I,n[13]=c*x+l*w+u*A+d*i,n[2]=p*y+E*b+f*S+m*P,n[6]=p*R+E*_+f*C+m*k,n[10]=p*H+E*M+f*L+m*I,n[14]=p*x+E*w+f*A+m*i,n[3]=g*y+T*b+v*S+r*P,n[7]=g*R+T*_+v*C+r*k,n[11]=g*H+T*M+v*L+r*I,n[15]=g*x+T*w+v*A+r*i,this;},multiplyToArray:function multiplyToArray(t,e,r){var i=this.elements;return this.multiplyMatrices(t,e),r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],this;},multiplyScalar:function multiplyScalar(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this;},applyToVector3Array:function(){var t;return function(e,r,i){void 0===t&&(t=new THREE.Vector3()),void 0===r&&(r=0),void 0===i&&(i=e.length);for(var n=0;n<i;n+=3,r+=3){t.fromArray(e,r),t.applyMatrix4(this),t.toArray(e,r);}return e;};}(),applyToBuffer:function(){var t;return function(e,r,i){void 0===t&&(t=new THREE.Vector3()),void 0===r&&(r=0),void 0===i&&(i=e.length/e.itemSize);for(var n=0;n<i;n++,r++){t.x=e.getX(r),t.y=e.getY(r),t.z=e.getZ(r),t.applyMatrix4(this),e.setXYZ(t.x,t.y,t.z);}return e;};}(),determinant:function determinant(){var t=this.elements,e=t[0],r=t[4],i=t[8],n=t[12],o=t[1],a=t[5],s=t[9],h=t[13],c=t[2],l=t[6],u=t[10],d=t[14];return t[3]*(+n*s*l-i*h*l-n*a*u+r*h*u+i*a*d-r*s*d)+t[7]*(+e*s*d-e*h*u+n*o*u-i*o*d+i*h*c-n*s*c)+t[11]*(+e*h*l-e*a*d-n*o*l+r*o*d+n*a*c-r*h*c)+t[15]*(-i*a*c-e*s*l+e*a*u+i*o*l-r*o*u+r*s*c);},transpose:function transpose(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this;},flattenToArrayOffset:function flattenToArrayOffset(t,e){var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t;},getPosition:function(){var t;return function(){void 0===t&&(t=new THREE.Vector3()),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var e=this.elements;return t.set(e[12],e[13],e[14]);};}(),setPosition:function setPosition(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this;},getInverse:function getInverse(t,e){var r=this.elements,i=(T=t.elements)[0],n=T[4],o=T[8],a=T[12],s=T[1],h=T[5],c=T[9],l=T[13],u=T[2],d=T[6],p=T[10],E=T[14],f=T[3],m=T[7],g=T[11],T=T[15];if(r[0]=c*E*m-l*p*m+l*d*g-h*E*g-c*d*T+h*p*T,r[4]=a*p*m-o*E*m-a*d*g+n*E*g+o*d*T-n*p*T,r[8]=o*l*m-a*c*m+a*h*g-n*l*g-o*h*T+n*c*T,r[12]=a*c*d-o*l*d-a*h*p+n*l*p+o*h*E-n*c*E,r[1]=l*p*f-c*E*f-l*u*g+s*E*g+c*u*T-s*p*T,r[5]=o*E*f-a*p*f+a*u*g-i*E*g-o*u*T+i*p*T,r[9]=a*c*f-o*l*f-a*s*g+i*l*g+o*s*T-i*c*T,r[13]=o*l*u-a*c*u+a*s*p-i*l*p-o*s*E+i*c*E,r[2]=h*E*f-l*d*f+l*u*m-s*E*m-h*u*T+s*d*T,r[6]=a*d*f-n*E*f-a*u*m+i*E*m+n*u*T-i*d*T,r[10]=n*l*f-a*h*f+a*s*m-i*l*m-n*s*T+i*h*T,r[14]=a*h*u-n*l*u-a*s*d+i*l*d+n*s*E-i*h*E,r[3]=c*d*f-h*p*f-c*u*m+s*p*m+h*u*g-s*d*g,r[7]=n*p*f-o*d*f+o*u*m-i*p*m-n*u*g+i*d*g,r[11]=o*h*f-n*c*f-o*s*m+i*c*m+n*s*g-i*h*g,r[15]=n*c*u-o*h*u+o*s*d-i*c*d-n*s*p+i*h*p,0===(r=i*r[0]+s*r[4]+u*r[8]+f*r[12])){if(e)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0"),this.identity(),this;}return this.multiplyScalar(1/r),this;},scale:function scale(t){var e=this.elements,r=t.x,i=t.y;return t=t.z,e[0]*=r,e[4]*=i,e[8]*=t,e[1]*=r,e[5]*=i,e[9]*=t,e[2]*=r,e[6]*=i,e[10]*=t,e[3]*=r,e[7]*=i,e[11]*=t,this;},getMaxScaleOnAxis:function getMaxScaleOnAxis(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]));},makeTranslation:function makeTranslation(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this;},makeRotationX:function makeRotationX(t){var e=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this;},makeRotationY:function makeRotationY(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this;},makeRotationZ:function makeRotationZ(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this;},makeRotationAxis:function makeRotationAxis(t,e){var r=Math.cos(e),i=Math.sin(e),n=1-r,o=t.x,a=t.y,s=t.z,h=n*o,c=n*a;return this.set(h*o+r,h*a-i*s,h*s+i*a,0,h*a+i*s,c*a+r,c*s-i*o,0,h*s-i*a,c*s+i*o,n*s*s+r,0,0,0,0,1),this;},makeScale:function makeScale(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this;},compose:function compose(t,e,r){return this.makeRotationFromQuaternion(e),this.scale(r),this.setPosition(t),this;},decompose:function(){var t,e;return function(r,i,n){void 0===t&&(t=new THREE.Vector3()),void 0===e&&(e=new THREE.Matrix4());var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),h=t.set(o[8],o[9],o[10]).length();0>this.determinant()&&(a=-a),r.x=o[12],r.y=o[13],r.z=o[14],e.elements.set(this.elements),r=1/a;o=1/s;var c=1/h;return e.elements[0]*=r,e.elements[1]*=r,e.elements[2]*=r,e.elements[4]*=o,e.elements[5]*=o,e.elements[6]*=o,e.elements[8]*=c,e.elements[9]*=c,e.elements[10]*=c,i.setFromRotationMatrix(e),n.x=a,n.y=s,n.z=h,this;};}(),makeFrustum:function makeFrustum(t,e,r,i,n,o){var a=this.elements;return a[0]=2*n/(e-t),a[4]=0,a[8]=(e+t)/(e-t),a[12]=0,a[1]=0,a[5]=2*n/(i-r),a[9]=(i+r)/(i-r),a[13]=0,a[2]=0,a[6]=0,a[10]=-(o+n)/(o-n),a[14]=-2*o*n/(o-n),a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this;},makePerspective:function makePerspective(t,e,r,i){var n=-(t=r*Math.tan(THREE.Math.degToRad(.5*t)));return this.makeFrustum(n*e,t*e,n,t,r,i);},makeOrthographic:function makeOrthographic(t,e,r,i,n,o){var a=this.elements,s=e-t,h=r-i,c=o-n;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-(e+t)/s,a[1]=0,a[5]=2/h,a[9]=0,a[13]=-(r+i)/h,a[2]=0,a[6]=0,a[10]=-2/c,a[14]=-(o+n)/c,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this;},equals:function equals(t){var e=this.elements;t=t.elements;for(var r=0;16>r;r++){if(e[r]!==t[r])return!1;}return!0;},fromArray:function fromArray(t){return this.elements.set(t),this;},toArray:function toArray(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]];}},THREE.Ray=function(t,e){this.origin=void 0!==t?t:new THREE.Vector3(),this.direction=void 0!==e?e:new THREE.Vector3();},THREE.Ray.prototype={constructor:THREE.Ray,set:function set(t,e){return this.origin.copy(t),this.direction.copy(e),this;},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this;},at:function at(t,e){return(e||new THREE.Vector3()).copy(this.direction).multiplyScalar(t).add(this.origin);},lookAt:function lookAt(t){this.direction.copy(t).sub(this.origin).normalize();},recast:function(){var t=new THREE.Vector3();return function(e){return this.origin.copy(this.at(e,t)),this;};}(),closestPointToPoint:function closestPointToPoint(t,e){var r=e||new THREE.Vector3();r.subVectors(t,this.origin);var i=r.dot(this.direction);return 0>i?r.copy(this.origin):r.copy(this.direction).multiplyScalar(i).add(this.origin);},distanceToPoint:function distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t));},distanceSqToPoint:function(){var t=new THREE.Vector3();return function(e){var r=t.subVectors(e,this.origin).dot(this.direction);return 0>r?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(r).add(this.origin),t.distanceToSquared(e));};}(),distanceSqToSegment:function(){var t=new THREE.Vector3(),e=new THREE.Vector3(),r=new THREE.Vector3();return function(i,n,o,a){t.copy(i).add(n).multiplyScalar(.5),e.copy(n).sub(i).normalize(),r.copy(this.origin).sub(t);var s,h=.5*i.distanceTo(n),c=-this.direction.dot(e),l=r.dot(this.direction),u=-r.dot(e),d=r.lengthSq(),p=Math.abs(1-c*c);return 0<p?(n=c*l-u,s=h*p,0<=(i=c*u-l)?n>=-s?n<=s?c=(i*=h=1/p)*(i+c*(n*=h)+2*l)+n*(c*i+n+2*u)+d:(n=h,c=-(i=Math.max(0,-(c*n+l)))*i+n*(n+2*u)+d):(n=-h,c=-(i=Math.max(0,-(c*n+l)))*i+n*(n+2*u)+d):n<=-s?c=-(i=Math.max(0,-(-c*h+l)))*i+(n=0<i?-h:Math.min(Math.max(-h,-u),h))*(n+2*u)+d:n<=s?(i=0,c=(n=Math.min(Math.max(-h,-u),h))*(n+2*u)+d):c=-(i=Math.max(0,-(c*h+l)))*i+(n=0<i?h:Math.min(Math.max(-h,-u),h))*(n+2*u)+d):(n=0<c?-h:h,c=-(i=Math.max(0,-(c*n+l)))*i+n*(n+2*u)+d),o&&o.copy(this.direction).multiplyScalar(i).add(this.origin),a&&a.copy(e).multiplyScalar(n).add(t),c;};}(),intersectSphere:function(){var t=new THREE.Vector3();return function(e,r){t.subVectors(e.center,this.origin);var i=t.dot(this.direction),n=t.dot(t)-i*i,o=e.radius*e.radius;return n>o?null:(n=i-(o=Math.sqrt(o-n)),i+=o,0>n&&0>i?null:0>n?this.at(i,r):this.at(n,r));};}(),intersectsSphere:function intersectsSphere(t){return this.distanceToPoint(t.center)<=t.radius;},distanceToPlane:function distanceToPlane(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(t.normal)+t.constant)/e)?t:null;},intersectPlane:function intersectPlane(t,e){var r=this.distanceToPlane(t);return null===r?null:this.at(r,e);},intersectsPlane:function intersectsPlane(t){var e=t.distanceToPoint(this.origin);return 0===e||0>t.normal.dot(this.direction)*e;},intersectBox:function intersectBox(t,e){var r,i,n,o,a;i=1/this.direction.x,o=1/this.direction.y,a=1/this.direction.z;var s=this.origin;return 0<=i?(r=(t.min.x-s.x)*i,i*=t.max.x-s.x):(r=(t.max.x-s.x)*i,i*=t.min.x-s.x),0<=o?(n=(t.min.y-s.y)*o,o*=t.max.y-s.y):(n=(t.max.y-s.y)*o,o*=t.min.y-s.y),r>o||n>i?null:((n>r||r!=r)&&(r=n),(o<i||i!=i)&&(i=o),0<=a?(n=(t.min.z-s.z)*a,a*=t.max.z-s.z):(n=(t.max.z-s.z)*a,a*=t.min.z-s.z),r>a||n>i?null:((n>r||r!=r)&&(r=n),(a<i||i!=i)&&(i=a),0>i?null:this.at(0<=r?r:i,e)));},intersectsBox:function(){var t=new THREE.Vector3();return function(e){return null!==this.intersectBox(e,t);};}(),intersectTriangle:function(){var t=new THREE.Vector3(),e=new THREE.Vector3(),r=new THREE.Vector3(),i=new THREE.Vector3();return function(n,o,a,s,h){if(e.subVectors(o,n),r.subVectors(a,n),i.crossVectors(e,r),0<(o=this.direction.dot(i))){if(s)return null;s=1;}else{if(!(0>o))return null;s=-1,o=-o;}return t.subVectors(this.origin,n),0>(n=s*this.direction.dot(r.crossVectors(t,r)))?null:0>(a=s*this.direction.dot(e.cross(t)))||n+a>o?null:0>(n=-s*t.dot(i))?null:this.at(n/o,h);};}(),applyMatrix4:function applyMatrix4(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this;},equals:function equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction);}},THREE.Sphere=function(t,e){this.center=void 0!==t?t:new THREE.Vector3(),this.radius=void 0!==e?e:0;},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function set(t,e){return this.center.copy(t),this.radius=e,this;},setFromPoints:function(){var t=new THREE.Box3();return function(e,r){var i=this.center;void 0!==r?i.copy(r):t.setFromPoints(e).center(i);for(var n=0,o=0,a=e.length;o<a;o++){n=Math.max(n,i.distanceToSquared(e[o]));}return this.radius=Math.sqrt(n),this;};}(),clone:function clone(){return new this.constructor().copy(this);},copy:function copy(t){return this.center.copy(t.center),this.radius=t.radius,this;},empty:function empty(){return 0>=this.radius;},containsPoint:function containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius;},distanceToPoint:function distanceToPoint(t){return t.distanceTo(this.center)-this.radius;},intersectsSphere:function intersectsSphere(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e;},intersectsBox:function intersectsBox(t){return t.intersectsSphere(this);},intersectsPlane:function intersectsPlane(t){return Math.abs(this.center.dot(t.normal)-t.constant)<=this.radius;},clampPoint:function clampPoint(t,e){var r=this.center.distanceToSquared(t),i=e||new THREE.Vector3();return i.copy(t),r>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i;},getBoundingBox:function getBoundingBox(t){return(t=t||new THREE.Box3()).set(this.center,this.center),t.expandByScalar(this.radius),t;},applyMatrix4:function applyMatrix4(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this;},translate:function translate(t){return this.center.add(t),this;},equals:function equals(t){return t.center.equals(this.center)&&t.radius===this.radius;}},THREE.Frustum=function(t,e,r,i,n,o){this.planes=[void 0!==t?t:new THREE.Plane(),void 0!==e?e:new THREE.Plane(),void 0!==r?r:new THREE.Plane(),void 0!==i?i:new THREE.Plane(),void 0!==n?n:new THREE.Plane(),void 0!==o?o:new THREE.Plane()];},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function set(t,e,r,i,n,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(r),a[3].copy(i),a[4].copy(n),a[5].copy(o),this;},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(t){for(var e=this.planes,r=0;6>r;r++){e[r].copy(t.planes[r]);}return this;},setFromMatrix:function setFromMatrix(t){var e=this.planes;t=(m=t.elements)[0];var r=m[1],i=m[2],n=m[3],o=m[4],a=m[5],s=m[6],h=m[7],c=m[8],l=m[9],u=m[10],d=m[11],p=m[12],E=m[13],f=m[14],m=m[15];return e[0].setComponents(n-t,h-o,d-c,m-p).normalize(),e[1].setComponents(n+t,h+o,d+c,m+p).normalize(),e[2].setComponents(n+r,h+a,d+l,m+E).normalize(),e[3].setComponents(n-r,h-a,d-l,m-E).normalize(),e[4].setComponents(n-i,h-s,d-u,m-f).normalize(),e[5].setComponents(n+i,h+s,d+u,m+f).normalize(),this;},intersectsObject:function(){var t=new THREE.Sphere();return function(e){var r=e.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),t.copy(r.boundingSphere),t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t);};}(),intersectsSphere:function intersectsSphere(t){var e=this.planes,r=t.center;t=-t.radius;for(var i=0;6>i;i++){if(e[i].distanceToPoint(r)<t)return!1;}return!0;},intersectsBox:function(){var t=new THREE.Vector3(),e=new THREE.Vector3();return function(r){for(var i=this.planes,n=0;6>n;n++){var o=i[n];t.x=0<o.normal.x?r.min.x:r.max.x,e.x=0<o.normal.x?r.max.x:r.min.x,t.y=0<o.normal.y?r.min.y:r.max.y,e.y=0<o.normal.y?r.max.y:r.min.y,t.z=0<o.normal.z?r.min.z:r.max.z,e.z=0<o.normal.z?r.max.z:r.min.z;var a=o.distanceToPoint(t);o=o.distanceToPoint(e);if(0>a&&0>o)return!1;}return!0;};}(),containsPoint:function containsPoint(t){for(var e=this.planes,r=0;6>r;r++){if(0>e[r].distanceToPoint(t))return!1;}return!0;}},THREE.Plane=function(t,e){this.normal=void 0!==t?t:new THREE.Vector3(1,0,0),this.constant=void 0!==e?e:0;},THREE.Plane.prototype={constructor:THREE.Plane,set:function set(t,e){return this.normal.copy(t),this.constant=e,this;},setComponents:function setComponents(t,e,r,i){return this.normal.set(t,e,r),this.constant=i,this;},setFromNormalAndCoplanarPoint:function setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this;},setFromCoplanarPoints:function(){var t=new THREE.Vector3(),e=new THREE.Vector3();return function(r,i,n){return i=t.subVectors(n,i).cross(e.subVectors(r,i)).normalize(),this.setFromNormalAndCoplanarPoint(i,r),this;};}(),clone:function clone(){return new this.constructor().copy(this);},copy:function copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this;},normalize:function normalize(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this;},negate:function negate(){return this.constant*=-1,this.normal.negate(),this;},distanceToPoint:function distanceToPoint(t){return this.normal.dot(t)+this.constant;},distanceToSphere:function distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius;},projectPoint:function projectPoint(t,e){return this.orthoPoint(t,e).sub(t).negate();},orthoPoint:function orthoPoint(t,e){var r=this.distanceToPoint(t);return(e||new THREE.Vector3()).copy(this.normal).multiplyScalar(r);},intersectLine:function(){var t=new THREE.Vector3();return function(e,r){var i=r||new THREE.Vector3(),n=e.delta(t),o=this.normal.dot(n);return 0!==o?0>(o=-(e.start.dot(this.normal)+this.constant)/o)||1<o?void 0:i.copy(n).multiplyScalar(o).add(e.start):0===this.distanceToPoint(e.start)?i.copy(e.start):void 0;};}(),intersectsLine:function intersectsLine(t){var e=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),0>e&&0<t||0>t&&0<e;},intersectsBox:function intersectsBox(t){return t.intersectsPlane(this);},intersectsSphere:function intersectsSphere(t){return t.intersectsPlane(this);},coplanarPoint:function coplanarPoint(t){return(t||new THREE.Vector3()).copy(this.normal).multiplyScalar(-this.constant);},applyMatrix4:function(){var t=new THREE.Vector3(),e=new THREE.Vector3(),r=new THREE.Matrix3();return function(i,n){var o=n||r.getNormalMatrix(i),a=(o=t.copy(this.normal).applyMatrix3(o),this.coplanarPoint(e));return a.applyMatrix4(i),this.setFromNormalAndCoplanarPoint(o,a),this;};}(),translate:function translate(t){return this.constant-=t.dot(this.normal),this;},equals:function equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant;}},THREE.Math={generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=Array(36),i=0;return function(){for(var n=0;36>n;n++){8===n||13===n||18===n||23===n?r[n]="-":14===n?r[n]="4":(2>=i&&(i=33554432+16777216*Math.random()|0),t=15&i,i>>=4,r[n]=e[19===n?3&t|8:t]);}return r.join("");};}(),clamp:function clamp(t,e,r){return Math.max(e,Math.min(r,t));},euclideanModulo:function euclideanModulo(t,e){return(t%e+e)%e;},mapLinear:function mapLinear(t,e,r,i,n){return i+(t-e)*(n-i)/(r-e);},smoothstep:function smoothstep(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e))*t*(3-2*t);},smootherstep:function smootherstep(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e))*t*t*(t*(6*t-15)+10);},random16:function random16(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random();},randInt:function randInt(t,e){return t+Math.floor(Math.random()*(e-t+1));},randFloat:function randFloat(t,e){return t+Math.random()*(e-t);},randFloatSpread:function randFloatSpread(t){return t*(.5-Math.random());},degToRad:function(){var t=Math.PI/180;return function(e){return e*t;};}(),radToDeg:function(){var t=180/Math.PI;return function(e){return e*t;};}(),isPowerOfTwo:function isPowerOfTwo(t){return 0==(t&t-1)&&0!==t;},nearestPowerOfTwo:function nearestPowerOfTwo(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2));},nextPowerOfTwo:function nextPowerOfTwo(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t;}},THREE.Spline=function(t){function e(t,e,r,i,n,o,a){return(2*(e-r)+(t=.5*(r-t))+(i=.5*(i-e)))*a+(-3*(e-r)-2*t-i)*o+t*n+e;}this.points=t;var r,i,n,o,a,s,h,c,l,u=[],d={x:0,y:0,z:0};this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++){this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]};}},this.getPoint=function(t){return r=(this.points.length-1)*t,i=Math.floor(r),n=r-i,u[0]=0===i?i:i-1,u[1]=i,u[2]=i>this.points.length-2?this.points.length-1:i+1,u[3]=i>this.points.length-3?this.points.length-1:i+2,s=this.points[u[0]],h=this.points[u[1]],c=this.points[u[2]],l=this.points[u[3]],a=n*(o=n*n),d.x=e(s.x,h.x,c.x,l.x,n,o,a),d.y=e(s.y,h.y,c.y,l.y,n,o,a),d.z=e(s.z,h.z,c.z,l.z,n,o,a),d;},this.getControlPointsArray=function(){var t,e,r=this.points.length,i=[];for(t=0;t<r;t++){e=this.points[t],i[t]=[e.x,e.y,e.z];}return i;},this.getLength=function(t){var e,r,i,n=e=e=0,o=new THREE.Vector3(),a=new THREE.Vector3(),s=[],h=0;for(s[0]=0,t||(t=100),r=this.points.length*t,o.copy(this.points[0]),t=1;t<r;t++){e=t/r,i=this.getPoint(e),a.copy(i),h+=a.distanceTo(o),o.copy(i),e*=this.points.length-1,(e=Math.floor(e))!==n&&(s[e]=h,n=e);}return s[s.length]=h,{chunks:s,total:h};},this.reparametrizeByArcLength=function(t){var e,r,i,n,o,a,s=[],h=new THREE.Vector3(),c=this.getLength();for(s.push(h.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(r=c.chunks[e]-c.chunks[e-1],a=Math.ceil(t*r/c.total),n=(e-1)/(this.points.length-1),o=e/(this.points.length-1),r=1;r<a-1;r++){i=n+1/a*r*(o-n),i=this.getPoint(i),s.push(h.copy(i).clone());}s.push(h.copy(this.points[e]).clone());}this.points=s;};},THREE.Triangle=function(t,e,r){this.a=void 0!==t?t:new THREE.Vector3(),this.b=void 0!==e?e:new THREE.Vector3(),this.c=void 0!==r?r:new THREE.Vector3();},THREE.Triangle.normal=function(){var t=new THREE.Vector3();return function(e,r,i,n){return(n=n||new THREE.Vector3()).subVectors(i,r),t.subVectors(e,r),n.cross(t),0<(e=n.lengthSq())?n.multiplyScalar(1/Math.sqrt(e)):n.set(0,0,0);};}(),THREE.Triangle.barycoordFromPoint=function(){var t=new THREE.Vector3(),e=new THREE.Vector3(),r=new THREE.Vector3();return function(i,n,o,a,s){t.subVectors(a,n),e.subVectors(o,n),r.subVectors(i,n),i=t.dot(t),n=t.dot(e),o=t.dot(r);var h=e.dot(e);a=e.dot(r);var c=i*h-n*n;return s=s||new THREE.Vector3(),0===c?s.set(-2,-1,-1):(h=(h*o-n*a)*(c=1/c),i=(i*a-n*o)*c,s.set(1-h-i,i,h));};}(),THREE.Triangle.containsPoint=function(){var t=new THREE.Vector3();return function(e,r,i,n){return 0<=(e=THREE.Triangle.barycoordFromPoint(e,r,i,n,t)).x&&0<=e.y&&1>=e.x+e.y;};}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function set(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this;},setFromPointsAndIndices:function setFromPointsAndIndices(t,e,r,i){return this.a.copy(t[e]),this.b.copy(t[r]),this.c.copy(t[i]),this;},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this;},area:function(){var t=new THREE.Vector3(),e=new THREE.Vector3();return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length();};}(),midpoint:function midpoint(t){return(t||new THREE.Vector3()).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3);},normal:function normal(t){return THREE.Triangle.normal(this.a,this.b,this.c,t);},plane:function plane(t){return(t||new THREE.Plane()).setFromCoplanarPoints(this.a,this.b,this.c);},barycoordFromPoint:function barycoordFromPoint(t,e){return THREE.Triangle.barycoordFromPoint(t,this.a,this.b,this.c,e);},containsPoint:function containsPoint(t){return THREE.Triangle.containsPoint(t,this.a,this.b,this.c);},equals:function equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c);}},THREE.Interpolant=function(t,e,r,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(r),this.sampleValues=e,this.valueSize=r;},THREE.Interpolant.prototype={constructor:THREE.Interpolant,evaluate:function evaluate(t){var e=this.parameterPositions,r=this._cachedIndex,i=e[r],n=e[r-1];t:{e:{r:{i:if(!(t<i)){for(var o=r+2;;){if(void 0===i){if(t<n)break i;return this._cachedIndex=r=e.length,this.afterEnd_(r-1,t,n);}if(r===o)break;if(n=i,t<(i=e[++r]))break e;}i=e.length;break r;}if(t>=n)break t;for(t<(o=e[1])&&(r=2,n=o),o=r-2;;){if(void 0===n)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(r===o)break;if(i=n,t>=(n=e[--r-1]))break e;}i=r,r=0;}for(;r<i;){t<e[n=r+i>>>1]?i=n:r=n+1;}if(i=e[r],void 0===(n=e[r-1]))return this._cachedIndex=0,this.beforeStart_(0,t,i);if(void 0===i)return this._cachedIndex=r=e.length,this.afterEnd_(r-1,n,t);}this._cachedIndex=r,this.intervalChanged_(r,n,i);}return this.interpolate_(r,n,t,i);},settings:null,DefaultSettings_:{},getSettings_:function getSettings_(){return this.settings||this.DefaultSettings_;},copySampleValue_:function copySampleValue_(t){var e=this.resultBuffer,r=this.sampleValues,i=this.valueSize;t*=i;for(var n=0;n!==i;++n){e[n]=r[t+n];}return e;},interpolate_:function interpolate_(t,e,r,i){throw Error("call to abstract method");},intervalChanged_:function intervalChanged_(t,e,r){}},Object.assign(THREE.Interpolant.prototype,{beforeStart_:THREE.Interpolant.prototype.copySampleValue_,afterEnd_:THREE.Interpolant.prototype.copySampleValue_}),THREE.CubicInterpolant=function(t,e,r,i){THREE.Interpolant.call(this,t,e,r,i),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0;},THREE.CubicInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.CubicInterpolant,DefaultSettings_:{endingStart:THREE.ZeroCurvatureEnding,endingEnd:THREE.ZeroCurvatureEnding},intervalChanged_:function intervalChanged_(t,e,r){var i=this.parameterPositions,n=t-2,o=t+1,a=i[n],s=i[o];if(void 0===a)switch(this.getSettings_().endingStart){case THREE.ZeroSlopeEnding:n=t,a=2*e-r;break;case THREE.WrapAroundEnding:a=e+i[n=i.length-2]-i[n+1];break;default:n=t,a=r;}if(void 0===s)switch(this.getSettings_().endingEnd){case THREE.ZeroSlopeEnding:o=t,s=2*r-e;break;case THREE.WrapAroundEnding:o=1,s=r+i[1]-i[0];break;default:o=t-1,s=e;}t=.5*(r-e),i=this.valueSize,this._weightPrev=t/(e-a),this._weightNext=t/(s-r),this._offsetPrev=n*i,this._offsetNext=o*i;},interpolate_:function interpolate_(t,e,r,i){var n=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(t*=a)-a,h=this._offsetPrev,c=this._offsetNext,l=this._weightPrev,u=this._weightNext,d=(r-e)/(i-e);for(e=-l*(i=(r=d*d)*d)+2*l*r-l*d,l=(1+l)*i+(-1.5-2*l)*r+(-.5+l)*d+1,d=(-1-u)*i+(1.5+u)*r+.5*d,u=u*i-u*r,r=0;r!==a;++r){n[r]=e*o[h+r]+l*o[s+r]+d*o[t+r]+u*o[c+r];}return n;}}),THREE.DiscreteInterpolant=function(t,e,r,i){THREE.Interpolant.call(this,t,e,r,i);},THREE.DiscreteInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.DiscreteInterpolant,interpolate_:function interpolate_(t,e,r,i){return this.copySampleValue_(t-1);}}),THREE.LinearInterpolant=function(t,e,r,i){THREE.Interpolant.call(this,t,e,r,i);},THREE.LinearInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.LinearInterpolant,interpolate_:function interpolate_(t,e,r,i){var n=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(t*=a)-a;for(r=1-(e=(r-e)/(i-e)),i=0;i!==a;++i){n[i]=o[s+i]*r+o[t+i]*e;}return n;}}),THREE.QuaternionLinearInterpolant=function(t,e,r,i){THREE.Interpolant.call(this,t,e,r,i);},THREE.QuaternionLinearInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.QuaternionLinearInterpolant,interpolate_:function interpolate_(t,e,r,i){var n=this.resultBuffer,o=this.sampleValues,a=this.valueSize;for(e=(r-e)/(i-e),r=(t*=a)+a;t!==r;t+=4){THREE.Quaternion.slerpFlat(n,0,o,t-a,o,t,e);}return n;}}),THREE.Clock=function(t){this.autoStart=void 0===t||t,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1;},THREE.Clock.prototype={constructor:THREE.Clock,start:function start(){this.oldTime=this.startTime=performance.now(),this.running=!0;},stop:function stop(){this.getElapsedTime(),this.running=!1;},getElapsedTime:function getElapsedTime(){return this.getDelta(),this.elapsedTime;},getDelta:function getDelta(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=performance.now();t=.001*(e-this.oldTime);this.oldTime=e,this.elapsedTime+=t;}return t;}},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function apply(t){t.addEventListener=THREE.EventDispatcher.prototype.addEventListener,t.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener,t.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener,t.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent;},addEventListener:function addEventListener(t,e){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(e)&&r[t].push(e);},hasEventListener:function hasEventListener(t,e){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[t]&&-1!==r[t].indexOf(e);},removeEventListener:function removeEventListener(t,e){if(void 0!==this._listeners){var r=this._listeners[t];if(void 0!==r){var i=r.indexOf(e);-1!==i&&r.splice(i,1);}}},dispatchEvent:function dispatchEvent(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var r=[],i=e.length,n=0;n<i;n++){r[n]=e[n];}for(n=0;n<i;n++){r[n].call(this,t);}}}}},THREE.Layers=function(){this.mask=1;},THREE.Layers.prototype={constructor:THREE.Layers,set:function set(t){this.mask=1<<t;},enable:function enable(t){this.mask|=1<<t;},toggle:function toggle(t){this.mask^=1<<t;},disable:function disable(t){this.mask&=~(1<<t);},test:function test(t){return 0!=(this.mask&t.mask);}},function(t){function e(t,e){return t.distance-e.distance;}function r(t,e,i,n){if(!1!==t.visible&&(t.raycast(e,i),!0===n)){n=0;for(var o=(t=t.children).length;n<o;n++){r(t[n],e,i,!0);}}}t.Raycaster=function(e,r,i,n){this.ray=new t.Ray(e,r),this.near=i||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function get(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points;}}});},t.Raycaster.prototype={constructor:t.Raycaster,linePrecision:1,set:function set(t,e){this.ray.set(t,e);},setFromCamera:function setFromCamera(e,r){r instanceof t.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(r.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(r).sub(this.ray.origin).normalize()):r instanceof t.OrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(r),this.ray.direction.set(0,0,-1).transformDirection(r.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.");},intersectObject:function intersectObject(t,i){var n=[];return r(t,this,n,i),n.sort(e),n;},intersectObjects:function intersectObjects(t,i){var n=[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var o=0,a=t.length;o<a;o++){r(t[o],this,n,i);}return n.sort(e),n;}};}(THREE),THREE.Object3D=function(){Object.defineProperty(this,"id",{value:THREE.Object3DIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=THREE.Object3D.DefaultUp.clone();var t=new THREE.Vector3(),e=new THREE.Euler(),r=new THREE.Quaternion(),i=new THREE.Vector3(1,1,1);e.onChange(function(){r.setFromEuler(e,!1);}),r.onChange(function(){e.setFromQuaternion(r,void 0,!1);}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:r},scale:{enumerable:!0,value:i},modelViewMatrix:{value:new THREE.Matrix4()},normalMatrix:{value:new THREE.Matrix3()}}),this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4(),this.matrixWorld=new THREE.Matrix4(),this.matrixAutoUpdate=THREE.Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new THREE.Layers(),this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={};},THREE.Object3D.DefaultUp=new THREE.Vector3(0,1,0),THREE.Object3D.DefaultMatrixAutoUpdate=!0,THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function applyMatrix(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale);},setRotationFromAxisAngle:function setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e);},setRotationFromEuler:function setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0);},setRotationFromMatrix:function setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t);},setRotationFromQuaternion:function setRotationFromQuaternion(t){this.quaternion.copy(t);},rotateOnAxis:function(){var t=new THREE.Quaternion();return function(e,r){return t.setFromAxisAngle(e,r),this.quaternion.multiply(t),this;};}(),rotateX:function(){var t=new THREE.Vector3(1,0,0);return function(e){return this.rotateOnAxis(t,e);};}(),rotateY:function(){var t=new THREE.Vector3(0,1,0);return function(e){return this.rotateOnAxis(t,e);};}(),rotateZ:function(){var t=new THREE.Vector3(0,0,1);return function(e){return this.rotateOnAxis(t,e);};}(),translateOnAxis:function(){var t=new THREE.Vector3();return function(e,r){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(r)),this;};}(),translateX:function(){var t=new THREE.Vector3(1,0,0);return function(e){return this.translateOnAxis(t,e);};}(),translateY:function(){var t=new THREE.Vector3(0,1,0);return function(e){return this.translateOnAxis(t,e);};}(),translateZ:function(){var t=new THREE.Vector3(0,0,1);return function(e){return this.translateOnAxis(t,e);};}(),localToWorld:function localToWorld(t){return t.applyMatrix4(this.matrixWorld);},worldToLocal:function(){var t=new THREE.Matrix4();return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld));};}(),lookAt:function(){var t=new THREE.Matrix4();return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t);};}(),add:function add(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++){this.add(arguments[e]);}return this;}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t instanceof THREE.Object3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this);},remove:function remove(t){if(1<arguments.length)for(var e=0;e<arguments.length;e++){this.remove(arguments[e]);}-1!==(e=this.children.indexOf(t))&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(e,1));},getObjectById:function getObjectById(t){return this.getObjectByProperty("id",t);},getObjectByName:function getObjectByName(t){return this.getObjectByProperty("name",t);},getObjectByProperty:function getObjectByProperty(t,e){if(this[t]===e)return this;for(var r=0,i=this.children.length;r<i;r++){var n=this.children[r].getObjectByProperty(t,e);if(void 0!==n)return n;}},getWorldPosition:function getWorldPosition(t){return t=t||new THREE.Vector3(),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld);},getWorldQuaternion:function(){var t=new THREE.Vector3(),e=new THREE.Vector3();return function(r){return r=r||new THREE.Quaternion(),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,r,e),r;};}(),getWorldRotation:function(){var t=new THREE.Quaternion();return function(e){return e=e||new THREE.Euler(),this.getWorldQuaternion(t),e.setFromQuaternion(t,this.rotation.order,!1);};}(),getWorldScale:function(){var t=new THREE.Vector3(),e=new THREE.Quaternion();return function(r){return r=r||new THREE.Vector3(),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,r),r;};}(),getWorldDirection:function(){var t=new THREE.Quaternion();return function(e){return e=e||new THREE.Vector3(),this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t);};}(),raycast:function raycast(){},traverse:function traverse(t){t(this);for(var e=this.children,r=0,i=e.length;r<i;r++){e[r].traverse(t);}},traverseVisible:function traverseVisible(t){if(!1!==this.visible){t(this);for(var e=this.children,r=0,i=e.length;r<i;r++){e[r].traverseVisible(t);}}},traverseAncestors:function traverseAncestors(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t));},updateMatrix:function updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0;},updateMatrixWorld:function updateMatrixWorld(t){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==t||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=0,r=this.children.length;e<r;e++){this.children[e].updateMatrixWorld(t);}},toJSON:function toJSON(t){function e(t){var e,r=[];for(e in t){var i=t[e];delete i.metadata,r.push(i);}return r;}var r={};(o=void 0===t)&&(t={geometries:{},materials:{},textures:{},images:{}},r.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var i={};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),i.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),i.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),i.material=this.material.uuid),0<this.children.length){i.children=[];for(var n=0;n<this.children.length;n++){i.children.push(this.children[n].toJSON(t).object);}}if(o){var o=e(t.geometries),a=(n=e(t.materials),e(t.textures));t=e(t.images),0<o.length&&(r.geometries=o),0<n.length&&(r.materials=n),0<a.length&&(r.textures=a),0<t.length&&(r.images=t);}return r.object=i,r;},clone:function clone(t){return new this.constructor().copy(this,t);},copy:function copy(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.rotationAutoUpdate=t.rotationAutoUpdate,this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var r=0;r<t.children.length;r++){this.add(t.children[r].clone());}return this;}},THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype),THREE.Object3DIdCount=0,THREE.Face3=function(t,e,r,i,n,o){this.a=t,this.b=e,this.c=r,this.normal=i instanceof THREE.Vector3?i:new THREE.Vector3(),this.vertexNormals=Array.isArray(i)?i:[],this.color=n instanceof THREE.Color?n:new THREE.Color(),this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=void 0!==o?o:0;},THREE.Face3.prototype={constructor:THREE.Face3,clone:function clone(){return new this.constructor().copy(this);},copy:function copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,r=t.vertexNormals.length;e<r;e++){this.vertexNormals[e]=t.vertexNormals[e].clone();}for(e=0,r=t.vertexColors.length;e<r;e++){this.vertexColors[e]=t.vertexColors[e].clone();}return this;}},THREE.BufferAttribute=function(t,e){this.uuid=THREE.Math.generateUUID(),this.array=t,this.itemSize=e,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0;},THREE.BufferAttribute.prototype={constructor:THREE.BufferAttribute,get count(){return this.array.length/this.itemSize;},set needsUpdate(t){!0===t&&this.version++;},setDynamic:function setDynamic(t){return this.dynamic=t,this;},copy:function copy(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.dynamic=t.dynamic,this;},copyAt:function copyAt(t,e,r){t*=this.itemSize,r*=e.itemSize;for(var i=0,n=this.itemSize;i<n;i++){this.array[t+i]=e.array[r+i];}return this;},copyArray:function copyArray(t){return this.array.set(t),this;},copyColorsArray:function copyColorsArray(t){for(var e=this.array,r=0,i=0,n=t.length;i<n;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new THREE.Color()),e[r++]=o.r,e[r++]=o.g,e[r++]=o.b;}return this;},copyIndicesArray:function copyIndicesArray(t){for(var e=this.array,r=0,i=0,n=t.length;i<n;i++){var o=t[i];e[r++]=o.a,e[r++]=o.b,e[r++]=o.c;}return this;},copyVector2sArray:function copyVector2sArray(t){for(var e=this.array,r=0,i=0,n=t.length;i<n;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),o=new THREE.Vector2()),e[r++]=o.x,e[r++]=o.y;}return this;},copyVector3sArray:function copyVector3sArray(t){for(var e=this.array,r=0,i=0,n=t.length;i<n;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new THREE.Vector3()),e[r++]=o.x,e[r++]=o.y,e[r++]=o.z;}return this;},copyVector4sArray:function copyVector4sArray(t){for(var e=this.array,r=0,i=0,n=t.length;i<n;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new THREE.Vector4()),e[r++]=o.x,e[r++]=o.y,e[r++]=o.z,e[r++]=o.w;}return this;},set:function set(t,e){return void 0===e&&(e=0),this.array.set(t,e),this;},getX:function getX(t){return this.array[t*this.itemSize];},setX:function setX(t,e){return this.array[t*this.itemSize]=e,this;},getY:function getY(t){return this.array[t*this.itemSize+1];},setY:function setY(t,e){return this.array[t*this.itemSize+1]=e,this;},getZ:function getZ(t){return this.array[t*this.itemSize+2];},setZ:function setZ(t,e){return this.array[t*this.itemSize+2]=e,this;},getW:function getW(t){return this.array[t*this.itemSize+3];},setW:function setW(t,e){return this.array[t*this.itemSize+3]=e,this;},setXY:function setXY(t,e,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this;},setXYZ:function setXYZ(t,e,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this;},setXYZW:function setXYZW(t,e,r,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this.array[t+3]=n,this;},clone:function clone(){return new this.constructor().copy(this);}},THREE.Int8Attribute=function(t,e){return new THREE.BufferAttribute(new Int8Array(t),e);},THREE.Uint8Attribute=function(t,e){return new THREE.BufferAttribute(new Uint8Array(t),e);},THREE.Uint8ClampedAttribute=function(t,e){return new THREE.BufferAttribute(new Uint8ClampedArray(t),e);},THREE.Int16Attribute=function(t,e){return new THREE.BufferAttribute(new Int16Array(t),e);},THREE.Uint16Attribute=function(t,e){return new THREE.BufferAttribute(new Uint16Array(t),e);},THREE.Int32Attribute=function(t,e){return new THREE.BufferAttribute(new Int32Array(t),e);},THREE.Uint32Attribute=function(t,e){return new THREE.BufferAttribute(new Uint32Array(t),e);},THREE.Float32Attribute=function(t,e){return new THREE.BufferAttribute(new Float32Array(t),e);},THREE.Float64Attribute=function(t,e){return new THREE.BufferAttribute(new Float64Array(t),e);},THREE.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new THREE.BufferAttribute(t,e).setDynamic(!0);},THREE.InstancedBufferAttribute=function(t,e,r){THREE.BufferAttribute.call(this,t,e),this.meshPerAttribute=r||1;},THREE.InstancedBufferAttribute.prototype=Object.create(THREE.BufferAttribute.prototype),THREE.InstancedBufferAttribute.prototype.constructor=THREE.InstancedBufferAttribute,THREE.InstancedBufferAttribute.prototype.copy=function(t){return THREE.BufferAttribute.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this;},THREE.InterleavedBuffer=function(t,e){this.uuid=THREE.Math.generateUUID(),this.array=t,this.stride=e,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0;},THREE.InterleavedBuffer.prototype={constructor:THREE.InterleavedBuffer,get length(){return this.array.length;},get count(){return this.array.length/this.stride;},set needsUpdate(t){!0===t&&this.version++;},setDynamic:function setDynamic(t){return this.dynamic=t,this;},copy:function copy(t){return this.array=new t.array.constructor(t.array),this.stride=t.stride,this.dynamic=t.dynamic,this;},copyAt:function copyAt(t,e,r){t*=this.stride,r*=e.stride;for(var i=0,n=this.stride;i<n;i++){this.array[t+i]=e.array[r+i];}return this;},set:function set(t,e){return void 0===e&&(e=0),this.array.set(t,e),this;},clone:function clone(){return new this.constructor().copy(this);}},THREE.InstancedInterleavedBuffer=function(t,e,r){THREE.InterleavedBuffer.call(this,t,e),this.meshPerAttribute=r||1;},THREE.InstancedInterleavedBuffer.prototype=Object.create(THREE.InterleavedBuffer.prototype),THREE.InstancedInterleavedBuffer.prototype.constructor=THREE.InstancedInterleavedBuffer,THREE.InstancedInterleavedBuffer.prototype.copy=function(t){return THREE.InterleavedBuffer.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this;},THREE.InterleavedBufferAttribute=function(t,e,r){this.uuid=THREE.Math.generateUUID(),this.data=t,this.itemSize=e,this.offset=r;},THREE.InterleavedBufferAttribute.prototype={constructor:THREE.InterleavedBufferAttribute,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length;},get count(){return this.data.count;},setX:function setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this;},setY:function setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this;},setZ:function setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this;},setW:function setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this;},getX:function getX(t){return this.data.array[t*this.data.stride+this.offset];},getY:function getY(t){return this.data.array[t*this.data.stride+this.offset+1];},getZ:function getZ(t){return this.data.array[t*this.data.stride+this.offset+2];},getW:function getW(t){return this.data.array[t*this.data.stride+this.offset+3];},setXY:function setXY(t,e,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this;},setXYZ:function setXYZ(t,e,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=i,this;},setXYZW:function setXYZW(t,e,r,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=i,this.data.array[t+3]=n,this;}},THREE.Geometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1;},THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function applyMatrix(t){for(var e=new THREE.Matrix3().getNormalMatrix(t),r=0,i=this.vertices.length;r<i;r++){this.vertices[r].applyMatrix4(t);}for(r=0,i=this.faces.length;r<i;r++){(t=this.faces[r]).normal.applyMatrix3(e).normalize();for(var n=0,o=t.vertexNormals.length;n<o;n++){t.vertexNormals[n].applyMatrix3(e).normalize();}}null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0;},rotateX:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4()),t.makeRotationX(e),this.applyMatrix(t),this;};}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4()),t.makeRotationY(e),this.applyMatrix(t),this;};}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4()),t.makeRotationZ(e),this.applyMatrix(t),this;};}(),translate:function(){var t;return function(e,r,i){return void 0===t&&(t=new THREE.Matrix4()),t.makeTranslation(e,r,i),this.applyMatrix(t),this;};}(),scale:function(){var t;return function(e,r,i){return void 0===t&&(t=new THREE.Matrix4()),t.makeScale(e,r,i),this.applyMatrix(t),this;};}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new THREE.Object3D()),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix);};}(),fromBufferGeometry:function fromBufferGeometry(t){function e(t,e,i){var n=void 0!==a?[l[t].clone(),l[e].clone(),l[i].clone()]:[],o=void 0!==s?[r.colors[t].clone(),r.colors[e].clone(),r.colors[i].clone()]:[];n=new THREE.Face3(t,e,i,n,o);r.faces.push(n),void 0!==h&&r.faceVertexUvs[0].push([u[t].clone(),u[e].clone(),u[i].clone()]),void 0!==c&&r.faceVertexUvs[1].push([d[t].clone(),d[e].clone(),d[i].clone()]);}var r=this,i=null!==t.index?t.index.array:void 0,n=t.attributes,o=n.position.array,a=void 0!==n.normal?n.normal.array:void 0,s=void 0!==n.color?n.color.array:void 0,h=void 0!==n.uv?n.uv.array:void 0,c=void 0!==n.uv2?n.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var l=[],u=[],d=[],p=n=0;n<o.length;n+=3,p+=2){r.vertices.push(new THREE.Vector3(o[n],o[n+1],o[n+2])),void 0!==a&&l.push(new THREE.Vector3(a[n],a[n+1],a[n+2])),void 0!==s&&r.colors.push(new THREE.Color(s[n],s[n+1],s[n+2])),void 0!==h&&u.push(new THREE.Vector2(h[p],h[p+1])),void 0!==c&&d.push(new THREE.Vector2(c[p],c[p+1]));}if(void 0!==i){if(0<(o=t.groups).length)for(n=0;n<o.length;n++){var E=(p=o[n]).start,f=p.count;for(p=E,E=E+f;p<E;p+=3){e(i[p],i[p+1],i[p+2]);}}else for(n=0;n<i.length;n+=3){e(i[n],i[n+1],i[n+2]);}}else for(n=0;n<o.length/3;n+=3){e(n,n+1,n+2);}return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this;},center:function center(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t;},normalize:function normalize(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=0===(e=this.boundingSphere.radius)?1:1/e,r=new THREE.Matrix4();return r.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix(r),this;},computeFaceNormals:function computeFaceNormals(){for(var t=new THREE.Vector3(),e=new THREE.Vector3(),r=0,i=this.faces.length;r<i;r++){var n=this.faces[r],o=this.vertices[n.a],a=this.vertices[n.b];t.subVectors(this.vertices[n.c],a),e.subVectors(o,a),t.cross(e),t.normalize(),n.normal.copy(t);}},computeVertexNormals:function computeVertexNormals(t){var e,r,i;for(void 0===t&&(t=!0),i=Array(this.vertices.length),e=0,r=this.vertices.length;e<r;e++){i[e]=new THREE.Vector3();}if(t){var n,o,a,s=new THREE.Vector3(),h=new THREE.Vector3();for(t=0,e=this.faces.length;t<e;t++){r=this.faces[t],n=this.vertices[r.a],o=this.vertices[r.b],a=this.vertices[r.c],s.subVectors(a,o),h.subVectors(n,o),s.cross(h),i[r.a].add(s),i[r.b].add(s),i[r.c].add(s);}}else for(t=0,e=this.faces.length;t<e;t++){i[(r=this.faces[t]).a].add(r.normal),i[r.b].add(r.normal),i[r.c].add(r.normal);}for(e=0,r=this.vertices.length;e<r;e++){i[e].normalize();}for(t=0,e=this.faces.length;t<e;t++){3===(n=(r=this.faces[t]).vertexNormals).length?(n[0].copy(i[r.a]),n[1].copy(i[r.b]),n[2].copy(i[r.c])):(n[0]=i[r.a].clone(),n[1]=i[r.b].clone(),n[2]=i[r.c].clone());}0<this.faces.length&&(this.normalsNeedUpdate=!0);},computeMorphNormals:function computeMorphNormals(){var t,e,r,i,n;for(r=0,i=this.faces.length;r<i;r++){for((n=this.faces[r]).__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]),t=0,e=n.vertexNormals.length;t<e;t++){n.__originalVertexNormals[t]?n.__originalVertexNormals[t].copy(n.vertexNormals[t]):n.__originalVertexNormals[t]=n.vertexNormals[t].clone();}}var o=new THREE.Geometry();for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[],n=this.morphNormals[t].faceNormals;var a,s,h=this.morphNormals[t].vertexNormals;for(r=0,i=this.faces.length;r<i;r++){a=new THREE.Vector3(),s={a:new THREE.Vector3(),b:new THREE.Vector3(),c:new THREE.Vector3()},n.push(a),h.push(s);}}for(h=this.morphNormals[t],o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),r=0,i=this.faces.length;r<i;r++){n=this.faces[r],a=h.faceNormals[r],s=h.vertexNormals[r],a.copy(n.normal),s.a.copy(n.vertexNormals[0]),s.b.copy(n.vertexNormals[1]),s.c.copy(n.vertexNormals[2]);}}for(r=0,i=this.faces.length;r<i;r++){(n=this.faces[r]).normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals;}},computeTangents:function computeTangents(){console.warn("THREE.Geometry: .computeTangents() has been removed.");},computeLineDistances:function computeLineDistances(){for(var t=0,e=this.vertices,r=0,i=e.length;r<i;r++){0<r&&(t+=e[r].distanceTo(e[r-1])),this.lineDistances[r]=t;}},computeBoundingBox:function computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3()),this.boundingBox.setFromPoints(this.vertices);},computeBoundingSphere:function computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere()),this.boundingSphere.setFromPoints(this.vertices);},merge:function merge(t,e,r){if(!1==t instanceof THREE.Geometry)console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);else{var i,n=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,h=t.faces,c=this.faceVertexUvs[0];t=t.faceVertexUvs[0],void 0===r&&(r=0),void 0!==e&&(i=new THREE.Matrix3().getNormalMatrix(e));for(var l=0,u=a.length;l<u;l++){var d=a[l].clone();void 0!==e&&d.applyMatrix4(e),o.push(d);}for(l=0,u=h.length;l<u;l++){var p,E=(a=h[l]).vertexNormals,f=a.vertexColors;for((d=new THREE.Face3(a.a+n,a.b+n,a.c+n)).normal.copy(a.normal),void 0!==i&&d.normal.applyMatrix3(i).normalize(),e=0,o=E.length;e<o;e++){p=E[e].clone(),void 0!==i&&p.applyMatrix3(i).normalize(),d.vertexNormals.push(p);}for(d.color.copy(a.color),e=0,o=f.length;e<o;e++){p=f[e],d.vertexColors.push(p.clone());}d.materialIndex=a.materialIndex+r,s.push(d);}for(l=0,u=t.length;l<u;l++){if(i=[],void 0!==(r=t[l])){for(e=0,o=r.length;e<o;e++){i.push(r[e].clone());}c.push(i);}}}},mergeMesh:function mergeMesh(t){!1==t instanceof THREE.Mesh?console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t):(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix));},mergeVertices:function mergeVertices(){var t,e,r,i={},n=[],o=[],a=Math.pow(10,4);for(e=0,r=this.vertices.length;e<r;e++){t=this.vertices[e],void 0===i[t=Math.round(t.x*a)+"_"+Math.round(t.y*a)+"_"+Math.round(t.z*a)]?(i[t]=e,n.push(this.vertices[e]),o[e]=n.length-1):o[e]=o[i[t]];}for(i=[],e=0,r=this.faces.length;e<r;e++){for((a=this.faces[e]).a=o[a.a],a.b=o[a.b],a.c=o[a.c],a=[a.a,a.b,a.c],t=0;3>t;t++){if(a[t]===a[(t+1)%3]){i.push(e);break;}}}for(e=i.length-1;0<=e;e--){for(a=i[e],this.faces.splice(a,1),o=0,r=this.faceVertexUvs.length;o<r;o++){this.faceVertexUvs[o].splice(a,1);}}return e=this.vertices.length-n.length,this.vertices=n,e;},sortFacesByMaterialIndex:function sortFacesByMaterialIndex(){for(var t=this.faces,e=t.length,r=0;r<e;r++){t[r]._id=r;}t.sort(function(t,e){return t.materialIndex-e.materialIndex;});var i,n,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];for(o&&o.length===e&&(i=[]),a&&a.length===e&&(n=[]),r=0;r<e;r++){var s=t[r]._id;i&&i.push(o[s]),n&&n.push(a[s]);}i&&(this.faceVertexUvs[0]=i),n&&(this.faceVertexUvs[1]=n);},toJSON:function toJSON(){function t(t,e,r){return r?t|1<<e:t&~(1<<e);}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==c[e]?c[e]:(c[e]=h.length/3,h.push(t.x,t.y,t.z),c[e]);}function r(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==u[e]?u[e]:(u[e]=l.length,l.push(t.getHex()),u[e]);}function i(t){var e=t.x.toString()+t.y.toString();return void 0!==p[e]?p[e]:(p[e]=d.length/2,d.push(t.x,t.y),p[e]);}var n={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),void 0!==this.parameters){var o,a=this.parameters;for(o in a){void 0!==a[o]&&(n[o]=a[o]);}return n;}for(a=[],o=0;o<this.vertices.length;o++){var s=this.vertices[o];a.push(s.x,s.y,s.z);}s=[];var h=[],c={},l=[],u={},d=[],p={};for(o=0;o<this.faces.length;o++){var E=this.faces[o],f=void 0!==this.faceVertexUvs[0][o],m=0<E.normal.length(),g=0<E.vertexNormals.length,T=1!==E.color.r||1!==E.color.g||1!==E.color.b,v=0<E.vertexColors.length,y=t(y=0,0,0);y=t(y,1,!0),y=t(y,2,!1),y=t(y,3,f),y=t(y,4,m),y=t(y,5,g),y=t(y,6,T),y=t(y,7,v);s.push(y),s.push(E.a,E.b,E.c),s.push(E.materialIndex),f&&(f=this.faceVertexUvs[0][o],s.push(i(f[0]),i(f[1]),i(f[2]))),m&&s.push(e(E.normal)),g&&(m=E.vertexNormals,s.push(e(m[0]),e(m[1]),e(m[2]))),T&&s.push(r(E.color)),v&&(E=E.vertexColors,s.push(r(E[0]),r(E[1]),r(E[2])));}return n.data={},n.data.vertices=a,n.data.normals=h,0<l.length&&(n.data.colors=l),0<d.length&&(n.data.uvs=[d]),n.data.faces=s,n;},clone:function clone(){return new THREE.Geometry().copy(this);},copy:function copy(t){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]];for(var e=t.vertices,r=0,i=e.length;r<i;r++){this.vertices.push(e[r].clone());}for(r=0,i=(e=t.faces).length;r<i;r++){this.faces.push(e[r].clone());}for(r=0,i=t.faceVertexUvs.length;r<i;r++){e=t.faceVertexUvs[r],void 0===this.faceVertexUvs[r]&&(this.faceVertexUvs[r]=[]);for(var n=0,o=e.length;n<o;n++){for(var a=e[n],s=[],h=0,c=a.length;h<c;h++){s.push(a[h].clone());}this.faceVertexUvs[r].push(s);}}return this;},dispose:function dispose(){this.dispatchEvent({type:"dispose"});}},THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype),THREE.GeometryIdCount=0,THREE.DirectGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1;},THREE.DirectGeometry.prototype={constructor:THREE.DirectGeometry,computeBoundingBox:THREE.Geometry.prototype.computeBoundingBox,computeBoundingSphere:THREE.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function computeFaceNormals(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.");},computeVertexNormals:function computeVertexNormals(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.");},computeGroups:function computeGroups(t){var e,r,i=[];t=t.faces;for(var n=0;n<t.length;n++){var o=t[n];o.materialIndex!==r&&(r=o.materialIndex,void 0!==e&&(e.count=3*n-e.start,i.push(e)),e={start:3*n,materialIndex:r});}void 0!==e&&(e.count=3*n-e.start,i.push(e)),this.groups=i;},fromGeometry:function fromGeometry(t){var e,r=t.faces,i=t.vertices,n=t.faceVertexUvs,o=n[0]&&0<n[0].length,a=n[1]&&0<n[1].length,s=t.morphTargets,h=s.length;if(0<h){e=[];for(var c=0;c<h;c++){e[c]=[];}this.morphTargets.position=e;}var l,u=t.morphNormals,d=u.length;if(0<d){for(l=[],c=0;c<d;c++){l[c]=[];}this.morphTargets.normal=l;}var p=t.skinIndices,E=t.skinWeights,f=p.length===i.length,m=E.length===i.length;for(c=0;c<r.length;c++){var g=r[c];this.vertices.push(i[g.a],i[g.b],i[g.c]);var T=g.vertexNormals;for(3===T.length?this.normals.push(T[0],T[1],T[2]):(T=g.normal,this.normals.push(T,T,T)),3===(T=g.vertexColors).length?this.colors.push(T[0],T[1],T[2]):(T=g.color,this.colors.push(T,T,T)),!0===o&&(void 0!==(T=n[0][c])?this.uvs.push(T[0],T[1],T[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new THREE.Vector2(),new THREE.Vector2(),new THREE.Vector2()))),!0===a&&(void 0!==(T=n[1][c])?this.uvs2.push(T[0],T[1],T[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new THREE.Vector2(),new THREE.Vector2(),new THREE.Vector2()))),T=0;T<h;T++){var v=s[T].vertices;e[T].push(v[g.a],v[g.b],v[g.c]);}for(T=0;T<d;T++){v=u[T].vertexNormals[c],l[T].push(v.a,v.b,v.c);}f&&this.skinIndices.push(p[g.a],p[g.b],p[g.c]),m&&this.skinWeights.push(E[g.a],E[g.b],E[g.c]);}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this;},dispose:function dispose(){this.dispatchEvent({type:"dispose"});}},THREE.EventDispatcher.prototype.apply(THREE.DirectGeometry.prototype),THREE.BufferGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0};},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,getIndex:function getIndex(){return this.index;},setIndex:function setIndex(t){this.index=t;},addAttribute:function addAttribute(t,e,r){if(!1==e instanceof THREE.BufferAttribute&&!1==e instanceof THREE.InterleavedBufferAttribute)console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(t,new THREE.BufferAttribute(e,r));else{if("index"!==t)return this.attributes[t]=e,this;console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e);}},getAttribute:function getAttribute(t){return this.attributes[t];},removeAttribute:function removeAttribute(t){return delete this.attributes[t],this;},addGroup:function addGroup(t,e,r){this.groups.push({start:t,count:e,materialIndex:void 0!==r?r:0});},clearGroups:function clearGroups(){this.groups=[];},setDrawRange:function setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e;},applyMatrix:function applyMatrix(t){var e=this.attributes.position;void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0),void 0!==(e=this.attributes.normal)&&(new THREE.Matrix3().getNormalMatrix(t).applyToVector3Array(e.array),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere();},rotateX:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4()),t.makeRotationX(e),this.applyMatrix(t),this;};}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4()),t.makeRotationY(e),this.applyMatrix(t),this;};}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4()),t.makeRotationZ(e),this.applyMatrix(t),this;};}(),translate:function(){var t;return function(e,r,i){return void 0===t&&(t=new THREE.Matrix4()),t.makeTranslation(e,r,i),this.applyMatrix(t),this;};}(),scale:function(){var t;return function(e,r,i){return void 0===t&&(t=new THREE.Matrix4()),t.makeScale(e,r,i),this.applyMatrix(t),this;};}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new THREE.Object3D()),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix);};}(),center:function center(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t;},setFromObject:function setFromObject(t){var e=t.geometry;if(t instanceof THREE.Points||t instanceof THREE.Line){t=new THREE.Float32Attribute(3*e.vertices.length,3);var r=new THREE.Float32Attribute(3*e.colors.length,3);this.addAttribute("position",t.copyVector3sArray(e.vertices)),this.addAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length&&(t=new THREE.Float32Attribute(e.lineDistances.length,1),this.addAttribute("lineDistance",t.copyArray(e.lineDistances))),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone());}else t instanceof THREE.Mesh&&e instanceof THREE.Geometry&&this.fromGeometry(e);return this;},updateFromObject:function updateFromObject(t){var e=t.geometry;if(t instanceof THREE.Mesh){var r=e.__directGeometry;if(void 0===r)return this.fromGeometry(e);r.verticesNeedUpdate=e.verticesNeedUpdate,r.normalsNeedUpdate=e.normalsNeedUpdate,r.colorsNeedUpdate=e.colorsNeedUpdate,r.uvsNeedUpdate=e.uvsNeedUpdate,r.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=r;}return!0===e.verticesNeedUpdate&&(void 0!==(r=this.attributes.position)&&(r.copyVector3sArray(e.vertices),r.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(void 0!==(r=this.attributes.normal)&&(r.copyVector3sArray(e.normals),r.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(void 0!==(r=this.attributes.color)&&(r.copyColorsArray(e.colors),r.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(void 0!==(r=this.attributes.uv)&&(r.copyVector2sArray(e.uvs),r.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(void 0!==(r=this.attributes.lineDistance)&&(r.copyArray(e.lineDistances),r.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this;},fromGeometry:function fromGeometry(t){return t.__directGeometry=new THREE.DirectGeometry().fromGeometry(t),this.fromDirectGeometry(t.__directGeometry);},fromDirectGeometry:function fromDirectGeometry(t){var e=new Float32Array(3*t.vertices.length);for(var r in this.addAttribute("position",new THREE.BufferAttribute(e,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(e=new Float32Array(3*t.normals.length),this.addAttribute("normal",new THREE.BufferAttribute(e,3).copyVector3sArray(t.normals))),0<t.colors.length&&(e=new Float32Array(3*t.colors.length),this.addAttribute("color",new THREE.BufferAttribute(e,3).copyColorsArray(t.colors))),0<t.uvs.length&&(e=new Float32Array(2*t.uvs.length),this.addAttribute("uv",new THREE.BufferAttribute(e,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(e=new Float32Array(2*t.uvs2.length),this.addAttribute("uv2",new THREE.BufferAttribute(e,2).copyVector2sArray(t.uvs2))),0<t.indices.length&&(e=new(65535<t.vertices.length?Uint32Array:Uint16Array)(3*t.indices.length),this.setIndex(new THREE.BufferAttribute(e,1).copyIndicesArray(t.indices))),this.groups=t.groups,t.morphTargets){e=[];for(var i=t.morphTargets[r],n=0,o=i.length;n<o;n++){var a=i[n],s=new THREE.Float32Attribute(3*a.length,3);e.push(s.copyVector3sArray(a));}this.morphAttributes[r]=e;}return 0<t.skinIndices.length&&(r=new THREE.Float32Attribute(4*t.skinIndices.length,4),this.addAttribute("skinIndex",r.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(r=new THREE.Float32Attribute(4*t.skinWeights.length,4),this.addAttribute("skinWeight",r.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this;},computeBoundingBox:(new THREE.Vector3(),function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3());var t=this.attributes.position.array;t&&this.boundingBox.setFromArray(t),void 0!==t&&0!==t.length||(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this);}),computeBoundingSphere:function(){var t=new THREE.Box3(),e=new THREE.Vector3();return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere());var r=this.attributes.position.array;if(r){var i=this.boundingSphere.center;t.setFromArray(r),t.center(i);for(var n=0,o=0,a=r.length;o<a;o+=3){e.fromArray(r,o),n=Math.max(n,i.distanceToSquared(e));}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this);}};}(),computeFaceNormals:function computeFaceNormals(){},computeVertexNormals:function computeVertexNormals(){var t=this.index,e=this.attributes,r=this.groups;if(e.position){var i=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(i.length),3));else for(var n=0,o=(c=e.normal.array).length;n<o;n++){c[n]=0;}var a,s,h,c=e.normal.array,l=new THREE.Vector3(),u=new THREE.Vector3(),d=new THREE.Vector3(),p=new THREE.Vector3(),E=new THREE.Vector3();if(t){t=t.array,0===r.length&&this.addGroup(0,t.length);for(var f=0,m=r.length;f<m;++f){for(o=(n=r[f]).start,a=n.count,n=o,o+=a;n<o;n+=3){a=3*t[n+0],s=3*t[n+1],h=3*t[n+2],l.fromArray(i,a),u.fromArray(i,s),d.fromArray(i,h),p.subVectors(d,u),E.subVectors(l,u),p.cross(E),c[a]+=p.x,c[a+1]+=p.y,c[a+2]+=p.z,c[s]+=p.x,c[s+1]+=p.y,c[s+2]+=p.z,c[h]+=p.x,c[h+1]+=p.y,c[h+2]+=p.z;}}}else for(n=0,o=i.length;n<o;n+=9){l.fromArray(i,n),u.fromArray(i,n+3),d.fromArray(i,n+6),p.subVectors(d,u),E.subVectors(l,u),p.cross(E),c[n]=p.x,c[n+1]=p.y,c[n+2]=p.z,c[n+3]=p.x,c[n+4]=p.y,c[n+5]=p.z,c[n+6]=p.x,c[n+7]=p.y,c[n+8]=p.z;}this.normalizeNormals(),e.normal.needsUpdate=!0;}},merge:function merge(t,e){if(!1!=t instanceof THREE.BufferGeometry){void 0===e&&(e=0);var r,i=this.attributes;for(r in i){if(void 0!==t.attributes[r])for(var n=i[r].array,o=(s=t.attributes[r]).array,a=0,s=s.itemSize*e;a<o.length;a++,s++){n[s]=o[a];}}return this;}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);},normalizeNormals:function normalizeNormals(){for(var t,e,r,i=this.attributes.normal.array,n=0,o=i.length;n<o;n+=3){t=i[n],e=i[n+1],r=i[n+2],t=1/Math.sqrt(t*t+e*e+r*r),i[n]*=t,i[n+1]*=t,i[n+2]*=t;}},toNonIndexed:function toNonIndexed(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t,e=new THREE.BufferGeometry(),r=this.index.array,i=this.attributes;for(t in i){for(var n=(o=i[t]).array,o=o.itemSize,a=new n.constructor(r.length*o),s=0,h=0,c=0,l=r.length;c<l;c++){s=r[c]*o;for(var u=0;u<o;u++){a[h++]=n[s++];}}e.addAttribute(t,new THREE.BufferAttribute(a,o));}return e;},toJSON:function toJSON(){var t={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e,r=this.parameters;for(e in r){void 0!==r[e]&&(t[e]=r[e]);}return t;}t.data={attributes:{}};var i=this.index;for(e in null!==i&&(r=Array.prototype.slice.call(i.array),t.data.index={type:i.array.constructor.name,array:r}),i=this.attributes){var n=i[e];r=Array.prototype.slice.call(n.array);t.data.attributes[e]={itemSize:n.itemSize,type:n.array.constructor.name,array:r};}return 0<(e=this.groups).length&&(t.data.groups=JSON.parse(JSON.stringify(e))),null!==(e=this.boundingSphere)&&(t.data.boundingSphere={center:e.center.toArray(),radius:e.radius}),t;},clone:function clone(){return new THREE.BufferGeometry().copy(this);},copy:function copy(t){null!==(r=t.index)&&this.setIndex(r.clone());var e,r=t.attributes;for(e in r){this.addAttribute(e,r[e].clone());}for(e=0,r=(t=t.groups).length;e<r;e++){var i=t[e];this.addGroup(i.start,i.count);}return this;},dispose:function dispose(){this.dispatchEvent({type:"dispose"});}},THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype),THREE.BufferGeometry.MaxIndex=65535,THREE.InstancedBufferGeometry=function(){THREE.BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0;},THREE.InstancedBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.InstancedBufferGeometry.prototype.constructor=THREE.InstancedBufferGeometry,THREE.InstancedBufferGeometry.prototype.addGroup=function(t,e,r){this.groups.push({start:t,count:e,instances:r});},THREE.InstancedBufferGeometry.prototype.copy=function(t){null!==(r=t.index)&&this.setIndex(r.clone());var e,r=t.attributes;for(e in r){this.addAttribute(e,r[e].clone());}for(e=0,r=(t=t.groups).length;e<r;e++){var i=t[e];this.addGroup(i.start,i.count,i.instances);}return this;},THREE.EventDispatcher.prototype.apply(THREE.InstancedBufferGeometry.prototype),THREE.Uniform=function(t,e){this.type=t,this.value=e,this.dynamic=!1;},THREE.Uniform.prototype={constructor:THREE.Uniform,onUpdate:function onUpdate(t){return this.dynamic=!0,this.onUpdateCallback=t,this;}},THREE.AnimationClip=function(t,e,r){this.name=t||THREE.Math.generateUUID(),this.tracks=r,this.duration=void 0!==e?e:-1,0>this.duration&&this.resetDuration(),this.trim(),this.optimize();},THREE.AnimationClip.prototype={constructor:THREE.AnimationClip,resetDuration:function resetDuration(){for(var t=0,e=0,r=this.tracks.length;e!==r;++e){var i=this.tracks[e];t=Math.max(t,i.times[i.times.length-1]);}this.duration=t;},trim:function trim(){for(var t=0;t<this.tracks.length;t++){this.tracks[t].trim(0,this.duration);}return this;},optimize:function optimize(){for(var t=0;t<this.tracks.length;t++){this.tracks[t].optimize();}return this;}},Object.assign(THREE.AnimationClip,{parse:function parse(t){for(var e=[],r=t.tracks,i=1/(t.fps||1),n=0,o=r.length;n!==o;++n){e.push(THREE.KeyframeTrack.parse(r[n]).scale(i));}return new THREE.AnimationClip(t.name,t.duration,e);},toJSON:function toJSON(t){var e=[],r=t.tracks;t={name:t.name,duration:t.duration,tracks:e};for(var i=0,n=r.length;i!==n;++i){e.push(THREE.KeyframeTrack.toJSON(r[i]));}return t;},CreateFromMorphTargetSequence:function CreateFromMorphTargetSequence(t,e,r){for(var i=e.length,n=[],o=0;o<i;o++){var a=[];(h=[]).push((o+i-1)%i,o,(o+1)%i),a.push(0,1,0);var s=THREE.AnimationUtils.getKeyframeOrder(h),h=THREE.AnimationUtils.sortedArray(h,1,s);a=THREE.AnimationUtils.sortedArray(a,1,s);0===h[0]&&(h.push(i),a.push(a[0])),n.push(new THREE.NumberKeyframeTrack(".morphTargetInfluences["+e[o].name+"]",h,a).scale(1/r));}return new THREE.AnimationClip(t,-1,n);},findByName:function findByName(t,e){for(var r=0;r<t.length;r++){if(t[r].name===e)return t[r];}return null;},CreateClipsFromMorphTargetSequences:function CreateClipsFromMorphTargetSequences(t,e){for(var r={},i=/^([\w-]*?)([\d]+)$/,n=0,o=t.length;n<o;n++){var a=t[n],s=a.name.match(i);if(s&&1<s.length){var h=s[1];(s=r[h])||(r[h]=s=[]),s.push(a);}}for(h in i=[],r){i.push(THREE.AnimationClip.CreateFromMorphTargetSequence(h,r[h],e));}return i;},parseAnimation:function parseAnimation(t,e,r){if(!t)return console.error("  no animation in JSONLoader data"),null;r=function r(t,e,_r,i,n){if(0!==_r.length){var o=[],a=[];THREE.AnimationUtils.flattenJSON(_r,o,a,i),0!==o.length&&n.push(new t(e,o,a));}};var i=[],n=t.name||"default",o=t.length||-1,a=t.fps||30;t=t.hierarchy||[];for(var s=0;s<t.length;s++){var h=t[s].keys;if(h&&0!=h.length)if(h[0].morphTargets){o={};for(var c=0;c<h.length;c++){if(h[c].morphTargets)for(var l=0;l<h[c].morphTargets.length;l++){o[h[c].morphTargets[l]]=-1;}}for(var u in o){var d=[],p=[];for(l=0;l!==h[c].morphTargets.length;++l){var E=h[c];d.push(E.time),p.push(E.morphTarget===u?1:0);}i.push(new THREE.NumberKeyframeTrack(".morphTargetInfluence["+u+"]",d,p));}o=o.length*(a||1);}else c=".bones["+e[s].name+"]",r(THREE.VectorKeyframeTrack,c+".position",h,"pos",i),r(THREE.QuaternionKeyframeTrack,c+".quaternion",h,"rot",i),r(THREE.VectorKeyframeTrack,c+".scale",h,"scl",i);}return 0===i.length?null:new THREE.AnimationClip(n,o,i);}}),THREE.AnimationMixer=function(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1;},THREE.AnimationMixer.prototype={constructor:THREE.AnimationMixer,clipAction:function clipAction(t,e){var r,i=(e||this._root).uuid,n="string"==typeof t?t:t.name,o=t!==n?t:null,a=this._actionsByClip[n];if(void 0!==a){if(void 0!==(r=a.actionByRoot[i]))return r;if(o=(r=a.knownActions[0])._clip,t!==n&&t!==o)throw Error("Different clips with the same name detected!");}return null===o?null:(a=new THREE.AnimationMixer._Action(this,o,e),this._bindAction(a,r),this._addInactiveAction(a,n,i),a);},existingAction:function existingAction(t,e){var r=(e||this._root).uuid,i=this._actionsByClip["string"==typeof t?t:t.name];return void 0!==i&&i.actionByRoot[r]||null;},stopAllAction:function stopAllAction(){for(var t=this._actions,e=this._nActiveActions,r=this._bindings,i=this._nActiveBindings,n=this._nActiveBindings=this._nActiveActions=0;n!==e;++n){t[n].reset();}for(n=0;n!==i;++n){r[n].useCount=0;}return this;},update:function update(t){t*=this.timeScale;for(var e=this._actions,r=this._nActiveActions,i=this.time+=t,n=Math.sign(t),o=this._accuIndex^=1,a=0;a!==r;++a){var s=e[a];s.enabled&&s._update(i,t,n,o);}for(t=this._bindings,e=this._nActiveBindings,a=0;a!==e;++a){t[a].apply(o);}return this;},getRoot:function getRoot(){return this._root;},uncacheClip:function uncacheClip(t){var e=this._actions;t=t.name;var r=this._actionsByClip;if(void 0!==(i=r[t])){for(var i,n=0,o=(i=i.knownActions).length;n!==o;++n){var a=i[n];this._deactivateAction(a);var s=a._cacheIndex,h=e[e.length-1];a._cacheIndex=null,a._byClipCacheIndex=null,h._cacheIndex=s,e[s]=h,e.pop(),this._removeInactiveBindingsForAction(a);}delete r[t];}},uncacheRoot:function uncacheRoot(t){t=t.uuid;var e,r=this._actionsByClip;for(e in r){var i=r[e].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i));}if(void 0!==(e=this._bindingsByRootAndName[t]))for(var n in e){(t=e[n]).restoreOriginalState(),this._removeInactiveBinding(t);}},uncacheAction:function uncacheAction(t,e){var r=this.existingAction(t,e);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r));}},THREE.EventDispatcher.prototype.apply(THREE.AnimationMixer.prototype),THREE.AnimationMixer._Action=function(t,e,r){this._mixer=t,this._clip=e,this._localRoot=r||null,e=(t=e.tracks).length,r=Array(e);for(var i={endingStart:THREE.ZeroCurvatureEnding,endingEnd:THREE.ZeroCurvatureEnding},n=0;n!==e;++n){var o=t[n].createInterpolant(null);r[n]=o,o.settings=i;}this._interpolantSettings=i,this._interpolants=r,this._propertyBindings=Array(e),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=THREE.LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0;},THREE.AnimationMixer._Action.prototype={constructor:THREE.AnimationMixer._Action,play:function play(){return this._mixer._activateAction(this),this;},stop:function stop(){return this._mixer._deactivateAction(this),this.reset();},reset:function reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping();},isRunning:function isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this);},isScheduled:function isScheduled(){return this._mixer._isActiveAction(this);},startAt:function startAt(t){return this._startTime=t,this;},setLoop:function setLoop(t,e){return this.loop=t,this.repetitions=e,this;},setEffectiveWeight:function setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading();},getEffectiveWeight:function getEffectiveWeight(){return this._effectiveWeight;},fadeIn:function fadeIn(t){return this._scheduleFading(t,0,1);},fadeOut:function fadeOut(t){return this._scheduleFading(t,1,0);},crossFadeFrom:function crossFadeFrom(t,e,r){if(t.fadeOut(e),this.fadeIn(e),r){r=this._clip.duration;var i=t._clip.duration,n=r/i;t.warp(1,i/r,e),this.warp(n,1,e);}return this;},crossFadeTo:function crossFadeTo(t,e,r){return t.crossFadeFrom(this,e,r);},stopFading:function stopFading(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this;},setEffectiveTimeScale:function setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping();},getEffectiveTimeScale:function getEffectiveTimeScale(){return this._effectiveTimeScale;},setDuration:function setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping();},syncWith:function syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping();},halt:function halt(t){return this.warp(this._currentTimeScale,0,t);},warp:function warp(t,e,r){var i=this._mixer,n=i.time,o=this._timeScaleInterpolant,a=this.timeScale;return null===o&&(this._timeScaleInterpolant=o=i._lendControlInterpolant()),i=o.parameterPositions,o=o.sampleValues,i[0]=n,i[1]=n+r,o[0]=t/a,o[1]=e/a,this;},stopWarping:function stopWarping(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this;},getMixer:function getMixer(){return this._mixer;},getClip:function getClip(){return this._clip;},getRoot:function getRoot(){return this._localRoot||this._mixer._root;},_update:function _update(t,e,r,i){if(null!==(n=this._startTime)){if(0>(e=(t-n)*r)||0===r)return;this._startTime=null,e*=r;}if(e*=this._updateTimeScale(t),r=this._updateTime(e),0<(t=this._updateWeight(t))){e=this._interpolants;for(var n=this._propertyBindings,o=0,a=e.length;o!==a;++o){e[o].evaluate(r),n[o].accumulate(i,t);}}},_updateWeight:function _updateWeight(t){var e=0;if(this.enabled){e=this.weight;var r=this._weightInterpolant;if(null!==r){var i=r.evaluate(t)[0];e=e*i;t>r.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1));}}return this._effectiveWeight=e;},_updateTimeScale:function _updateTimeScale(t){var e=0;if(!this.paused){e=this.timeScale;var r=this._timeScaleInterpolant;if(null!==r){e=e*r.evaluate(t)[0];t>r.parameterPositions[1]&&(this.stopWarping(),0===e?this.pause=!0:this.timeScale=e);}}return this._effectiveTimeScale=e;},_updateTime:function _updateTime(t){var e=this.time+t;if(0===t)return e;var r=this._clip.duration,i=this.loop,n=this._loopCount,o=!1;switch(i){case THREE.LoopOnce:if(-1===n&&(this.loopCount=0,this._setEndings(!0,!0,!1)),e>=r)e=r;else{if(!(0>e))break;e=0;}this.clampWhenFinished?this.pause=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1});break;case THREE.LoopPingPong:o=!0;case THREE.LoopRepeat:if(-1===n&&(0<t?(n=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=r||0>e){var a=Math.floor(e/r),s=(e=e-r*a,n=n+Math.abs(a),this.repetitions-n);if(0>s){this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=0<t?r:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1});break;}0===s?(t=0>t,this._setEndings(t,!t,o)):this._setEndings(!1,!1,o),this._loopCount=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a});}if(i===THREE.LoopPingPong&&1==(1&n))return this.time=e,r-e;}return this.time=e;},_setEndings:function _setEndings(t,e,r){var i=this._interpolantSettings;r?(i.endingStart=THREE.ZeroSlopeEnding,i.endingEnd=THREE.ZeroSlopeEnding):(i.endingStart=t?this.zeroSlopeAtStart?THREE.ZeroSlopeEnding:THREE.ZeroCurvatureEnding:THREE.WrapAroundEnding,i.endingEnd=e?this.zeroSlopeAtEnd?THREE.ZeroSlopeEnding:THREE.ZeroCurvatureEnding:THREE.WrapAroundEnding);},_scheduleFading:function _scheduleFading(t,e,r){var i=this._mixer,n=i.time,o=this._weightInterpolant;return null===o&&(this._weightInterpolant=o=i._lendControlInterpolant()),i=o.parameterPositions,o=o.sampleValues,i[0]=n,o[0]=e,i[1]=n+t,o[1]=r,this;}},Object.assign(THREE.AnimationMixer.prototype,{_bindAction:function _bindAction(t,e){var r=t._localRoot||this._root,i=t._clip.tracks,n=i.length,o=t._propertyBindings,a=t._interpolants,s=r.uuid,h=this._bindingsByRootAndName,c=h[s];for(void 0===c&&(c={},h[s]=c),h=0;h!==n;++h){var l=i[h],u=l.name,d=c[u];if(void 0===d){if(void 0!==(d=o[h])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,u));continue;}++(d=new THREE.PropertyMixer(THREE.PropertyBinding.create(r,u,e&&e._propertyBindings[h].binding.parsedPath),l.ValueTypeName,l.getValueSize())).referenceCount,this._addInactiveBinding(d,s,u);}o[h]=d,a[h].resultBuffer=d.buffer;}},_activateAction:function _activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,r=t._clip.name,i=this._actionsByClip[r];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,r,e);}for(r=0,i=(e=t._propertyBindings).length;r!==i;++r){var n=e[r];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState());}this._lendAction(t);}},_deactivateAction:function _deactivateAction(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,r=0,i=e.length;r!==i;++r){var n=e[r];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n));}this._takeBackAction(t);}},_initMemoryManager:function _initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length;},get inUse(){return t._nActiveActions;}},bindings:{get total(){return t._bindings.length;},get inUse(){return t._nActiveBindings;}},controlInterpolants:{get total(){return t._controlInterpolants.length;},get inUse(){return t._nActiveControlInterpolants;}}};},_isActiveAction:function _isActiveAction(t){return null!==(t=t._cacheIndex)&&t<this._nActiveActions;},_addInactiveAction:function _addInactiveAction(t,e,r){var i=this._actions,n=this._actionsByClip,o=n[e];void 0===o?(o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,n[e]=o):(e=o.knownActions,t._byClipCacheIndex=e.length,e.push(t)),t._cacheIndex=i.length,i.push(t),o.actionByRoot[r]=t;},_removeInactiveAction:function _removeInactiveAction(t){var e=this._actions,r=e[e.length-1],i=t._cacheIndex;r._cacheIndex=i,e[i]=r,e.pop(),t._cacheIndex=null;r=t._clip.name;var n=(i=this._actionsByClip)[r],o=n.knownActions,a=o[o.length-1],s=t._byClipCacheIndex;a._byClipCacheIndex=s,o[s]=a,o.pop(),t._byClipCacheIndex=null,delete n.actionByRoot[(e._localRoot||this._root).uuid],0===o.length&&delete i[r],this._removeInactiveBindingsForAction(t);},_removeInactiveBindingsForAction:function _removeInactiveBindingsForAction(t){for(var e=0,r=(t=t._propertyBindings).length;e!==r;++e){var i=t[e];0==--i.referenceCount&&this._removeInactiveBinding(i);}},_lendAction:function _lendAction(t){var e=this._actions,r=t._cacheIndex,i=this._nActiveActions++,n=e[i];t._cacheIndex=i,e[i]=t,n._cacheIndex=r,e[r]=n;},_takeBackAction:function _takeBackAction(t){var e=this._actions,r=t._cacheIndex,i=--this._nActiveActions,n=e[i];t._cacheIndex=i,e[i]=t,n._cacheIndex=r,e[r]=n;},_addInactiveBinding:function _addInactiveBinding(t,e,r){var i=this._bindingsByRootAndName,n=i[e],o=this._bindings;void 0===n&&(n={},i[e]=n),n[r]=t,t._cacheIndex=o.length,o.push(t);},_removeInactiveBinding:function _removeInactiveBinding(t){var e=this._bindings,r=(i=t.binding).rootNode.uuid,i=i.path,n=this._bindingsByRootAndName,o=n[r],a=e[e.length-1];t=t._cacheIndex,a._cacheIndex=t,e[t]=a,e.pop(),delete o[i];t:{for(var s in o){break t;}delete n[r];}},_lendBinding:function _lendBinding(t){var e=this._bindings,r=t._cacheIndex,i=this._nActiveBindings++,n=e[i];t._cacheIndex=i,e[i]=t,n._cacheIndex=r,e[r]=n;},_takeBackBinding:function _takeBackBinding(t){var e=this._bindings,r=t._cacheIndex,i=--this._nActiveBindings,n=e[i];t._cacheIndex=i,e[i]=t,n._cacheIndex=r,e[r]=n;},_lendControlInterpolant:function _lendControlInterpolant(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,r=t[e];return void 0===r&&((r=new THREE.LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=r),r;},_takeBackControlInterpolant:function _takeBackControlInterpolant(t){var e=this._controlInterpolants,r=t.__cacheIndex,i=--this._nActiveControlInterpolants,n=e[i];t.__cacheIndex=i,e[i]=t,n.__cacheIndex=r,e[r]=n;},_controlInterpolantsResultBuffer:new Float32Array(1)}),THREE.AnimationObjectGroup=function(t){this.uuid=THREE.Math.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var r=0,i=arguments.length;r!==i;++r){e[arguments[r].uuid]=r;}this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length;},get inUse(){return this.total-n.nCachedObjects_;}},get bindingsPerObject(){return n._bindings.length;}};},THREE.AnimationObjectGroup.prototype={constructor:THREE.AnimationObjectGroup,add:function add(t){for(var e=this._objects,r=e.length,i=this.nCachedObjects_,n=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,h=s.length,c=0,l=arguments.length;c!==l;++c){var u=arguments[c],d=n[p=u.uuid];if(void 0===d){d=r++,n[p]=d,e.push(u);for(var p=0,E=h;p!==E;++p){s[p].push(new THREE.PropertyBinding(u,o[p],a[p]));}}else if(d<i){var f=e[d],m=--i;for(n[(E=e[m]).uuid]=d,e[d]=E,n[p]=m,e[m]=u,p=0,E=h;p!==E;++p){var g=s[p],T=g[d];g[d]=g[m],void 0===T&&(T=new THREE.PropertyBinding(u,o[p],a[p])),g[m]=T;}}else e[d]!==f&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...");}this.nCachedObjects_=i;},remove:function remove(t){for(var e=this._objects,r=this.nCachedObjects_,i=this._indicesByUUID,n=this._bindings,o=n.length,a=0,s=arguments.length;a!==s;++a){var h=arguments[a],c=h.uuid,l=i[c];if(void 0!==l&&l>=r){var u=r++;for(i[(d=e[u]).uuid]=l,e[l]=d,i[c]=u,e[u]=h,h=0,c=o;h!==c;++h){var d,p=(d=n[h])[l];d[l]=d[u],d[u]=p;}}}this.nCachedObjects_=r;},uncache:function uncache(t){for(var e=this._objects,r=e.length,i=this.nCachedObjects_,n=this._indicesByUUID,o=this._bindings,a=o.length,s=0,h=arguments.length;s!==h;++s){var c=n[l=arguments[s].uuid];if(void 0!==c)if(delete n[l],c<i){var l,u=e[l=--i],d=--r,p=e[d];for(n[u.uuid]=c,e[c]=u,n[p.uuid]=l,e[l]=p,e.pop(),u=0,p=a;u!==p;++u){var E=o[u],f=E[d];E[c]=E[l],E[l]=f,E.pop();}}else for(n[(p=e[d=--r]).uuid]=c,e[c]=p,e.pop(),u=0,p=a;u!==p;++u){(E=o[u])[c]=E[d],E.pop();}}this.nCachedObjects_=i;},subscribe_:function subscribe_(t,e){var r=this._bindingsIndicesByPath,i=r[t],n=this._bindings;if(void 0!==i)return n[i];var o=this._paths,a=this._parsedPaths,s=this._objects,h=this.nCachedObjects_,c=Array(s.length);i=n.length;for(r[t]=i,o.push(t),a.push(e),n.push(c),r=h,i=s.length;r!==i;++r){c[r]=new THREE.PropertyBinding(s[r],t,e);}return c;},unsubscribe_:function unsubscribe_(t){var e=this._bindingsIndicesByPath,r=e[t];if(void 0!==r){var i=this._paths,n=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=r,o[r]=s,o.pop(),n[r]=n[a],n.pop(),i[r]=i[a],i.pop();}}},THREE.AnimationUtils={arraySlice:function arraySlice(t,e,r){return THREE.AnimationUtils.isTypedArray(t)?new t.constructor(t.subarray(e,r)):t.slice(e,r);},convertArray:function convertArray(t,e,r){return!t||!r&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t);},isTypedArray:function isTypedArray(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView);},getKeyframeOrder:function getKeyframeOrder(t){for(var e=t.length,r=Array(e),i=0;i!==e;++i){r[i]=i;}return r.sort(function(e,r){return t[e]-t[r];}),r;},sortedArray:function sortedArray(t,e,r){for(var i=t.length,n=new t.constructor(i),o=0,a=0;a!==i;++o){for(var s=r[o]*e,h=0;h!==e;++h){n[a++]=t[s+h];}}return n;},flattenJSON:function flattenJSON(t,e,r,i){for(var n=1,o=t[0];void 0!==o&&void 0===o[i];){o=t[n++];}if(void 0!==o){var a=o[i];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[i])&&(e.push(o.time),r.push.apply(r,a)),o=t[n++];}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[i])&&(e.push(o.time),a.toArray(r,r.length)),o=t[n++];}while(void 0!==o);else do{void 0!==(a=o[i])&&(e.push(o.time),r.push(a)),o=t[n++];}while(void 0!==o);}}},THREE.KeyframeTrack=function(t,e,r,i){if(void 0===t)throw Error("track name is undefined");if(void 0===e||0===e.length)throw Error("no keyframes in track named "+t);this.name=t,this.times=THREE.AnimationUtils.convertArray(e,this.TimeBufferType),this.values=THREE.AnimationUtils.convertArray(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation),this.validate(),this.optimize();},THREE.KeyframeTrack.prototype={constructor:THREE.KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:THREE.InterpolateLinear,InterpolantFactoryMethodDiscrete:function InterpolantFactoryMethodDiscrete(t){return new THREE.DiscreteInterpolant(this.times,this.values,this.getValueSize(),t);},InterpolantFactoryMethodLinear:function InterpolantFactoryMethodLinear(t){return new THREE.LinearInterpolant(this.times,this.values,this.getValueSize(),t);},InterpolantFactoryMethodSmooth:function InterpolantFactoryMethodSmooth(t){return new THREE.CubicInterpolant(this.times,this.values,this.getValueSize(),t);},setInterpolation:function setInterpolation(t){var e=void 0;switch(t){case THREE.InterpolateDiscrete:e=this.InterpolantFactoryMethodDiscrete;break;case THREE.InterpolateLinear:e=this.InterpolantFactoryMethodLinear;break;case THREE.InterpolateSmooth:e=this.InterpolantFactoryMethodSmooth;}if(void 0===e){if(e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw Error(e);this.setInterpolation(this.DefaultInterpolation);}console.warn(e);}else this.createInterpolant=e;},getInterpolation:function getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return THREE.InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return THREE.InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return THREE.InterpolateSmooth;}},getValueSize:function getValueSize(){return this.values.length/this.times.length;},shift:function shift(t){if(0!==t)for(var e=this.times,r=0,i=e.length;r!==i;++r){e[r]+=t;}return this;},scale:function scale(t){if(1!==t)for(var e=this.times,r=0,i=e.length;r!==i;++r){e[r]*=t;}return this;},trim:function trim(t,e){for(var r=this.times,i=r.length,n=0,o=i-1;n!==i&&r[n]<t;){++n;}for(;-1!==o&&r[o]>e;){--o;}return++o,0===n&&o===i||(n>=o&&(n=(o=Math.max(o,1))-1),i=this.getValueSize(),this.times=THREE.AnimationUtils.arraySlice(r,n,o),this.values=THREE.AnimationUtils.arraySlice(this.values,n*i,o*i)),this;},validate:function validate(){var t=!0;0!=(r=this.getValueSize())-Math.floor(r)&&(console.error("invalid value size in track",this),t=!1);var e=this.times,r=this.values,i=e.length;0===i&&(console.error("track is empty",this),t=!1);for(var n=null,o=0;o!==i;o++){var a=e[o];if("number"==typeof a&&isNaN(a)){console.error("time is not a valid number",this,o,a),t=!1;break;}if(null!==n&&n>a){console.error("out of order keys",this,o,a,n),t=!1;break;}n=a;}if(void 0!==r&&THREE.AnimationUtils.isTypedArray(r))for(o=0,e=r.length;o!==e;++o){if(i=r[o],isNaN(i)){console.error("value is not a valid number",this,o,i),t=!1;break;}}return t;},optimize:function optimize(){for(var t=this.times,e=this.values,r=this.getValueSize(),i=1,n=1,o=t.length-1;n<=o;++n){var a=!1;if((l=t[n])!==t[n+1]&&(1!==n||l!==l[0]))for(var s=n*r,h=s-r,c=s+r,l=0;l!==r;++l){var u=e[s+l];if(u!==e[h+l]||u!==e[c+l]){a=!0;break;}}if(a){if(n!==i)for(t[i]=t[n],a=n*r,s=i*r,l=0;l!==r;++l){e[s+l]=e[a+l];}++i;}}return i!==t.length&&(this.times=THREE.AnimationUtils.arraySlice(t,0,i),this.values=THREE.AnimationUtils.arraySlice(e,0,i*r)),this;}},Object.assign(THREE.KeyframeTrack,{parse:function parse(t){if(void 0===t.type)throw Error("track type undefined, can not parse");var e=THREE.KeyframeTrack._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){console.warn("legacy JSON format detected, converting");var r=[],i=[];THREE.AnimationUtils.flattenJSON(t.keys,r,i,"value"),t.times=r,t.values=i;}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation);},toJSON:function toJSON(t){if(void 0!==(e=t.constructor).toJSON)e=e.toJSON(t);else{var e={name:t.name,times:THREE.AnimationUtils.convertArray(t.times,Array),values:THREE.AnimationUtils.convertArray(t.values,Array)},r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r);}return e.type=t.ValueTypeName,e;},_getTrackTypeForValueTypeName:function _getTrackTypeForValueTypeName(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return THREE.NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return THREE.VectorKeyframeTrack;case"color":return THREE.ColorKeyframeTrack;case"quaternion":return THREE.QuaternionKeyframeTrack;case"bool":case"boolean":return THREE.BooleanKeyframeTrack;case"string":return THREE.StringKeyframeTrack;}throw Error("Unsupported typeName: "+t);}}),THREE.PropertyBinding=function(t,e,r){this.path=e,this.parsedPath=r||THREE.PropertyBinding.parseTrackName(e),this.node=THREE.PropertyBinding.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t;},THREE.PropertyBinding.prototype={constructor:THREE.PropertyBinding,getValue:function getValue(t,e){this.bind(),this.getValue(t,e);},setValue:function setValue(t,e){this.bind(),this.setValue(t,e);},bind:function bind(){var t=this.node,e=this.parsedPath,r=e.objectName,i=e.propertyName,n=e.propertyIndex;if(t||(this.node=t=THREE.PropertyBinding.findNode(this.rootNode,e.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var o=e.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("  can not bind to material as node does not have a material",this);if(!t.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);for(t=t.skeleton.bones,r=0;r<t.length;r++){if(t[r].name===o){o=r;break;}}break;default:if(void 0===t[r])return void console.error("  can not bind to objectName of node, undefined",this);t=t[r];}if(void 0!==o){if(void 0===t[o])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,t);t=t[o];}}if(o=t[i]){if(e=this.Versioning.None,void 0!==t.needsUpdate?(e=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(e=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t),r=this.BindingType.Direct,void 0!==n){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);if(!t.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);for(r=0;r<this.node.geometry.morphTargets.length;r++){if(t.geometry.morphTargets[r].name===n){n=r;break;}}}r=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=n;}else void 0!==o.fromArray&&void 0!==o.toArray?(r=this.BindingType.HasFromToArray,this.resolvedProperty=o):void 0!==o.length?(r=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[r],this.setValue=this.SetterByBindingTypeAndVersioning[r][e];}else console.error("  trying to update property for track: "+e.nodeName+"."+i+" but it wasn't found.",t);}else console.error("  trying to update node for track: "+this.path+" but it wasn't found.");},unbind:function unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound;}},Object.assign(THREE.PropertyBinding.prototype,{_getValue_unavailable:function _getValue_unavailable(){},_setValue_unavailable:function _setValue_unavailable(){},_getValue_unbound:THREE.PropertyBinding.prototype.getValue,_setValue_unbound:THREE.PropertyBinding.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName];},function(t,e){for(var r=this.resolvedProperty,i=0,n=r.length;i!==n;++i){t[e++]=r[i];}},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex];},function(t,e){this.resolvedProperty.toArray(t,e);}],SetterByBindingTypeAndVersioning:[[function(t,e){this.node[this.propertyName]=t[e];},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.needsUpdate=!0;},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0;}],[function(t,e){for(var r=this.resolvedProperty,i=0,n=r.length;i!==n;++i){r[i]=t[e++];}},function(t,e){for(var r=this.resolvedProperty,i=0,n=r.length;i!==n;++i){r[i]=t[e++];}this.targetObject.needsUpdate=!0;},function(t,e){for(var r=this.resolvedProperty,i=0,n=r.length;i!==n;++i){r[i]=t[e++];}this.targetObject.matrixWorldNeedsUpdate=!0;}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e];},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0;},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0;}],[function(t,e){this.resolvedProperty.fromArray(t,e);},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0;},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0;}]]}),THREE.PropertyBinding.Composite=function(t,e,r){r=r||THREE.PropertyBinding.parseTrackName(e),this._targetGroup=t,this._bindings=t.subscribe_(e,r);},THREE.PropertyBinding.Composite.prototype={constructor:THREE.PropertyBinding.Composite,getValue:function getValue(t,e){this.bind();var r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(t,e);},setValue:function setValue(t,e){for(var r=this._bindings,i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i){r[i].setValue(t,e);}},bind:function bind(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e){t[e].bind();}},unbind:function unbind(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e){t[e].unbind();}}},THREE.PropertyBinding.create=function(t,e,r){return t instanceof THREE.AnimationObjectGroup?new THREE.PropertyBinding.Composite(t,e,r):new THREE.PropertyBinding(t,e,r);},THREE.PropertyBinding.parseTrackName=function(t){var e=/^(([\w]+\/)*)([\w-\d]+)?(\.([\w]+)(\[([\w\d\[\]\_. ]+)\])?)?(\.([\w.]+)(\[([\w\d\[\]\_. ]+)\])?)$/,r=e.exec(t);if(!r)throw Error("cannot parse trackName at all: "+t);if(r.index===e.lastIndex&&e.lastIndex++,null===(e={nodeName:r[3],objectName:r[5],objectIndex:r[7],propertyName:r[9],propertyIndex:r[11]}).propertyName||0===e.propertyName.length)throw Error("can not parse propertyName from trackName: "+t);return e;},THREE.PropertyBinding.findNode=function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var r=function(t){for(var r=0;r<t.bones.length;r++){var i=t.bones[r];if(i.name===e)return i;}return null;}(t.skeleton);if(r)return r;}if(t.children){var i=function i(t){for(var r=0;r<t.length;r++){var n=t[r];if(n.name===e||n.uuid===e||(n=i(n.children)))return n;}return null;};if(r=i(t.children))return r;}return null;},THREE.PropertyMixer=function(t,e,r){switch(this.binding=t,this.valueSize=r,t=Float64Array,e){case"quaternion":e=this._slerp;break;case"string":case"bool":t=Array,e=this._select;break;default:e=this._lerp;}this.buffer=new t(4*r),this._mixBufferRegion=e,this.referenceCount=this.useCount=this.cumulativeWeight=0;},THREE.PropertyMixer.prototype={constructor:THREE.PropertyMixer,accumulate:function accumulate(t,e){var r=this.buffer,i=this.valueSize,n=t*i+i,o=this.cumulativeWeight;if(0===o){for(o=0;o!==i;++o){r[n+o]=r[o];}o=e;}else o+=e,this._mixBufferRegion(r,n,0,e/o,i);this.cumulativeWeight=o;},apply:function apply(t){var e=this.valueSize,r=this.buffer;t=t*e+e;var i=this.cumulativeWeight,n=this.binding;this.cumulativeWeight=0,1>i&&this._mixBufferRegion(r,t,3*e,1-i,e);i=e;for(var o=e+e;i!==o;++i){if(r[i]!==r[i+e]){n.setValue(r,t);break;}}},saveOriginalState:function saveOriginalState(){var t=this.buffer,e=this.valueSize,r=3*e;this.binding.getValue(t,r);for(var i=e;i!==r;++i){t[i]=t[r+i%e];}this.cumulativeWeight=0;},restoreOriginalState:function restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize);},_select:function _select(t,e,r,i,n){if(.5<=i)for(i=0;i!==n;++i){t[e+i]=t[r+i];}},_slerp:function _slerp(t,e,r,i,n){THREE.Quaternion.slerpFlat(t,e,t,e,t,r,i);},_lerp:function _lerp(t,e,r,i,n){for(var o=1-i,a=0;a!==n;++a){var s=e+a;t[s]=t[s]*o+t[r+a]*i;}}},THREE.BooleanKeyframeTrack=function(t,e,r){THREE.KeyframeTrack.call(this,t,e,r);},THREE.BooleanKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:THREE.IntepolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),THREE.NumberKeyframeTrack=function(t,e,r,i){THREE.KeyframeTrack.call(this,t,e,r,i);},THREE.NumberKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.NumberKeyframeTrack,ValueTypeName:"number"}),THREE.QuaternionKeyframeTrack=function(t,e,r,i){THREE.KeyframeTrack.call(this,t,e,r,i);},THREE.QuaternionKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:THREE.InterpolateLinear,InterpolantFactoryMethodLinear:function InterpolantFactoryMethodLinear(t){return new THREE.QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),t);},InterpolantFactoryMethodSmooth:void 0}),THREE.StringKeyframeTrack=function(t,e,r,i){THREE.KeyframeTrack.call(this,t,e,r,i);},THREE.StringKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:THREE.IntepolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),THREE.VectorKeyframeTrack=function(t,e,r,i){THREE.KeyframeTrack.call(this,t,e,r,i);},THREE.VectorKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.VectorKeyframeTrack,ValueTypeName:"vector"}),THREE.Audio=function(t){THREE.Object3D.call(this),this.type="Audio",this.context=t.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filter=null;},THREE.Audio.prototype=Object.create(THREE.Object3D.prototype),THREE.Audio.prototype.constructor=THREE.Audio,THREE.Audio.prototype.getOutput=function(){return this.gain;},THREE.Audio.prototype.load=function(t){var e=new THREE.AudioBuffer(this.context);return e.load(t),this.setBuffer(e),this;},THREE.Audio.prototype.setNodeSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this;},THREE.Audio.prototype.setBuffer=function(t){var e=this;return t.onReady(function(t){e.source.buffer=t,e.sourceType="buffer",e.autoplay&&e.play();}),this;},THREE.Audio.prototype.play=function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else{var t=this.context.createBufferSource();t.buffer=this.source.buffer,t.loop=this.source.loop,t.onended=this.source.onended,t.start(0,this.startTime),t.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=t,this.connect();}},THREE.Audio.prototype.pause=function(){!1===this.hasPlaybackControl?console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=this.context.currentTime);},THREE.Audio.prototype.stop=function(){!1===this.hasPlaybackControl?console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=0);},THREE.Audio.prototype.connect=function(){null!==this.filter?(this.source.connect(this.filter),this.filter.connect(this.getOutput())):this.source.connect(this.getOutput());},THREE.Audio.prototype.disconnect=function(){null!==this.filter?(this.source.disconnect(this.filter),this.filter.disconnect(this.getOutput())):this.source.disconnect(this.getOutput());},THREE.Audio.prototype.getFilter=function(){return this.filter;},THREE.Audio.prototype.setFilter=function(t){void 0===t&&(t=null),!0===this.isPlaying?(this.disconnect(),this.filter=t,this.connect()):this.filter=t;},THREE.Audio.prototype.setPlaybackRate=function(t){!1===this.hasPlaybackControl?console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=t,!0===this.isPlaying&&(this.source.playbackRate.value=this.playbackRate));},THREE.Audio.prototype.getPlaybackRate=function(){return this.playbackRate;},THREE.Audio.prototype.onEnded=function(){this.isPlaying=!1;},THREE.Audio.prototype.setLoop=function(t){!1===this.hasPlaybackControl?console.warn("THREE.Audio: this Audio has no playback control."):this.source.loop=t;},THREE.Audio.prototype.getLoop=function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.source.loop;},THREE.Audio.prototype.setVolume=function(t){this.gain.gain.value=t;},THREE.Audio.prototype.getVolume=function(){return this.gain.gain.value;},THREE.AudioAnalyser=function(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser);},THREE.AudioAnalyser.prototype={constructor:THREE.AudioAnalyser,getData:function getData(){return this.analyser.getByteFrequencyData(this.data),this.data;}},THREE.AudioBuffer=function(t){this.context=t,this.ready=!1,this.readyCallbacks=[];},THREE.AudioBuffer.prototype.load=function(t){var e=this,r=new XMLHttpRequest();return r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(t){e.context.decodeAudioData(this.response,function(t){for(e.buffer=t,e.ready=!0,t=0;t<e.readyCallbacks.length;t++){e.readyCallbacks[t](e.buffer);}e.readyCallbacks=[];});},r.send(),this;},THREE.AudioBuffer.prototype.onReady=function(t){this.ready?t(this.buffer):this.readyCallbacks.push(t);},THREE.PositionalAudio=function(t){THREE.Audio.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain);},THREE.PositionalAudio.prototype=Object.create(THREE.Audio.prototype),THREE.PositionalAudio.prototype.constructor=THREE.PositionalAudio,THREE.PositionalAudio.prototype.getOutput=function(){return this.panner;},THREE.PositionalAudio.prototype.setRefDistance=function(t){this.panner.refDistance=t;},THREE.PositionalAudio.prototype.getRefDistance=function(){return this.panner.refDistance;},THREE.PositionalAudio.prototype.setRolloffFactor=function(t){this.panner.rolloffFactor=t;},THREE.PositionalAudio.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor;},THREE.PositionalAudio.prototype.setDistanceModel=function(t){this.panner.distanceModel=t;},THREE.PositionalAudio.prototype.getDistanceModel=function(){return this.panner.distanceModel;},THREE.PositionalAudio.prototype.setMaxDistance=function(t){this.panner.maxDistance=t;},THREE.PositionalAudio.prototype.getMaxDistance=function(){return this.panner.maxDistance;},THREE.PositionalAudio.prototype.updateMatrixWorld=function(){var t=new THREE.Vector3();return function(e){THREE.Object3D.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z);};}(),THREE.AudioListener=function(){THREE.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext)(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null;},THREE.AudioListener.prototype=Object.create(THREE.Object3D.prototype),THREE.AudioListener.prototype.constructor=THREE.AudioListener,THREE.AudioListener.prototype.getInput=function(){return this.gain;},THREE.AudioListener.prototype.removeFilter=function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null);},THREE.AudioListener.prototype.setFilter=function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination);},THREE.AudioListener.prototype.getFilter=function(){return this.filter;},THREE.AudioListener.prototype.setMasterVolume=function(t){this.gain.gain.value=t;},THREE.AudioListener.prototype.getMasterVolume=function(){return this.gain.gain.value;},THREE.AudioListener.prototype.updateMatrixWorld=function(){var t=new THREE.Vector3(),e=new THREE.Quaternion(),r=new THREE.Vector3(),i=new THREE.Vector3();return function(n){THREE.Object3D.prototype.updateMatrixWorld.call(this,n),n=this.context.listener;var o=this.up;this.matrixWorld.decompose(t,e,r),i.set(0,0,-1).applyQuaternion(e),n.setPosition(t.x,t.y,t.z),n.setOrientation(i.x,i.y,i.z,o.x,o.y,o.z);};}(),THREE.Camera=function(){THREE.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new THREE.Matrix4(),this.projectionMatrix=new THREE.Matrix4();},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.constructor=THREE.Camera,THREE.Camera.prototype.getWorldDirection=function(){var t=new THREE.Quaternion();return function(e){return e=e||new THREE.Vector3(),this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t);};}(),THREE.Camera.prototype.lookAt=function(){var t=new THREE.Matrix4();return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t);};}(),THREE.Camera.prototype.clone=function(){return new this.constructor().copy(this);},THREE.Camera.prototype.copy=function(t){return THREE.Object3D.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this;},THREE.CubeCamera=function(t,e,r){THREE.Object3D.call(this),this.type="CubeCamera";var i=new THREE.PerspectiveCamera(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new THREE.Vector3(1,0,0)),this.add(i);var n=new THREE.PerspectiveCamera(90,1,t,e);n.up.set(0,-1,0),n.lookAt(new THREE.Vector3(-1,0,0)),this.add(n);var o=new THREE.PerspectiveCamera(90,1,t,e);o.up.set(0,0,1),o.lookAt(new THREE.Vector3(0,1,0)),this.add(o);var a=new THREE.PerspectiveCamera(90,1,t,e);a.up.set(0,0,-1),a.lookAt(new THREE.Vector3(0,-1,0)),this.add(a);var s=new THREE.PerspectiveCamera(90,1,t,e);s.up.set(0,-1,0),s.lookAt(new THREE.Vector3(0,0,1)),this.add(s);var h=new THREE.PerspectiveCamera(90,1,t,e);h.up.set(0,-1,0),h.lookAt(new THREE.Vector3(0,0,-1)),this.add(h),this.renderTarget=new THREE.WebGLRenderTargetCube(r,r,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter}),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var r=this.renderTarget,c=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,r.activeCubeFace=0,t.render(e,i,r),r.activeCubeFace=1,t.render(e,n,r),r.activeCubeFace=2,t.render(e,o,r),r.activeCubeFace=3,t.render(e,a,r),r.activeCubeFace=4,t.render(e,s,r),r.texture.generateMipmaps=c,r.activeCubeFace=5,t.render(e,h,r),t.setRenderTarget(null);};},THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype),THREE.CubeCamera.prototype.constructor=THREE.CubeCamera,THREE.OrthographicCamera=function(t,e,r,i,n,o){THREE.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=t,this.right=e,this.top=r,this.bottom=i,this.near=void 0!==n?n:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix();},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.constructor=THREE.OrthographicCamera,THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(r-t,r+t,i+e,i-e,this.near,this.far);},THREE.OrthographicCamera.prototype.copy=function(t){return THREE.Camera.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this;},THREE.OrthographicCamera.prototype.toJSON=function(t){return(t=THREE.Object3D.prototype.toJSON.call(this,t)).object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,t;},THREE.PerspectiveCamera=function(t,e,r,i){THREE.Camera.call(this),this.type="PerspectiveCamera",this.focalLength=10,this.zoom=1,this.fov=void 0!==t?t:50,this.aspect=void 0!==e?e:1,this.near=void 0!==r?r:.1,this.far=void 0!==i?i:2e3,this.updateProjectionMatrix();},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.constructor=THREE.PerspectiveCamera,THREE.PerspectiveCamera.prototype.setLens=function(t,e){void 0===e&&(e=24),this.fov=2*THREE.Math.radToDeg(Math.atan(e/(2*t))),this.updateProjectionMatrix();},THREE.PerspectiveCamera.prototype.setViewOffset=function(t,e,r,i,n,o){this.fullWidth=t,this.fullHeight=e,this.x=r,this.y=i,this.width=n,this.height=o,this.updateProjectionMatrix();},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var t=THREE.Math.radToDeg(2*Math.atan(Math.tan(.5*THREE.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var e=(r=this.fullWidth/this.fullHeight)*(i=-(t=Math.tan(THREE.Math.degToRad(.5*t))*this.near)),r=Math.abs(r*t-e),i=Math.abs(t-i);this.projectionMatrix.makeFrustum(e+this.x*r/this.fullWidth,e+(this.x+this.width)*r/this.fullWidth,t-(this.y+this.height)*i/this.fullHeight,t-this.y*i/this.fullHeight,this.near,this.far);}else this.projectionMatrix.makePerspective(t,this.aspect,this.near,this.far);},THREE.PerspectiveCamera.prototype.copy=function(t){return THREE.Camera.prototype.copy.call(this,t),this.focalLength=t.focalLength,this.zoom=t.zoom,this.fov=t.fov,this.aspect=t.aspect,this.near=t.near,this.far=t.far,this;},THREE.PerspectiveCamera.prototype.toJSON=function(t){return(t=THREE.Object3D.prototype.toJSON.call(this,t)).object.focalLength=this.focalLength,t.object.zoom=this.zoom,t.object.fov=this.fov,t.object.aspect=this.aspect,t.object.near=this.near,t.object.far=this.far,t;},THREE.StereoCamera=function(){this.type="StereoCamera",this.aspect=1,this.cameraL=new THREE.PerspectiveCamera(),this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new THREE.PerspectiveCamera(),this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1;},THREE.StereoCamera.prototype={constructor:THREE.StereoCamera,update:function(){var t,e,r,i,n,o=new THREE.Matrix4(),a=new THREE.Matrix4();return function(s){if(t!==s.focalLength||e!==s.fov||r!==s.aspect*this.aspect||i!==s.near||n!==s.far){t=s.focalLength,e=s.fov,r=s.aspect*this.aspect,i=s.near,n=s.far;var h,c,l=s.projectionMatrix.clone(),u=.032*i/t,d=i*Math.tan(THREE.Math.degToRad(.5*e));a.elements[12]=-.032,o.elements[12]=.032,h=-d*r+u,c=d*r+u,l.elements[0]=2*i/(c-h),l.elements[8]=(c+h)/(c-h),this.cameraL.projectionMatrix.copy(l),h=-d*r-u,c=d*r-u,l.elements[0]=2*i/(c-h),l.elements[8]=(c+h)/(c-h),this.cameraR.projectionMatrix.copy(l);}this.cameraL.matrixWorld.copy(s.matrixWorld).multiply(a),this.cameraR.matrixWorld.copy(s.matrixWorld).multiply(o);};}()},THREE.Light=function(t,e){THREE.Object3D.call(this),this.type="Light",this.color=new THREE.Color(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0;},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.constructor=THREE.Light,THREE.Light.prototype.copy=function(t){return THREE.Object3D.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this;},THREE.Light.prototype.toJSON=function(t){return(t=THREE.Object3D.prototype.toJSON.call(this,t)).object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),t;},THREE.LightShadow=function(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new THREE.Vector2(512,512),this.map=null,this.matrix=new THREE.Matrix4();},THREE.LightShadow.prototype={constructor:THREE.LightShadow,copy:function copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this;},clone:function clone(){return new this.constructor().copy(this);}},THREE.AmbientLight=function(t,e){THREE.Light.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0;},THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype),THREE.AmbientLight.prototype.constructor=THREE.AmbientLight,THREE.DirectionalLight=function(t,e){THREE.Light.call(this,t,e),this.type="DirectionalLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new THREE.Object3D(),this.shadow=new THREE.LightShadow(new THREE.OrthographicCamera(-5,5,5,-5,.5,500));},THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight.prototype.constructor=THREE.DirectionalLight,THREE.DirectionalLight.prototype.copy=function(t){return THREE.Light.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this;},THREE.HemisphereLight=function(t,e,r){THREE.Light.call(this,t,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.set(0,1,0),this.updateMatrix(),this.groundColor=new THREE.Color(e);},THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype),THREE.HemisphereLight.prototype.constructor=THREE.HemisphereLight,THREE.HemisphereLight.prototype.copy=function(t){return THREE.Light.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this;},THREE.PointLight=function(t,e,r,i){THREE.Light.call(this,t,e),this.type="PointLight",this.distance=void 0!==r?r:0,this.decay=void 0!==i?i:1,this.shadow=new THREE.LightShadow(new THREE.PerspectiveCamera(90,1,.5,500));},THREE.PointLight.prototype=Object.create(THREE.Light.prototype),THREE.PointLight.prototype.constructor=THREE.PointLight,THREE.PointLight.prototype.copy=function(t){return THREE.Light.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this;},THREE.SpotLight=function(t,e,r,i,n,o){THREE.Light.call(this,t,e),this.type="SpotLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new THREE.Object3D(),this.distance=void 0!==r?r:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==n?n:0,this.decay=void 0!==o?o:1,this.shadow=new THREE.LightShadow(new THREE.PerspectiveCamera(50,1,.5,500));},THREE.SpotLight.prototype=Object.create(THREE.Light.prototype),THREE.SpotLight.prototype.constructor=THREE.SpotLight,THREE.SpotLight.prototype.copy=function(t){return THREE.Light.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this;},THREE.Cache={enabled:!1,files:{},add:function add(t,e){!1!==this.enabled&&(this.files[t]=e);},get:function get(t){if(!1!==this.enabled)return this.files[t];},remove:function remove(t){delete this.files[t];},clear:function clear(){this.files={};}},THREE.Loader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){};},THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,extractUrlBase:function extractUrlBase(t){return 1===(t=t.split("/")).length?"./":(t.pop(),t.join("/")+"/");},initMaterials:function initMaterials(t,e,r){for(var i=[],n=0;n<t.length;++n){i[n]=this.createMaterial(t[n],e,r);}return i;},createMaterial:function(){var t,e,r;return function(i,n,o){function a(t,r,i,a,s){t=n+t;var c=THREE.Loader.Handlers.get(t);return null!==c?t=c.load(t):(e.setCrossOrigin(o),t=e.load(t)),void 0!==r&&(t.repeat.fromArray(r),1!==r[0]&&(t.wrapS=THREE.RepeatWrapping),1!==r[1]&&(t.wrapT=THREE.RepeatWrapping)),void 0!==i&&t.offset.fromArray(i),void 0!==a&&("repeat"===a[0]&&(t.wrapS=THREE.RepeatWrapping),"mirror"===a[0]&&(t.wrapS=THREE.MirroredRepeatWrapping),"repeat"===a[1]&&(t.wrapT=THREE.RepeatWrapping),"mirror"===a[1]&&(t.wrapT=THREE.MirroredRepeatWrapping)),void 0!==s&&(t.anisotropy=s),r=THREE.Math.generateUUID(),h[r]=t,r;}void 0===t&&(t=new THREE.Color()),void 0===e&&(e=new THREE.TextureLoader()),void 0===r&&(r=new THREE.MaterialLoader());var s,h={},c={uuid:THREE.Math.generateUUID(),type:"MeshLambertMaterial"};for(s in i){var l=i[s];switch(s){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":c.name=l;break;case"blending":c.blending=THREE[l];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",s,"is no longer supported.");break;case"colorDiffuse":c.color=t.fromArray(l).getHex();break;case"colorSpecular":c.specular=t.fromArray(l).getHex();break;case"colorEmissive":c.emissive=t.fromArray(l).getHex();break;case"specularCoef":c.shininess=l;break;case"shading":"basic"===l.toLowerCase()&&(c.type="MeshBasicMaterial"),"phong"===l.toLowerCase()&&(c.type="MeshPhongMaterial");break;case"mapDiffuse":c.map=a(l,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapLight":c.lightMap=a(l,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":c.aoMap=a(l,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":c.bumpMap=a(l,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":c.bumpScale=l;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":c.normalMap=a(l,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":c.normalScale=[l,l];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":c.specularMap=a(l,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapAlpha":c.alphaMap=a(l,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":c.side=THREE.BackSide;break;case"doubleSided":c.side=THREE.DoubleSide;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),c.opacity=l;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":c[s]=l;break;case"vertexColors":!0===l&&(c.vertexColors=THREE.VertexColors),"face"===l&&(c.vertexColors=THREE.FaceColors);break;default:console.error("THREE.Loader.createMaterial: Unsupported",s,l);}}return"MeshBasicMaterial"===c.type&&delete c.emissive,"MeshPhongMaterial"!==c.type&&delete c.specular,1>c.opacity&&(c.transparent=!0),r.setTextures(h),r.parse(c);};}()},THREE.Loader.Handlers={handlers:[],add:function add(t,e){this.handlers.push(t,e);},get:function get(t){for(var e=this.handlers,r=0,i=e.length;r<i;r+=2){var n=e[r+1];if(e[r].test(t))return n;}return null;}},THREE.XHRLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager;},THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function load(t,e,r,i){void 0!==this.path&&(t=this.path+t);var n=this,o=THREE.Cache.get(t);if(void 0!==o)return e&&setTimeout(function(){e(o);},0),o;var a=new XMLHttpRequest();return a.overrideMimeType("text/plain"),a.open("GET",t,!0),a.addEventListener("load",function(r){var o=r.target.response;THREE.Cache.add(t,o),200===this.status?(e&&e(o),n.manager.itemEnd(t)):0===this.status?(console.warn("THREE.XHRLoader: HTTP Status 0 received."),e&&e(o),n.manager.itemEnd(t)):(i&&i(r),n.manager.itemError(t));},!1),void 0!==r&&a.addEventListener("progress",function(t){r(t);},!1),a.addEventListener("error",function(e){i&&i(e),n.manager.itemError(t);},!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.send(null),n.manager.itemStart(t),a;},setPath:function setPath(t){this.path=t;},setResponseType:function setResponseType(t){this.responseType=t;},setWithCredentials:function setWithCredentials(t){this.withCredentials=t;}},THREE.FontLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager;},THREE.FontLoader.prototype={constructor:THREE.FontLoader,load:function load(t,e,r,i){new THREE.XHRLoader(this.manager).load(t,function(t){e(new THREE.Font(JSON.parse(t.substring(65,t.length-2))));},r,i);}},THREE.ImageLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager;},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function load(t,e,r,i){void 0!==this.path&&(t=this.path+t);var n=this,o=THREE.Cache.get(t);if(void 0!==o)return n.manager.itemStart(t),e?setTimeout(function(){e(o),n.manager.itemEnd(t);},0):n.manager.itemEnd(t),o;var a=document.createElement("img");return a.addEventListener("load",function(r){THREE.Cache.add(t,this),e&&e(this),n.manager.itemEnd(t);},!1),void 0!==r&&a.addEventListener("progress",function(t){r(t);},!1),a.addEventListener("error",function(e){i&&i(e),n.manager.itemError(t);},!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),n.manager.itemStart(t),a.src=t,a;},setCrossOrigin:function setCrossOrigin(t){this.crossOrigin=t;},setPath:function setPath(t){this.path=t;}},THREE.JSONLoader=function(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:THREE.DefaultLoadingManager,this.withCredentials=!1;},THREE.JSONLoader.prototype={constructor:THREE.JSONLoader,get statusDomElement(){return void 0===this._statusDomElement&&(this._statusDomElement=document.createElement("div")),console.warn("THREE.JSONLoader: .statusDomElement has been removed."),this._statusDomElement;},load:function load(t,e,r,i){var n=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:THREE.Loader.prototype.extractUrlBase(t),a=new THREE.XHRLoader(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,function(r){var i=(r=JSON.parse(r)).metadata;if(void 0!==i&&void 0!==(i=i.type)){if("object"===i.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===i.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.");}r=n.parse(r,o),e(r.geometry,r.materials);},r,i);},setTexturePath:function setTexturePath(t){this.texturePath=t;},parse:function parse(t,e){var r=new THREE.Geometry(),i=void 0!==t.scale?1/t.scale:1;return function(e){var i,n,o,a,s,h,c,l,u,d,p,E,f,m=t.faces;h=t.vertices;var g=t.normals,T=t.colors,v=0;if(void 0!==t.uvs){for(i=0;i<t.uvs.length;i++){t.uvs[i].length&&v++;}for(i=0;i<v;i++){r.faceVertexUvs[i]=[];}}for(a=0,s=h.length;a<s;){(i=new THREE.Vector3()).x=h[a++]*e,i.y=h[a++]*e,i.z=h[a++]*e,r.vertices.push(i);}for(a=0,s=m.length;a<s;){if(u=1&(e=m[a++]),o=2&e,i=8&e,c=16&e,d=32&e,h=64&e,e&=128,u){if((u=new THREE.Face3()).a=m[a],u.b=m[a+1],u.c=m[a+3],(p=new THREE.Face3()).a=m[a+1],p.b=m[a+2],p.c=m[a+3],a+=4,o&&(o=m[a++],u.materialIndex=o,p.materialIndex=o),o=r.faces.length,i)for(i=0;i<v;i++){for(E=t.uvs[i],r.faceVertexUvs[i][o]=[],r.faceVertexUvs[i][o+1]=[],n=0;4>n;n++){f=E[2*(l=m[a++])],l=E[2*l+1],f=new THREE.Vector2(f,l),2!==n&&r.faceVertexUvs[i][o].push(f),0!==n&&r.faceVertexUvs[i][o+1].push(f);}}if(c&&(c=3*m[a++],u.normal.set(g[c++],g[c++],g[c]),p.normal.copy(u.normal)),d)for(i=0;4>i;i++){c=3*m[a++],d=new THREE.Vector3(g[c++],g[c++],g[c]),2!==i&&u.vertexNormals.push(d),0!==i&&p.vertexNormals.push(d);}if(h&&(h=T[h=m[a++]],u.color.setHex(h),p.color.setHex(h)),e)for(i=0;4>i;i++){h=T[h=m[a++]],2!==i&&u.vertexColors.push(new THREE.Color(h)),0!==i&&p.vertexColors.push(new THREE.Color(h));}r.faces.push(u),r.faces.push(p);}else{if((u=new THREE.Face3()).a=m[a++],u.b=m[a++],u.c=m[a++],o&&(o=m[a++],u.materialIndex=o),o=r.faces.length,i)for(i=0;i<v;i++){for(E=t.uvs[i],r.faceVertexUvs[i][o]=[],n=0;3>n;n++){f=E[2*(l=m[a++])],l=E[2*l+1],f=new THREE.Vector2(f,l),r.faceVertexUvs[i][o].push(f);}}if(c&&(c=3*m[a++],u.normal.set(g[c++],g[c++],g[c])),d)for(i=0;3>i;i++){c=3*m[a++],d=new THREE.Vector3(g[c++],g[c++],g[c]),u.vertexNormals.push(d);}if(h&&(h=m[a++],u.color.setHex(T[h])),e)for(i=0;3>i;i++){h=m[a++],u.vertexColors.push(new THREE.Color(T[h]));}r.faces.push(u);}}}(i),function(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var i=0,n=t.skinWeights.length;i<n;i+=e){r.skinWeights.push(new THREE.Vector4(t.skinWeights[i],1<e?t.skinWeights[i+1]:0,2<e?t.skinWeights[i+2]:0,3<e?t.skinWeights[i+3]:0));}if(t.skinIndices)for(i=0,n=t.skinIndices.length;i<n;i+=e){r.skinIndices.push(new THREE.Vector4(t.skinIndices[i],1<e?t.skinIndices[i+1]:0,2<e?t.skinIndices[i+2]:0,3<e?t.skinIndices[i+3]:0));}r.bones=t.bones,r.bones&&0<r.bones.length&&(r.skinWeights.length!==r.skinIndices.length||r.skinIndices.length!==r.vertices.length)&&console.warn("When skinning, number of vertices ("+r.vertices.length+"), skinIndices ("+r.skinIndices.length+"), and skinWeights ("+r.skinWeights.length+") should match.");}(),function(e){if(void 0!==t.morphTargets)for(var i=0,n=t.morphTargets.length;i<n;i++){r.morphTargets[i]={},r.morphTargets[i].name=t.morphTargets[i].name,r.morphTargets[i].vertices=[];for(var o=r.morphTargets[i].vertices,a=t.morphTargets[i].vertices,s=0,h=a.length;s<h;s+=3){var c=new THREE.Vector3();c.x=a[s]*e,c.y=a[s+1]*e,c.z=a[s+2]*e,o.push(c);}}if(void 0!==t.morphColors&&0<t.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),e=r.faces,o=t.morphColors[0].colors,i=0,n=e.length;i<n;i++){e[i].color.fromArray(o,3*i);}}(i),function(){var e=[],i=[];void 0!==t.animation&&i.push(t.animation),void 0!==t.animations&&(t.animations.length?i=i.concat(t.animations):i.push(t.animations));for(var n=0;n<i.length;n++){var o=THREE.AnimationClip.parseAnimation(i[n],r.bones);o&&e.push(o);}r.morphTargets&&(i=THREE.AnimationClip.CreateClipsFromMorphTargetSequences(r.morphTargets,10),e=e.concat(i)),0<e.length&&(r.animations=e);}(),r.computeFaceNormals(),r.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:r}:(i=THREE.Loader.prototype.initMaterials(t.materials,e,this.crossOrigin),{geometry:r,materials:i});}},THREE.LoadingManager=function(t,e,r){var i=this,n=!1,o=0,a=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=r,this.itemStart=function(t){a++,!1===n&&void 0!==i.onStart&&i.onStart(t,o,a),n=!0;},this.itemEnd=function(t){o++,void 0!==i.onProgress&&i.onProgress(t,o,a),o===a&&(n=!1,void 0!==i.onLoad)&&i.onLoad();},this.itemError=function(t){void 0!==i.onError&&i.onError(t);};},THREE.DefaultLoadingManager=new THREE.LoadingManager(),THREE.BufferGeometryLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager;},THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function load(t,e,r,i){var n=this;new THREE.XHRLoader(n.manager).load(t,function(t){e(n.parse(JSON.parse(t)));},r,i);},parse:function parse(t){var e=new THREE.BufferGeometry(),r=t.data.index,i={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};void 0!==r&&(r=new i[r.type](r.array),e.setIndex(new THREE.BufferAttribute(r,1)));var n,o=t.data.attributes;for(n in o){var a=o[n];r=new i[a.type](a.array);e.addAttribute(n,new THREE.BufferAttribute(r,a.itemSize));}if(void 0!==(i=t.data.groups||t.data.drawcalls||t.data.offsets))for(n=0,r=i.length;n!==r;++n){o=i[n],e.addGroup(o.start,o.count,o.materialIndex);}return void 0!==(t=t.data.boundingSphere)&&(i=new THREE.Vector3(),void 0!==t.center&&i.fromArray(t.center),e.boundingSphere=new THREE.Sphere(i,t.radius)),e;}},THREE.MaterialLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager,this.textures={};},THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function load(t,e,r,i){var n=this;new THREE.XHRLoader(n.manager).load(t,function(t){e(n.parse(JSON.parse(t)));},r,i);},setTextures:function setTextures(t){this.textures=t;},getTexture:function getTexture(t){var e=this.textures;return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t];},parse:function parse(t){var e=new THREE[t.type]();if(void 0!==t.uuid&&(e.uuid=t.uuid),void 0!==t.name&&(e.name=t.name),void 0!==t.color&&e.color.setHex(t.color),void 0!==t.roughness&&(e.roughness=t.roughness),void 0!==t.metalness&&(e.metalness=t.metalness),void 0!==t.emissive&&e.emissive.setHex(t.emissive),void 0!==t.specular&&e.specular.setHex(t.specular),void 0!==t.shininess&&(e.shininess=t.shininess),void 0!==t.uniforms&&(e.uniforms=t.uniforms),void 0!==t.vertexShader&&(e.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(e.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(e.vertexColors=t.vertexColors),void 0!==t.shading&&(e.shading=t.shading),void 0!==t.blending&&(e.blending=t.blending),void 0!==t.side&&(e.side=t.side),void 0!==t.opacity&&(e.opacity=t.opacity),void 0!==t.transparent&&(e.transparent=t.transparent),void 0!==t.alphaTest&&(e.alphaTest=t.alphaTest),void 0!==t.depthTest&&(e.depthTest=t.depthTest),void 0!==t.depthWrite&&(e.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(e.colorWrite=t.colorWrite),void 0!==t.wireframe&&(e.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(e.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.size&&(e.size=t.size),void 0!==t.sizeAttenuation&&(e.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(e.map=this.getTexture(t.map)),void 0!==t.alphaMap&&(e.alphaMap=this.getTexture(t.alphaMap),e.transparent=!0),void 0!==t.bumpMap&&(e.bumpMap=this.getTexture(t.bumpMap)),void 0!==t.bumpScale&&(e.bumpScale=t.bumpScale),void 0!==t.normalMap&&(e.normalMap=this.getTexture(t.normalMap)),void 0!==t.normalScale){var r=t.normalScale;!1===Array.isArray(r)&&(r=[r,r]),e.normalScale=new THREE.Vector2().fromArray(r);}if(void 0!==t.displacementMap&&(e.displacementMap=this.getTexture(t.displacementMap)),void 0!==t.displacementScale&&(e.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(e.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(e.roughnessMap=this.getTexture(t.roughnessMap)),void 0!==t.metalnessMap&&(e.metalnessMap=this.getTexture(t.metalnessMap)),void 0!==t.emissiveMap&&(e.emissiveMap=this.getTexture(t.emissiveMap)),void 0!==t.emissiveIntensity&&(e.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(e.specularMap=this.getTexture(t.specularMap)),void 0!==t.envMap&&(e.envMap=this.getTexture(t.envMap),e.combine=THREE.MultiplyOperation),t.reflectivity&&(e.reflectivity=t.reflectivity),void 0!==t.lightMap&&(e.lightMap=this.getTexture(t.lightMap)),void 0!==t.lightMapIntensity&&(e.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(e.aoMap=this.getTexture(t.aoMap)),void 0!==t.aoMapIntensity&&(e.aoMapIntensity=t.aoMapIntensity),void 0!==t.materials){r=0;for(var i=t.materials.length;r<i;r++){e.materials.push(this.parse(t.materials[r]));}}return e;}},THREE.ObjectLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager,this.texturePath="";},THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function load(t,e,r,i){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var n=this;new THREE.XHRLoader(n.manager).load(t,function(t){n.parse(JSON.parse(t),e);},r,i);},setTexturePath:function setTexturePath(t){this.texturePath=t;},setCrossOrigin:function setCrossOrigin(t){this.crossOrigin=t;},parse:function parse(t,e){var r=this.parseGeometries(t.geometries),i=this.parseImages(t.images,function(){void 0!==e&&e(n);}),n=(i=this.parseTextures(t.textures,i),i=this.parseMaterials(t.materials,i),this.parseObject(t.object,r,i));return t.animations&&(n.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===e||e(n),n;},parseGeometries:function parseGeometries(t){var e={};if(void 0!==t)for(var r=new THREE.JSONLoader(),i=new THREE.BufferGeometryLoader(),n=0,o=t.length;n<o;n++){var a,s=t[n];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new THREE[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"CubeGeometry":a=new THREE.BoxGeometry(s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleBufferGeometry":a=new THREE.CircleBufferGeometry(s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CircleGeometry":a=new THREE.CircleGeometry(s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":a=new THREE.CylinderGeometry(s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":a=new THREE.SphereGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"SphereBufferGeometry":a=new THREE.SphereBufferGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":a=new THREE.DodecahedronGeometry(s.radius,s.detail);break;case"IcosahedronGeometry":a=new THREE.IcosahedronGeometry(s.radius,s.detail);break;case"OctahedronGeometry":a=new THREE.OctahedronGeometry(s.radius,s.detail);break;case"TetrahedronGeometry":a=new THREE.TetrahedronGeometry(s.radius,s.detail);break;case"RingGeometry":a=new THREE.RingGeometry(s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":a=new THREE.TorusGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":a=new THREE.TorusKnotGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.p,s.q,s.heightScale);break;case"LatheGeometry":a=new THREE.LatheGeometry(s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":a=i.parse(s);break;case"Geometry":a=r.parse(s.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue;}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),e[s.uuid]=a;}return e;},parseMaterials:function parseMaterials(t,e){var r={};if(void 0!==t){var i=new THREE.MaterialLoader();i.setTextures(e);for(var n=0,o=t.length;n<o;n++){var a=i.parse(t[n]);r[a.uuid]=a;}}return r;},parseAnimations:function parseAnimations(t){for(var e=[],r=0;r<t.length;r++){var i=THREE.AnimationClip.parse(t[r]);e.push(i);}return e;},parseImages:function parseImages(t,e){function r(t){return i.manager.itemStart(t),a.load(t,function(){i.manager.itemEnd(t);});}var i=this,n={};if(void 0!==t&&0<t.length){var o=new THREE.LoadingManager(e),a=new THREE.ImageLoader(o);a.setCrossOrigin(this.crossOrigin);o=0;for(var s=t.length;o<s;o++){var h=t[o],c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h.url)?h.url:i.texturePath+h.url;n[h.uuid]=r(c);}}return n;},parseTextures:function parseTextures(t,e){function r(t){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),THREE[t]);}var i={};if(void 0!==t)for(var n=0,o=t.length;n<o;n++){var a=t[n];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new THREE.Texture(e[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=r(a.mapping)),void 0!==a.offset&&(s.offset=new THREE.Vector2(a.offset[0],a.offset[1])),void 0!==a.repeat&&(s.repeat=new THREE.Vector2(a.repeat[0],a.repeat[1])),void 0!==a.minFilter&&(s.minFilter=r(a.minFilter)),void 0!==a.magFilter&&(s.magFilter=r(a.magFilter)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),Array.isArray(a.wrap)&&(s.wrapS=r(a.wrap[0]),s.wrapT=r(a.wrap[1])),i[a.uuid]=s;}return i;},parseObject:function(){var t=new THREE.Matrix4();return function(e,r,i){function n(t){return void 0===r[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),r[t];}function o(t){if(void 0!==t)return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),i[t];}var a;switch(e.type){case"Scene":a=new THREE.Scene();break;case"PerspectiveCamera":a=new THREE.PerspectiveCamera(e.fov,e.aspect,e.near,e.far);break;case"OrthographicCamera":a=new THREE.OrthographicCamera(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":a=new THREE.AmbientLight(e.color,e.intensity);break;case"DirectionalLight":a=new THREE.DirectionalLight(e.color,e.intensity);break;case"PointLight":a=new THREE.PointLight(e.color,e.intensity,e.distance,e.decay);break;case"SpotLight":a=new THREE.SpotLight(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new THREE.HemisphereLight(e.color,e.groundColor,e.intensity);break;case"Mesh":a=n(e.geometry);var s=o(e.material);a=a.bones&&0<a.bones.length?new THREE.SkinnedMesh(a,s):new THREE.Mesh(a,s);break;case"LOD":a=new THREE.LOD();break;case"Line":a=new THREE.Line(n(e.geometry),o(e.material),e.mode);break;case"PointCloud":case"Points":a=new THREE.Points(n(e.geometry),o(e.material));break;case"Sprite":a=new THREE.Sprite(o(e.material));break;case"Group":a=new THREE.Group();break;default:a=new THREE.Object3D();}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.children)for(var h in e.children){a.add(this.parseObject(e.children[h],r,i));}if("LOD"===e.type)for(e=e.levels,s=0;s<e.length;s++){var c=e[s];void 0!==(h=a.getObjectByProperty("uuid",c.object))&&a.addLevel(h,c.distance);}return a;};}()},THREE.TextureLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager;},THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function load(t,e,r,i){var n=new THREE.Texture(),o=new THREE.ImageLoader(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(t){n.image=t,n.needsUpdate=!0,void 0!==e&&e(n);},r,i),n;},setCrossOrigin:function setCrossOrigin(t){this.crossOrigin=t;},setPath:function setPath(t){this.path=t;}},THREE.CubeTextureLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager;},THREE.CubeTextureLoader.prototype={constructor:THREE.CubeTextureLoader,load:function load(t,e,r,i){function n(r){a.load(t[r],function(t){o.images[r]=t,6===++s&&(o.needsUpdate=!0,e&&e(o));},void 0,i);}var o=new THREE.CubeTexture([]),a=new THREE.ImageLoader(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var s=0;for(r=0;r<t.length;++r){n(r);}return o;},setCrossOrigin:function setCrossOrigin(t){this.crossOrigin=t;},setPath:function setPath(t){this.path=t;}},THREE.DataTextureLoader=THREE.BinaryTextureLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager,this._parser=null;},THREE.BinaryTextureLoader.prototype={constructor:THREE.BinaryTextureLoader,load:function load(t,e,r,i){var n=this,o=new THREE.DataTexture(),a=new THREE.XHRLoader(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){(t=n._parser(t))&&(void 0!==t.image?o.image=t.image:void 0!==t.data&&(o.image.width=t.width,o.image.height=t.height,o.image.data=t.data),o.wrapS=void 0!==t.wrapS?t.wrapS:THREE.ClampToEdgeWrapping,o.wrapT=void 0!==t.wrapT?t.wrapT:THREE.ClampToEdgeWrapping,o.magFilter=void 0!==t.magFilter?t.magFilter:THREE.LinearFilter,o.minFilter=void 0!==t.minFilter?t.minFilter:THREE.LinearMipMapLinearFilter,o.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(o.format=t.format),void 0!==t.type&&(o.type=t.type),void 0!==t.mipmaps&&(o.mipmaps=t.mipmaps),1===t.mipmapCount&&(o.minFilter=THREE.LinearFilter),o.needsUpdate=!0,e&&e(o,t));},r,i),o;}},THREE.CompressedTextureLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager,this._parser=null;},THREE.CompressedTextureLoader.prototype={constructor:THREE.CompressedTextureLoader,load:function load(t,e,r,i){function n(n){h.load(t[n],function(t){t=o._parser(t,!0),a[n]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(c+=1)&&(1===t.mipmapCount&&(s.minFilter=THREE.LinearFilter),s.format=t.format,s.needsUpdate=!0,e&&e(s));},r,i);}var o=this,a=[],s=new THREE.CompressedTexture();s.image=a;var h=new THREE.XHRLoader(this.manager);if(h.setPath(this.path),h.setResponseType("arraybuffer"),Array.isArray(t))for(var c=0,l=0,u=t.length;l<u;++l){n(l);}else h.load(t,function(t){if((t=o._parser(t,!0)).isCubemap)for(var r=t.mipmaps.length/t.mipmapCount,i=0;i<r;i++){a[i]={mipmaps:[]};for(var n=0;n<t.mipmapCount;n++){a[i].mipmaps.push(t.mipmaps[i*t.mipmapCount+n]),a[i].format=t.format,a[i].width=t.width,a[i].height=t.height;}}else s.image.width=t.width,s.image.height=t.height,s.mipmaps=t.mipmaps;1===t.mipmapCount&&(s.minFilter=THREE.LinearFilter),s.format=t.format,s.needsUpdate=!0,e&&e(s);},r,i);return s;},setPath:function setPath(t){this.path=t;}},THREE.Material=function(){Object.defineProperty(this,"id",{value:THREE.MaterialIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Material",this.side=THREE.FrontSide,this.opacity=1,this.transparent=!1,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=THREE.LessEqualDepth,this.colorWrite=this.depthWrite=this.depthTest=!0,this.precision=null,this.polygonOffset=!1,this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0,this._needsUpdate=this.visible=!0;},THREE.Material.prototype={constructor:THREE.Material,get needsUpdate(){return this._needsUpdate;},set needsUpdate(t){!0===t&&this.update(),this._needsUpdate=t;},setValues:function setValues(t){if(void 0!==t)for(var e in t){var r=t[e];if(void 0===r)console.warn("THREE.Material: '"+e+"' parameter is undefined.");else{var i=this[e];void 0===i?console.warn("THREE."+this.type+": '"+e+"' is not a property of this material."):i instanceof THREE.Color?i.set(r):i instanceof THREE.Vector3&&r instanceof THREE.Vector3?i.copy(r):this[e]="overdraw"===e?Number(r):r;}}},toJSON:function toJSON(t){function e(t){var e,r=[];for(e in t){var i=t[e];delete i.metadata,r.push(i);}return r;}var r=void 0===t;r&&(t={textures:{},images:{}});var i={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};return i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color instanceof THREE.Color&&(i.color=this.color.getHex()),.5!==this.roughness&&(i.roughness=this.roughness),.5!==this.metalness&&(i.metalness=this.metalness),this.emissive instanceof THREE.Color&&(i.emissive=this.emissive.getHex()),this.specular instanceof THREE.Color&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),this.map instanceof THREE.Texture&&(i.map=this.map.toJSON(t).uuid),this.alphaMap instanceof THREE.Texture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap instanceof THREE.Texture&&(i.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap instanceof THREE.Texture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap instanceof THREE.Texture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalScale=this.normalScale.toArray()),this.displacementMap instanceof THREE.Texture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap instanceof THREE.Texture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap instanceof THREE.Texture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap instanceof THREE.Texture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap instanceof THREE.Texture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.envMap instanceof THREE.Texture&&(i.envMap=this.envMap.toJSON(t).uuid,i.reflectivity=this.reflectivity),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),void 0!==this.vertexColors&&this.vertexColors!==THREE.NoColors&&(i.vertexColors=this.vertexColors),void 0!==this.shading&&this.shading!==THREE.SmoothShading&&(i.shading=this.shading),void 0!==this.blending&&this.blending!==THREE.NormalBlending&&(i.blending=this.blending),void 0!==this.side&&this.side!==THREE.FrontSide&&(i.side=this.side),1>this.opacity&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),0<this.alphaTest&&(i.alphaTest=this.alphaTest),!0===this.wireframe&&(i.wireframe=this.wireframe),1<this.wireframeLinewidth&&(i.wireframeLinewidth=this.wireframeLinewidth),r&&(r=e(t.textures),t=e(t.images),0<r.length&&(i.textures=r),0<t.length&&(i.images=t)),i;},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(t){return this.name=t.name,this.side=t.side,this.opacity=t.opacity,this.transparent=t.transparent,this.blending=t.blending,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.overdraw=t.overdraw,this.visible=t.visible,this;},update:function update(){this.dispatchEvent({type:"update"});},dispose:function dispose(){this.dispatchEvent({type:"dispose"});}},THREE.EventDispatcher.prototype.apply(THREE.Material.prototype),THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(t){THREE.Material.call(this),this.type="LineBasicMaterial",this.color=new THREE.Color(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(t);},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial,THREE.LineBasicMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.vertexColors=t.vertexColors,this.fog=t.fog,this;},THREE.LineDashedMaterial=function(t){THREE.Material.call(this),this.type="LineDashedMaterial",this.color=new THREE.Color(16777215),this.scale=this.linewidth=1,this.dashSize=3,this.gapSize=1,this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(t);},THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.constructor=THREE.LineDashedMaterial,THREE.LineDashedMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this.vertexColors=t.vertexColors,this.fog=t.fog,this;},THREE.MeshBasicMaterial=function(t){THREE.Material.call(this),this.type="MeshBasicMaterial",this.color=new THREE.Color(16777215),this.aoMap=this.map=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphTargets=this.skinning=!1,this.setValues(t);},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial,THREE.MeshBasicMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this;},THREE.MeshLambertMaterial=function(t){THREE.Material.call(this),this.type="MeshLambertMaterial",this.color=new THREE.Color(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new THREE.Color(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t);},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial,THREE.MeshLambertMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this;},THREE.MeshPhongMaterial=function(t){THREE.Material.call(this),this.type="MeshPhongMaterial",this.color=new THREE.Color(16777215),this.specular=new THREE.Color(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new THREE.Color(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t);},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial,THREE.MeshPhongMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this;},THREE.MeshStandardMaterial=function(t){THREE.Material.call(this),this.type="MeshStandardMaterial",this.color=new THREE.Color(16777215),this.metalness=this.roughness=.5,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new THREE.Color(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t);},THREE.MeshStandardMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshStandardMaterial.prototype.constructor=THREE.MeshStandardMaterial,THREE.MeshStandardMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this;},THREE.MeshDepthMaterial=function(t){THREE.Material.call(this),this.type="MeshDepthMaterial",this.wireframe=this.morphTargets=!1,this.wireframeLinewidth=1,this.setValues(t);},THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial,THREE.MeshDepthMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this;},THREE.MeshNormalMaterial=function(t){THREE.Material.call(this,t),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(t);},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial,THREE.MeshNormalMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this;},THREE.MultiMaterial=function(t){this.uuid=THREE.Math.generateUUID(),this.type="MultiMaterial",this.materials=t instanceof Array?t:[],this.visible=!0;},THREE.MultiMaterial.prototype={constructor:THREE.MultiMaterial,toJSON:function toJSON(t){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},r=this.materials,i=0,n=r.length;i<n;i++){var o=r[i].toJSON(t);delete o.metadata,e.materials.push(o);}return e.visible=this.visible,e;},clone:function clone(){for(var t=new this.constructor(),e=0;e<this.materials.length;e++){t.materials.push(this.materials[e].clone());}return t.visible=this.visible,t;}},THREE.PointsMaterial=function(t){THREE.Material.call(this),this.type="PointsMaterial",this.color=new THREE.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(t);},THREE.PointsMaterial.prototype=Object.create(THREE.Material.prototype),THREE.PointsMaterial.prototype.constructor=THREE.PointsMaterial,THREE.PointsMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.vertexColors=t.vertexColors,this.fog=t.fog,this;},THREE.ShaderMaterial=function(t){THREE.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=THREE.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t));},THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.constructor=THREE.ShaderMaterial,THREE.ShaderMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=THREE.UniformsUtils.clone(t.uniforms),this.defines=t.defines,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this;},THREE.ShaderMaterial.prototype.toJSON=function(t){return(t=THREE.Material.prototype.toJSON.call(this,t)).uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t;},THREE.RawShaderMaterial=function(t){THREE.ShaderMaterial.call(this,t),this.type="RawShaderMaterial";},THREE.RawShaderMaterial.prototype=Object.create(THREE.ShaderMaterial.prototype),THREE.RawShaderMaterial.prototype.constructor=THREE.RawShaderMaterial,THREE.SpriteMaterial=function(t){THREE.Material.call(this),this.type="SpriteMaterial",this.color=new THREE.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(t);},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.constructor=THREE.SpriteMaterial,THREE.SpriteMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this.fog=t.fog,this;},THREE.Texture=function(t,e,r,i,n,o,a,s,h){Object.defineProperty(this,"id",{value:THREE.TextureIdCount++}),this.uuid=THREE.Math.generateUUID(),this.sourceFile=this.name="",this.image=void 0!==t?t:THREE.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:THREE.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==i?i:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==n?n:THREE.LinearFilter,this.minFilter=void 0!==o?o:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==h?h:1,this.format=void 0!==a?a:THREE.RGBAFormat,this.type=void 0!==s?s:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.version=0,this.onUpdate=null;},THREE.Texture.DEFAULT_IMAGE=void 0,THREE.Texture.DEFAULT_MAPPING=THREE.UVMapping,THREE.Texture.prototype={constructor:THREE.Texture,set needsUpdate(t){!0===t&&this.version++;},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this;},toJSON:function toJSON(t){if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var e={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=THREE.Math.generateUUID()),void 0===t.images[r.uuid]){var i,n=t.images,o=r.uuid,a=r.uuid;void 0!==r.toDataURL?i=r:((i=document.createElement("canvas")).width=r.width,i.height=r.height,i.getContext("2d").drawImage(r,0,0,r.width,r.height)),i=2048<i.width||2048<i.height?i.toDataURL("image/jpeg",.6):i.toDataURL("image/png"),n[o]={uuid:a,url:i};}e.image=r.uuid;}return t.textures[this.uuid]=e;},dispose:function dispose(){this.dispatchEvent({type:"dispose"});},transformUv:function transformUv(t){if(this.mapping===THREE.UVMapping){if(t.multiply(this.repeat),t.add(this.offset),0>t.x||1<t.x)switch(this.wrapS){case THREE.RepeatWrapping:t.x-=Math.floor(t.x);break;case THREE.ClampToEdgeWrapping:t.x=0>t.x?0:1;break;case THREE.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x-=Math.floor(t.x);}if(0>t.y||1<t.y)switch(this.wrapT){case THREE.RepeatWrapping:t.y-=Math.floor(t.y);break;case THREE.ClampToEdgeWrapping:t.y=0>t.y?0:1;break;case THREE.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y-=Math.floor(t.y);}this.flipY&&(t.y=1-t.y);}}},THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype),THREE.TextureIdCount=0,THREE.CanvasTexture=function(t,e,r,i,n,o,a,s,h){THREE.Texture.call(this,t,e,r,i,n,o,a,s,h),this.needsUpdate=!0;},THREE.CanvasTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CanvasTexture.prototype.constructor=THREE.CanvasTexture,THREE.CubeTexture=function(t,e,r,i,n,o,a,s,h){e=void 0!==e?e:THREE.CubeReflectionMapping,THREE.Texture.call(this,t,e,r,i,n,o,a,s,h),this.images=t,this.flipY=!1;},THREE.CubeTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CubeTexture.prototype.constructor=THREE.CubeTexture,THREE.CubeTexture.prototype.copy=function(t){return THREE.Texture.prototype.copy.call(this,t),this.images=t.images,this;},THREE.CompressedTexture=function(t,e,r,i,n,o,a,s,h,c,l){THREE.Texture.call(this,null,o,a,s,h,c,i,n,l),this.image={width:e,height:r},this.mipmaps=t,this.generateMipmaps=this.flipY=!1;},THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.constructor=THREE.CompressedTexture,THREE.DataTexture=function(t,e,r,i,n,o,a,s,h,c,l){THREE.Texture.call(this,null,o,a,s,h,c,i,n,l),this.image={data:t,width:e,height:r},this.magFilter=void 0!==h?h:THREE.NearestFilter,this.minFilter=void 0!==c?c:THREE.NearestFilter,this.generateMipmaps=this.flipY=!1;},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.constructor=THREE.DataTexture,THREE.VideoTexture=function(t,e,r,i,n,o,a,s,h){THREE.Texture.call(this,t,e,r,i,n,o,a,s,h),this.generateMipmaps=!1;var c=this;!function e(){requestAnimationFrame(e),t.readyState===t.HAVE_ENOUGH_DATA&&(c.needsUpdate=!0);}();},THREE.VideoTexture.prototype=Object.create(THREE.Texture.prototype),THREE.VideoTexture.prototype.constructor=THREE.VideoTexture,THREE.Group=function(){THREE.Object3D.call(this),this.type="Group";},THREE.Group.prototype=Object.create(THREE.Object3D.prototype),THREE.Group.prototype.constructor=THREE.Group,THREE.Points=function(t,e){THREE.Object3D.call(this),this.type="Points",this.geometry=void 0!==t?t:new THREE.Geometry(),this.material=void 0!==e?e:new THREE.PointsMaterial({color:16777215*Math.random()});},THREE.Points.prototype=Object.create(THREE.Object3D.prototype),THREE.Points.prototype.constructor=THREE.Points,THREE.Points.prototype.raycast=function(){var t=new THREE.Matrix4(),e=new THREE.Ray(),r=new THREE.Sphere();return function(i,n){function o(t,r){var o=e.distanceSqToPoint(t);if(o<l){var s=e.closestPointToPoint(t);s.applyMatrix4(h);var c=i.ray.origin.distanceTo(s);c<i.near||c>i.far||n.push({distance:c,distanceToRay:Math.sqrt(o),point:s.clone(),index:r,face:null,object:a});}}var a=this,s=this.geometry,h=this.matrixWorld,c=i.params.Points.threshold;if(null===s.boundingSphere&&s.computeBoundingSphere(),r.copy(s.boundingSphere),r.applyMatrix4(h),!1!==i.ray.intersectsSphere(r)){t.getInverse(h),e.copy(i.ray).applyMatrix4(t);var l=(c=c/((this.scale.x+this.scale.y+this.scale.z)/3))*c;c=new THREE.Vector3();if(s instanceof THREE.BufferGeometry){var u=s.index;s=s.attributes.position.array;if(null!==u)for(var d=u.array,p=(u=0,d.length);u<p;u++){var E=d[u];c.fromArray(s,3*E),o(c,E);}else for(u=0,d=s.length/3;u<d;u++){c.fromArray(s,3*u),o(c,u);}}else for(u=0,d=(c=s.vertices).length;u<d;u++){o(c[u],u);}}};}(),THREE.Points.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this);},THREE.Line=function(t,e,r){if(1===r)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new THREE.LineSegments(t,e);THREE.Object3D.call(this),this.type="Line",this.geometry=void 0!==t?t:new THREE.Geometry(),this.material=void 0!==e?e:new THREE.LineBasicMaterial({color:16777215*Math.random()});},THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.constructor=THREE.Line,THREE.Line.prototype.raycast=function(){var t=new THREE.Matrix4(),e=new THREE.Ray(),r=new THREE.Sphere();return function(i,n){var o=(o=i.linePrecision)*o,a=this.geometry,s=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),r.copy(a.boundingSphere),r.applyMatrix4(s),!1!==i.ray.intersectsSphere(r)){t.getInverse(s),e.copy(i.ray).applyMatrix4(t);var h=new THREE.Vector3(),c=new THREE.Vector3(),l=(s=new THREE.Vector3(),new THREE.Vector3()),u=this instanceof THREE.LineSegments?2:1;if(a instanceof THREE.BufferGeometry){var d=a.index,p=a.attributes.position.array;if(null!==d){a=0;for(var E=(d=d.array).length-1;a<E;a+=u){var f=d[a+1];h.fromArray(p,3*d[a]),c.fromArray(p,3*f),(f=e.distanceSqToSegment(h,c,l,s))>o||(l.applyMatrix4(this.matrixWorld),(f=i.ray.origin.distanceTo(l))<i.near||f>i.far||n.push({distance:f,point:s.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}));}}else for(a=0,E=p.length/3-1;a<E;a+=u){h.fromArray(p,3*a),c.fromArray(p,3*a+3),(f=e.distanceSqToSegment(h,c,l,s))>o||(l.applyMatrix4(this.matrixWorld),(f=i.ray.origin.distanceTo(l))<i.near||f>i.far||n.push({distance:f,point:s.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}));}}else if(a instanceof THREE.Geometry)for(c=(h=a.vertices).length,a=0;a<c-1;a+=u){(f=e.distanceSqToSegment(h[a],h[a+1],l,s))>o||(l.applyMatrix4(this.matrixWorld),(f=i.ray.origin.distanceTo(l))<i.near||f>i.far||n.push({distance:f,point:s.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}));}}};}(),THREE.Line.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this);},THREE.LineStrip=0,THREE.LinePieces=1,THREE.LineSegments=function(t,e){THREE.Line.call(this,t,e),this.type="LineSegments";},THREE.LineSegments.prototype=Object.create(THREE.Line.prototype),THREE.LineSegments.prototype.constructor=THREE.LineSegments,THREE.Mesh=function(t,e){THREE.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new THREE.Geometry(),this.material=void 0!==e?e:new THREE.MeshBasicMaterial({color:16777215*Math.random()}),this.drawMode=THREE.TrianglesDrawMode,this.updateMorphTargets();},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.constructor=THREE.Mesh,THREE.Mesh.prototype.setDrawMode=function(t){this.drawMode=t;},THREE.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1,this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var t=0,e=this.geometry.morphTargets.length;t<e;t++){this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[t].name]=t;}}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:(console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+t+" does not exist. Returning 0."),0);},THREE.Mesh.prototype.raycast=function(){function t(t,e,r,i,n,o,a){return THREE.Triangle.barycoordFromPoint(t,e,r,i,f),n.multiplyScalar(f.x),o.multiplyScalar(f.y),a.multiplyScalar(f.z),n.add(o).add(a),n.clone();}function e(t,e,r,i,n,o,a){var s=t.material;return null===(s.side===THREE.BackSide?r.intersectTriangle(o,n,i,!0,a):r.intersectTriangle(i,n,o,s.side!==THREE.DoubleSide,a))?null:(g.copy(a),g.applyMatrix4(t.matrixWorld),(r=e.ray.origin.distanceTo(g))<e.near||r>e.far?null:{distance:r,point:g.clone(),object:t});}function r(r,i,n,o,c,l,u,f){return a.fromArray(o,3*l),s.fromArray(o,3*u),h.fromArray(o,3*f),(r=e(r,i,n,a,s,h,m))&&(c&&(d.fromArray(c,2*l),p.fromArray(c,2*u),E.fromArray(c,2*f),r.uv=t(m,a,s,h,d,p,E)),r.face=new THREE.Face3(l,u,f,THREE.Triangle.normal(a,s,h)),r.faceIndex=l),r;}var i=new THREE.Matrix4(),n=new THREE.Ray(),o=new THREE.Sphere(),a=new THREE.Vector3(),s=new THREE.Vector3(),h=new THREE.Vector3(),c=new THREE.Vector3(),l=new THREE.Vector3(),u=new THREE.Vector3(),d=new THREE.Vector2(),p=new THREE.Vector2(),E=new THREE.Vector2(),f=new THREE.Vector3(),m=new THREE.Vector3(),g=new THREE.Vector3();return function(f,g){var T,v,y=this.geometry,R=this.material,H=this.matrixWorld;if(void 0!==R&&(null===y.boundingSphere&&y.computeBoundingSphere(),o.copy(y.boundingSphere),o.applyMatrix4(H),!1!==f.ray.intersectsSphere(o)&&(i.getInverse(H),n.copy(f.ray).applyMatrix4(i),null===y.boundingBox||!1!==n.intersectsBox(y.boundingBox))))if(y instanceof THREE.BufferGeometry){var x,b;R=y.index,y=(H=y.attributes).position.array;if(void 0!==H.uv&&(T=H.uv.array),null!==R)for(var _=0,M=(H=R.array).length;_<M;_+=3){R=H[_],x=H[_+1],b=H[_+2],(v=r(this,f,n,y,T,R,x,b))&&(v.faceIndex=Math.floor(_/3),g.push(v));}else for(_=0,M=y.length;_<M;_+=9){(v=r(this,f,n,y,T,R=_/3,x=R+1,b=R+2))&&(v.index=R,g.push(v));}}else if(y instanceof THREE.Geometry){var w,S;_=!0===(H=R instanceof THREE.MultiMaterial)?R.materials:null,M=y.vertices;x=y.faces,0<(b=y.faceVertexUvs[0]).length&&(T=b);for(var C=0,L=x.length;C<L;C++){var A=x[C];if(void 0!==(v=!0===H?_[A.materialIndex]:R)){if(b=M[A.a],w=M[A.b],S=M[A.c],!0===v.morphTargets){v=y.morphTargets;var P=this.morphTargetInfluences;a.set(0,0,0),s.set(0,0,0),h.set(0,0,0);for(var k=0,I=v.length;k<I;k++){var F=P[k];if(0!==F){var U=v[k].vertices;a.addScaledVector(c.subVectors(U[A.a],b),F),s.addScaledVector(l.subVectors(U[A.b],w),F),h.addScaledVector(u.subVectors(U[A.c],S),F);}}a.add(b),s.add(w),h.add(S),b=a,w=s,S=h;}(v=e(this,f,n,b,w,S,m))&&(T&&(P=T[C],d.copy(P[0]),p.copy(P[1]),E.copy(P[2]),v.uv=t(m,b,w,S,d,p,E)),v.face=A,v.faceIndex=C,g.push(v));}}}};}(),THREE.Mesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this);},THREE.Bone=function(t){THREE.Object3D.call(this),this.type="Bone",this.skin=t;},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.constructor=THREE.Bone,THREE.Bone.prototype.copy=function(t){return THREE.Object3D.prototype.copy.call(this,t),this.skin=t.skin,this;},THREE.Skeleton=function(t,e,r){if(this.useVertexTexture=void 0===r||r,this.identityMatrix=new THREE.Matrix4(),t=t||[],this.bones=t.slice(0),this.useVertexTexture?(t=Math.sqrt(4*this.bones.length),t=THREE.Math.nextPowerOfTwo(Math.ceil(t)),this.boneTextureHeight=this.boneTextureWidth=t=Math.max(t,4),this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType)):this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else for(console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[],e=0,t=this.bones.length;e<t;e++){this.boneInverses.push(new THREE.Matrix4());}},THREE.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var r=new THREE.Matrix4();this.bones[t]&&r.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(r);}},THREE.Skeleton.prototype.pose=function(){for(var t,e=0,r=this.bones.length;e<r;e++){(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);}for(e=0,r=this.bones.length;e<r;e++){(t=this.bones[e])&&(t.parent?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale));}},THREE.Skeleton.prototype.update=function(){var t=new THREE.Matrix4();return function(){for(var e=0,r=this.bones.length;e<r;e++){t.multiplyMatrices(this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix,this.boneInverses[e]),t.flattenToArrayOffset(this.boneMatrices,16*e);}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0);};}(),THREE.Skeleton.prototype.clone=function(){return new THREE.Skeleton(this.bones,this.boneInverses,this.useVertexTexture);},THREE.SkinnedMesh=function(t,e,r){if(THREE.Mesh.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new THREE.Matrix4(),this.bindMatrixInverse=new THREE.Matrix4(),t=[],this.geometry&&void 0!==this.geometry.bones){for(var i,n=0,o=this.geometry.bones.length;n<o;++n){i=this.geometry.bones[n],e=new THREE.Bone(this),t.push(e),e.name=i.name,e.position.fromArray(i.pos),e.quaternion.fromArray(i.rotq),void 0!==i.scl&&e.scale.fromArray(i.scl);}for(n=0,o=this.geometry.bones.length;n<o;++n){-1!==(i=this.geometry.bones[n]).parent&&null!==i.parent?t[i.parent].add(t[n]):this.add(t[n]);}}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new THREE.Skeleton(t,void 0,r),this.matrixWorld);},THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.SkinnedMesh.prototype.constructor=THREE.SkinnedMesh,THREE.SkinnedMesh.prototype.bind=function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e);},THREE.SkinnedMesh.prototype.pose=function(){this.skeleton.pose();},THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry)for(var t=0;t<this.geometry.skinWeights.length;t++){var e=1/(r=this.geometry.skinWeights[t]).lengthManhattan();1/0!==e?r.multiplyScalar(e):r.set(1,0,0,0);}else if(this.geometry instanceof THREE.BufferGeometry){var r=new THREE.Vector4(),i=this.geometry.attributes.skinWeight;for(t=0;t<i.count;t++){r.x=i.getX(t),r.y=i.getY(t),r.z=i.getZ(t),r.w=i.getW(t),1/0!==(e=1/r.lengthManhattan())?r.multiplyScalar(e):r.set(1,0,0,0),i.setXYZW(t,r.x,r.y,r.z,r.w);}}},THREE.SkinnedMesh.prototype.updateMatrixWorld=function(t){THREE.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode);},THREE.SkinnedMesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material,this.useVertexTexture).copy(this);},THREE.LOD=function(){THREE.Object3D.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},objects:{get:function get(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels;}}});},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.constructor=THREE.LOD,THREE.LOD.prototype.addLevel=function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var r=this.levels,i=0;i<r.length&&!(e<r[i].distance);i++){}r.splice(i,0,{distance:e,object:t}),this.add(t);},THREE.LOD.prototype.getObjectForDistance=function(t){for(var e=this.levels,r=1,i=e.length;r<i&&!(t<e[r].distance);r++){}return e[r-1].object;},THREE.LOD.prototype.raycast=function(){var t=new THREE.Vector3();return function(e,r){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo(t);this.getObjectForDistance(i).raycast(e,r);};}(),THREE.LOD.prototype.update=function(){var t=new THREE.Vector3(),e=new THREE.Vector3();return function(r){var i=this.levels;if(1<i.length){t.setFromMatrixPosition(r.matrixWorld),e.setFromMatrixPosition(this.matrixWorld),r=t.distanceTo(e),i[0].object.visible=!0;for(var n=1,o=i.length;n<o&&r>=i[n].distance;n++){i[n-1].object.visible=!1,i[n].object.visible=!0;}for(;n<o;n++){i[n].object.visible=!1;}}};}(),THREE.LOD.prototype.copy=function(t){THREE.Object3D.prototype.copy.call(this,t,!1);for(var e=0,r=(t=t.levels).length;e<r;e++){var i=t[e];this.addLevel(i.object.clone(),i.distance);}return this;},THREE.LOD.prototype.toJSON=function(t){(t=THREE.Object3D.prototype.toJSON.call(this,t)).object.levels=[];for(var e=this.levels,r=0,i=e.length;r<i;r++){var n=e[r];t.object.levels.push({object:n.object.uuid,distance:n.distance});}return t;},THREE.Sprite=function(){var t=new Uint16Array([0,1,2,0,2,3]),e=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),r=new Float32Array([0,0,1,0,1,1,0,1]),i=new THREE.BufferGeometry();return i.setIndex(new THREE.BufferAttribute(t,1)),i.addAttribute("position",new THREE.BufferAttribute(e,3)),i.addAttribute("uv",new THREE.BufferAttribute(r,2)),function(t){THREE.Object3D.call(this),this.type="Sprite",this.geometry=i,this.material=void 0!==t?t:new THREE.SpriteMaterial();};}(),THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.constructor=THREE.Sprite,THREE.Sprite.prototype.raycast=function(){var t=new THREE.Vector3();return function(e,r){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.distanceSqToPoint(t);i>this.scale.x*this.scale.y||r.push({distance:Math.sqrt(i),point:this.position,face:null,object:this});};}(),THREE.Sprite.prototype.clone=function(){return new this.constructor(this.material).copy(this);},THREE.Particle=THREE.Sprite,THREE.LensFlare=function(t,e,r,i,n){THREE.Object3D.call(this),this.lensFlares=[],this.positionScreen=new THREE.Vector3(),this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,r,i,n);},THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare.prototype.constructor=THREE.LensFlare,THREE.LensFlare.prototype.add=function(t,e,r,i,n,o){void 0===e&&(e=-1),void 0===r&&(r=0),void 0===o&&(o=1),void 0===n&&(n=new THREE.Color(16777215)),void 0===i&&(i=THREE.NormalBlending),r=Math.min(r,Math.max(0,r)),this.lensFlares.push({texture:t,size:e,distance:r,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:n,blending:i});},THREE.LensFlare.prototype.updateLensFlares=function(){var t,e,r=this.lensFlares.length,i=2*-this.positionScreen.x,n=2*-this.positionScreen.y;for(t=0;t<r;t++){(e=this.lensFlares[t]).x=this.positionScreen.x+i*e.distance,e.y=this.positionScreen.y+n*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation);}},THREE.LensFlare.prototype.copy=function(t){THREE.Object3D.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,r=t.lensFlares.length;e<r;e++){this.lensFlares.push(t.lensFlares[e]);}return this;},THREE.Scene=function(){THREE.Object3D.call(this),this.type="Scene",this.overrideMaterial=this.fog=null,this.autoUpdate=!0;},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.constructor=THREE.Scene,THREE.Scene.prototype.copy=function(t,e){return THREE.Object3D.prototype.copy.call(this,t,e),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this;},THREE.Fog=function(t,e,r){this.name="",this.color=new THREE.Color(t),this.near=void 0!==e?e:1,this.far=void 0!==r?r:1e3;},THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far);},THREE.FogExp2=function(t,e){this.name="",this.color=new THREE.Color(t),this.density=void 0!==e?e:25e-5;},THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density);},THREE.ShaderChunk={},THREE.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",THREE.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",THREE.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",THREE.ShaderChunk.ambient_pars="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\treturn PI * ambientLightColor;\n}\n",THREE.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\n\treflectedLight.indirectDiffuse *= ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n#endif\n",THREE.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",THREE.ShaderChunk.begin_vertex="\nvec3 transformed = vec3( position );\n",THREE.ShaderChunk.beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n",THREE.ShaderChunk.bsdfs="bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat calcLightAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif ( decayExponent > 0.0 ) {\n\t  return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = alpha * alpha;\n\tfloat gl = dotNL + pow( a2 + ( 1.0 - a2 ) * dotNL * dotNL, 0.5 );\n\tfloat gv = dotNV + pow( a2 + ( 1.0 - a2 ) * dotNV * dotNV, 0.5 );\n\treturn 1.0 / ( gl * gv );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = alpha * alpha;\n\tfloat denom = dotNH * dotNH * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / ( denom * denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = roughness * roughness;\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_Smith( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / square( ggxRoughness + 0.0001 ) - 2.0 );\n}\n",THREE.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",THREE.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",THREE.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",THREE.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",THREE.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",THREE.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat square( const in float x ) { return x*x; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nvec3 inputToLinear( in vec3 a ) {\n\t#ifdef GAMMA_INPUT\n\t\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\n\t#else\n\t\treturn a;\n\t#endif\n}\nvec3 linearToOutput( in vec3 a ) {\n\t#ifdef GAMMA_OUTPUT\n\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n\t#else\n\t\treturn a;\n\t#endif\n}\n",THREE.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",THREE.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",THREE.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",THREE.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = inputToLinear( emissiveColor.rgb );\n\ttotalEmissiveLight *= emissiveColor.rgb;\n#endif\n",THREE.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",THREE.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\tenvColor.xyz = inputToLinear( envColor.xyz );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",THREE.ShaderChunk.envmap_pars_fragment="#if defined( USE_ENVMAP ) || defined( STANDARD )\n\tuniform float reflectivity;\n\tuniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( STANDARD )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",THREE.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG ) && ! defined( STANDARD )\n\tvarying vec3 vReflect;\n\tuniform float refractionRatio;\n#endif\n",THREE.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG ) && ! defined( STANDARD )\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t#ifdef ENVMAP_MODE_REFLECTION\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t#else\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t#endif\n#endif\n",THREE.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\t\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\n#endif",THREE.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",THREE.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",THREE.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",THREE.ShaderChunk.lights_lambert_vertex="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tdirectLight = getPointDirectLight( pointLights[ i ], geometry );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tdirectLight = getSpotDirectLight( spotLights[ i ], geometry );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectLight = getDirectionalDirectLight( directionalLights[ i ], geometry );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",THREE.ShaderChunk.lights_pars="#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tIncidentLight getDirectionalDirectLight( const in DirectionalLight directionalLight, const in GeometricContext geometry ) {\n\t\tIncidentLight directLight;\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t\treturn directLight;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tIncidentLight getPointDirectLight( const in PointLight pointLight, const in GeometricContext geometry ) {\n\t\tIncidentLight directLight;\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\n\t\t\tdirectLight.color = pointLight.color;\n\t\t\tdirectLight.color *= calcLightAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t\treturn directLight;\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat angleCos;\n\t\tfloat penumbra;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tIncidentLight getSpotDirectLight( const in SpotLight spotLight, const in GeometricContext geometry ) {\n\t\tIncidentLight directLight;\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat spotEffect = dot( directLight.direction, spotLight.direction );\n\t\tif ( all( bvec2( spotEffect > spotLight.angleCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n\t\t\tfloat spotEffect = dot( spotLight.direction, directLight.direction );\n\t\t\tspotEffect *= clamp( ( spotEffect - spotLight.angleCos ) / spotLight.penumbra, 0.0, 1.0 );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= ( spotEffect * calcLightAttenuation( lightDistance, spotLight.distance, spotLight.decay ) );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t\treturn directLight;\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\treturn PI * mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( STANDARD )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t#else\n\t\t\tvec3 envMapColor = vec3( 0.0 );\n\t\t#endif\n\t\tenvMapColor.rgb = inputToLinear( envMapColor.rgb );\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( square( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t#endif\n\t\tenvMapColor.rgb = inputToLinear( envMapColor.rgb );\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",THREE.ShaderChunk.lights_phong_fragment="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",THREE.ShaderChunk.lights_phong_pars_fragment="#ifdef USE_ENVMAP\n\tvarying vec3 vWorldPosition;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * PI * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",THREE.ShaderChunk.lights_phong_pars_vertex="#ifdef USE_ENVMAP\n\tvarying vec3 vWorldPosition;\n#endif\n",THREE.ShaderChunk.lights_phong_vertex="#ifdef USE_ENVMAP\n\tvWorldPosition = worldPosition.xyz;\n#endif\n",THREE.ShaderChunk.lights_standard_fragment="StandardMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\nmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n",THREE.ShaderChunk.lights_standard_pars_fragment="struct StandardMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n};\nvoid RE_Direct_Standard( const in IncidentLight directLight, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * PI * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n}\nvoid RE_IndirectDiffuse_Standard( const in vec3 irradiance, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Standard( const in vec3 radiance, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectSpecular += radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Standard\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Standard\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Standard\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n",THREE.ShaderChunk.lights_template="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tdirectLight = getPointDirectLight( pointLight, geometry );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tdirectLight = getSpotDirectLight( spotLight, geometry );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tdirectLight = getDirectionalDirectLight( directionalLight, geometry );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tirradiance += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\tRE_IndirectSpecular( radiance, geometry, material, reflectedLight );\n#endif\n",THREE.ShaderChunk.linear_to_gamma_fragment="\n\toutgoingLight = linearToOutput( outgoingLight );\n",THREE.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",THREE.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",THREE.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",THREE.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",THREE.ShaderChunk.map_fragment="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\n\tdiffuseColor *= texelColor;\n#endif\n",THREE.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",THREE.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n#endif\n",THREE.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",THREE.ShaderChunk.metalnessmap_fragment="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n",THREE.ShaderChunk.metalnessmap_pars_fragment="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",THREE.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",THREE.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",THREE.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",THREE.ShaderChunk.normal_fragment="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",THREE.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",THREE.ShaderChunk.project_vertex="#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",THREE.ShaderChunk.roughnessmap_fragment="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n",THREE.ShaderChunk.roughnessmap_pars_fragment="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",THREE.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\treturn dot( rgba_depth, bit_shift );\n\t}\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",THREE.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",THREE.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",THREE.ShaderChunk.shadowmask_pars_fragment="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",THREE.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",THREE.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",THREE.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",THREE.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",THREE.ShaderChunk.specularmap_fragment="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",THREE.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",THREE.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",THREE.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",THREE.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",THREE.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",THREE.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",THREE.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",THREE.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( STANDARD ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",THREE.UniformsUtils={merge:function merge(t){for(var e={},r=0;r<t.length;r++){var i,n=this.clone(t[r]);for(i in n){e[i]=n[i];}}return e;},clone:function clone(t){var e,r={};for(e in t){for(var i in r[e]={},t[e]){var n=t[e][i];n instanceof THREE.Color||n instanceof THREE.Vector2||n instanceof THREE.Vector3||n instanceof THREE.Vector4||n instanceof THREE.Matrix3||n instanceof THREE.Matrix4||n instanceof THREE.Texture?r[e][i]=n.clone():Array.isArray(n)?r[e][i]=n.slice():r[e][i]=n;}}return r;}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98}},aomap:{aoMap:{type:"t",value:null},aoMapIntensity:{type:"f",value:1}},lightmap:{lightMap:{type:"t",value:null},lightMapIntensity:{type:"f",value:1}},emissivemap:{emissiveMap:{type:"t",value:null}},bumpmap:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},displacementmap:{displacementMap:{type:"t",value:null},displacementScale:{type:"f",value:1},displacementBias:{type:"f",value:0}},roughnessmap:{roughnessMap:{type:"t",value:null}},metalnessmap:{metalnessMap:{type:"t",value:null}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},ambient:{ambientLightColor:{type:"fv",value:[]}},lights:{directionalLights:{type:"sa",value:[],properties:{direction:{type:"v3"},color:{type:"c"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},directionalShadowMap:{type:"tv",value:[]},directionalShadowMatrix:{type:"m4v",value:[]},spotLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},direction:{type:"v3"},distance:{type:"f"},angleCos:{type:"f"},penumbra:{type:"f"},decay:{type:"f"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},spotShadowMap:{type:"tv",value:[]},spotShadowMatrix:{type:"m4v",value:[]},pointLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},decay:{type:"f"},distance:{type:"f"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},pointShadowMap:{type:"tv",value:[]},pointShadowMatrix:{type:"m4v",value:[]},hemisphereLights:{type:"sa",value:[],properties:{direction:{type:"v3"},skyColor:{type:"c"},groundColor:{type:"c"}}}},points:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)}}},THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.fog]),vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.uv_pars_vertex,THREE.ShaderChunk.uv2_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.uv_vertex,THREE.ShaderChunk.uv2_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"\t#ifdef USE_ENVMAP",THREE.ShaderChunk.beginnormal_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"\t#endif",THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.uv_pars_fragment,THREE.ShaderChunk.uv2_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.aomap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"\tReflectedLight reflectedLight;\n\treflectedLight.directDiffuse = vec3( 0.0 );\n\treflectedLight.directSpecular = vec3( 0.0 );\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\n\treflectedLight.indirectSpecular = vec3( 0.0 );",THREE.ShaderChunk.aomap_fragment,"\tvec3 outgoingLight = reflectedLight.indirectDiffuse;",THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.lightmap,THREE.UniformsLib.emissivemap,THREE.UniformsLib.fog,THREE.UniformsLib.ambient,THREE.UniformsLib.lights,{emissive:{type:"c",value:new THREE.Color(0)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.uv_pars_vertex,THREE.ShaderChunk.uv2_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.bsdfs,THREE.ShaderChunk.lights_pars,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.uv_vertex,THREE.ShaderChunk.uv2_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.beginnormal_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.uv_pars_fragment,THREE.ShaderChunk.uv2_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.aomap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.emissivemap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.bsdfs,THREE.ShaderChunk.ambient_pars,THREE.ShaderChunk.lights_pars,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.shadowmask_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveLight = emissive;",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.emissivemap_fragment,"\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );",THREE.ShaderChunk.lightmap_fragment,"\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();",THREE.ShaderChunk.aomap_fragment,"\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveLight;",THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.lightmap,THREE.UniformsLib.emissivemap,THREE.UniformsLib.bumpmap,THREE.UniformsLib.normalmap,THREE.UniformsLib.displacementmap,THREE.UniformsLib.fog,THREE.UniformsLib.ambient,THREE.UniformsLib.lights,{emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.uv_pars_vertex,THREE.ShaderChunk.uv2_pars_vertex,THREE.ShaderChunk.displacementmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.uv_vertex,THREE.ShaderChunk.uv2_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.beginnormal_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif",THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.displacementmap_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"\tvViewPosition = - mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.uv_pars_fragment,THREE.ShaderChunk.uv2_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.aomap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.emissivemap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.bsdfs,THREE.ShaderChunk.ambient_pars,THREE.ShaderChunk.lights_pars,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveLight = emissive;",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.normal_fragment,THREE.ShaderChunk.emissivemap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lights_template,THREE.ShaderChunk.aomap_fragment,"vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveLight;",THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},standard:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.lightmap,THREE.UniformsLib.emissivemap,THREE.UniformsLib.bumpmap,THREE.UniformsLib.normalmap,THREE.UniformsLib.displacementmap,THREE.UniformsLib.roughnessmap,THREE.UniformsLib.metalnessmap,THREE.UniformsLib.fog,THREE.UniformsLib.ambient,THREE.UniformsLib.lights,{emissive:{type:"c",value:new THREE.Color(0)},roughness:{type:"f",value:.5},metalness:{type:"f",value:0},envMapIntensity:{type:"f",value:1}}]),vertexShader:["#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.uv_pars_vertex,THREE.ShaderChunk.uv2_pars_vertex,THREE.ShaderChunk.displacementmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.uv_vertex,THREE.ShaderChunk.uv2_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.beginnormal_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif",THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.displacementmap_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"\tvViewPosition = - mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define STANDARD\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.uv_pars_fragment,THREE.ShaderChunk.uv2_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.aomap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.emissivemap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.bsdfs,THREE.ShaderChunk.ambient_pars,THREE.ShaderChunk.lights_pars,THREE.ShaderChunk.lights_standard_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.roughnessmap_pars_fragment,THREE.ShaderChunk.metalnessmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveLight = emissive;",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.roughnessmap_fragment,THREE.ShaderChunk.metalnessmap_fragment,THREE.ShaderChunk.normal_fragment,THREE.ShaderChunk.emissivemap_fragment,THREE.ShaderChunk.lights_standard_fragment,THREE.ShaderChunk.lights_template,THREE.ShaderChunk.aomap_fragment,"vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveLight;",THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},points:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.points,THREE.UniformsLib.fog]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.project_vertex,"\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif",THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphatest_fragment,"\toutgoingLight = diffuseColor.rgb;",THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.color_fragment,"\toutgoingLight = diffuseColor.rgb;",THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;\nuniform float mFar;\nuniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",THREE.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\n\tgl_FragColor = vec4( vec3( color ), opacity );\n}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vNormal;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\nvec3 direction = normalize( vWorldPosition );\nvec2 sampleUV;\nsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\nsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\ngl_FragColor = texture2D( tEquirect, sampleUV );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nvoid main() {",THREE.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\n\t#else\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n\t#endif\n}"].join("\n")},distanceRGBA:{uniforms:{lightPos:{type:"v3",value:new THREE.Vector3(0,0,0)}},vertexShader:["varying vec4 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.worldpos_vertex,"vWorldPosition = worldPosition;\n}"].join("\n"),fragmentShader:["uniform vec3 lightPos;\nvarying vec4 vWorldPosition;",THREE.ShaderChunk.common,"vec4 pack1K ( float depth ) {\n\tdepth /= 1000.0;\n\tconst vec4 bitSh = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bitMsk = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( depth * bitSh * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bitMsk;\n\treturn res; \n}\nfloat unpack1K ( vec4 color ) {\n\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\treturn dot( color, bitSh ) * 1000.0;\n}\nvoid main () {\n\tgl_FragColor = pack1K( length( vWorldPosition.xyz - lightPos.xyz ) );\n}"].join("\n")}},THREE.WebGLRenderer=function(t){function e(t,e,r,i){!0===I&&(t*=i,e*=i,r*=i),Tt.clearColor(t,e,r,i);}function r(){Tt.init(),Tt.scissor(J.copy(st).multiplyScalar(at)),Tt.viewport(tt.copy(ct).multiplyScalar(at)),e(rt.r,rt.g,rt.b,it);}function i(){K=X=null,Q="",Z=-1,Tt.reset();}function n(t){t.preventDefault(),i(),r(),vt.clear();}function o(t){(t=t.target).removeEventListener("dispose",o);t:{var e=vt.get(t);if(t.image&&e.__image__webglTextureCube)j.deleteTexture(e.__image__webglTextureCube);else{if(void 0===e.__webglInit)break t;j.deleteTexture(e.__webglTexture);}vt.delete(t);}Et.textures--;}function a(t){(t=t.target).removeEventListener("dispose",a);var e=vt.get(t),r=vt.get(t.texture);if(t&&void 0!==r.__webglTexture){if(j.deleteTexture(r.__webglTexture),t instanceof THREE.WebGLRenderTargetCube)for(r=0;6>r;r++){j.deleteFramebuffer(e.__webglFramebuffer[r]),j.deleteRenderbuffer(e.__webglDepthbuffer[r]);}else j.deleteFramebuffer(e.__webglFramebuffer),j.deleteRenderbuffer(e.__webglDepthbuffer);vt.delete(t.texture),vt.delete(t);}Et.textures--;}function s(t){(t=t.target).removeEventListener("dispose",s),h(t),vt.delete(t);}function h(t){var e=vt.get(t).program;t.program=void 0,void 0!==e&&Rt.releaseProgram(e);}function c(t,e){return Math.abs(e[0])-Math.abs(t[0]);}function l(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id;}function u(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id;}function d(t,e,r,i,n){var o;r.transparent?(i=V,o=++N):(i=D,o=++B),void 0!==(o=i[o])?(o.id=t.id,o.object=t,o.geometry=e,o.material=r,o.z=dt.z,o.group=n):(o={id:t.id,object:t,geometry:e,material:r,z:dt.z,group:n},i.push(o));}function p(t,e){if(!1!==t.visible){if(t.layers.test(e.layers))if(t instanceof THREE.Light)U.push(t);else if(t instanceof THREE.Sprite)!1!==t.frustumCulled&&!0!==lt.intersectsObject(t)||z.push(t);else if(t instanceof THREE.LensFlare)G.push(t);else if(t instanceof THREE.ImmediateRenderObject)!0===W.sortObjects&&(dt.setFromMatrixPosition(t.matrixWorld),dt.applyProjection(ut)),d(t,null,t.material,dt.z,null);else if((t instanceof THREE.Mesh||t instanceof THREE.Line||t instanceof THREE.Points)&&(t instanceof THREE.SkinnedMesh&&t.skeleton.update(),!1===t.frustumCulled||!0===lt.intersectsObject(t))){if(!0===(o=t.material).visible){!0===W.sortObjects&&(dt.setFromMatrixPosition(t.matrixWorld),dt.applyProjection(ut));var r=yt.update(t);if(o instanceof THREE.MultiMaterial)for(var i=r.groups,n=o.materials,o=0,a=i.length;o<a;o++){var s=i[o],h=n[s.materialIndex];!0===h.visible&&d(t,r,h,dt.z,s);}else d(t,r,o,dt.z,null);}}for(o=0,a=(r=t.children).length;o<a;o++){p(r[o],e);}}}function E(t,e,r,i){for(var n=0,o=t.length;n<o;n++){var a=(c=t[n]).object,s=c.geometry,h=void 0===i?c.material:i,c=c.group;if(a.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,a.matrixWorld),a.normalMatrix.getNormalMatrix(a.modelViewMatrix),a instanceof THREE.ImmediateRenderObject){f(h);var l=m(e,r,h,a);Q="",a.render(function(t){W.renderBufferImmediate(t,l,h);});}else W.renderBufferDirect(e,r,s,h,a,c);}}function f(t){t.side!==THREE.DoubleSide?Tt.enable(j.CULL_FACE):Tt.disable(j.CULL_FACE),Tt.setFlipSided(t.side===THREE.BackSide),!0===t.transparent?Tt.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha):Tt.setBlending(THREE.NoBlending),Tt.setDepthFunc(t.depthFunc),Tt.setDepthTest(t.depthTest),Tt.setDepthWrite(t.depthWrite),Tt.setColorWrite(t.colorWrite),Tt.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits);}function m(t,e,r,i){et=0;var n=vt.get(r);if(void 0===n.program&&(r.needsUpdate=!0),void 0!==n.lightsHash&&n.lightsHash!==pt.hash&&(r.needsUpdate=!0),r.needsUpdate){t:{var o=vt.get(r),a=Rt.getParameters(r,pt,e,i),c=Rt.getProgramCode(r,a),l=o.program,u=!0;if(void 0===l)r.addEventListener("dispose",s);else if(l.code!==c)h(r);else{if(void 0!==a.shaderID)break t;u=!1;}if(u&&(a.shaderID?(l=THREE.ShaderLib[a.shaderID],o.__webglShader={name:r.type,uniforms:THREE.UniformsUtils.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}):o.__webglShader={name:r.type,uniforms:r.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader},r.__webglShader=o.__webglShader,l=Rt.acquireProgram(r,a,c),o.program=l,r.program=l),a=l.getAttributes(),r.morphTargets)for(c=r.numSupportedMorphTargets=0;c<W.maxMorphTargets;c++){0<=a["morphTarget"+c]&&r.numSupportedMorphTargets++;}if(r.morphNormals)for(c=r.numSupportedMorphNormals=0;c<W.maxMorphNormals;c++){0<=a["morphNormal"+c]&&r.numSupportedMorphNormals++;}o.uniformsList=[];var d;a=o.__webglShader.uniforms,c=o.program.getUniforms();for(d in a){(l=c[d])&&o.uniformsList.push([o.__webglShader.uniforms[d],l]);}for((r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.MeshStandardMaterial||r.lights)&&(o.lightsHash=pt.hash,a.ambientLightColor.value=pt.ambient,a.directionalLights.value=pt.directional,a.spotLights.value=pt.spot,a.pointLights.value=pt.point,a.hemisphereLights.value=pt.hemi,a.directionalShadowMap.value=pt.directionalShadowMap,a.directionalShadowMatrix.value=pt.directionalShadowMatrix,a.spotShadowMap.value=pt.spotShadowMap,a.spotShadowMatrix.value=pt.spotShadowMatrix,a.pointShadowMap.value=pt.pointShadowMap,a.pointShadowMatrix.value=pt.pointShadowMatrix),o.hasDynamicUniforms=!1,d=0,a=o.uniformsList.length;d<a;d++){if(!0===o.uniformsList[d][0].dynamic){o.hasDynamicUniforms=!0;break;}}}r.needsUpdate=!1;}if(l=c=u=!1,d=(o=n.program).getUniforms(),a=n.__webglShader.uniforms,o.id!==X&&(j.useProgram(o.program),X=o.id,l=c=u=!0),r.id!==Z&&(Z=r.id,c=!0),(u||t!==K)&&(j.uniformMatrix4fv(d.projectionMatrix,!1,t.projectionMatrix.elements),gt.logarithmicDepthBuffer&&j.uniform1f(d.logDepthBufFC,2/(Math.log(t.far+1)/Math.LN2)),t!==K&&(K=t,l=c=!0),(r instanceof THREE.ShaderMaterial||r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshStandardMaterial||r.envMap)&&void 0!==d.cameraPosition&&(dt.setFromMatrixPosition(t.matrixWorld),j.uniform3f(d.cameraPosition,dt.x,dt.y,dt.z)),(r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.MeshBasicMaterial||r instanceof THREE.MeshStandardMaterial||r instanceof THREE.ShaderMaterial||r.skinning)&&void 0!==d.viewMatrix&&j.uniformMatrix4fv(d.viewMatrix,!1,t.matrixWorldInverse.elements)),r.skinning&&(i.bindMatrix&&void 0!==d.bindMatrix&&j.uniformMatrix4fv(d.bindMatrix,!1,i.bindMatrix.elements),i.bindMatrixInverse&&void 0!==d.bindMatrixInverse&&j.uniformMatrix4fv(d.bindMatrixInverse,!1,i.bindMatrixInverse.elements),gt.floatVertexTextures&&i.skeleton&&i.skeleton.useVertexTexture?(void 0!==d.boneTexture&&(u=g(),j.uniform1i(d.boneTexture,u),W.setTexture(i.skeleton.boneTexture,u)),void 0!==d.boneTextureWidth&&j.uniform1i(d.boneTextureWidth,i.skeleton.boneTextureWidth),void 0!==d.boneTextureHeight&&j.uniform1i(d.boneTextureHeight,i.skeleton.boneTextureHeight)):i.skeleton&&i.skeleton.boneMatrices&&void 0!==d.boneGlobalMatrices&&j.uniformMatrix4fv(d.boneGlobalMatrices,!1,i.skeleton.boneMatrices)),c){var p;if((r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.MeshStandardMaterial||r.lights)&&(c=l,a.ambientLightColor.needsUpdate=c,a.directionalLights.needsUpdate=c,a.pointLights.needsUpdate=c,a.spotLights.needsUpdate=c,a.hemisphereLights.needsUpdate=c),e&&r.fog&&(a.fogColor.value=e.color,e instanceof THREE.Fog?(a.fogNear.value=e.near,a.fogFar.value=e.far):e instanceof THREE.FogExp2&&(a.fogDensity.value=e.density)),r instanceof THREE.MeshBasicMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshStandardMaterial)a.opacity.value=r.opacity,a.diffuse.value=r.color,r.emissive&&a.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),a.map.value=r.map,a.specularMap.value=r.specularMap,a.alphaMap.value=r.alphaMap,r.aoMap&&(a.aoMap.value=r.aoMap,a.aoMapIntensity.value=r.aoMapIntensity),r.map?p=r.map:r.specularMap?p=r.specularMap:r.displacementMap?p=r.displacementMap:r.normalMap?p=r.normalMap:r.bumpMap?p=r.bumpMap:r.roughnessMap?p=r.roughnessMap:r.metalnessMap?p=r.metalnessMap:r.alphaMap?p=r.alphaMap:r.emissiveMap&&(p=r.emissiveMap),void 0!==p&&(p instanceof THREE.WebGLRenderTarget&&(p=p.texture),e=p.offset,p=p.repeat,a.offsetRepeat.value.set(e.x,e.y,p.x,p.y)),a.envMap.value=r.envMap,a.flipEnvMap.value=r.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,a.reflectivity.value=r.reflectivity,a.refractionRatio.value=r.refractionRatio;r instanceof THREE.LineBasicMaterial?(a.diffuse.value=r.color,a.opacity.value=r.opacity):r instanceof THREE.LineDashedMaterial?(a.diffuse.value=r.color,a.opacity.value=r.opacity,a.dashSize.value=r.dashSize,a.totalSize.value=r.dashSize+r.gapSize,a.scale.value=r.scale):r instanceof THREE.PointsMaterial?(a.diffuse.value=r.color,a.opacity.value=r.opacity,a.size.value=r.size*at,a.scale.value=S.clientHeight/2,a.map.value=r.map,null!==r.map&&(p=r.map.offset,r=r.map.repeat,a.offsetRepeat.value.set(p.x,p.y,r.x,r.y))):r instanceof THREE.MeshLambertMaterial?(r.lightMap&&(a.lightMap.value=r.lightMap,a.lightMapIntensity.value=r.lightMapIntensity),r.emissiveMap&&(a.emissiveMap.value=r.emissiveMap)):r instanceof THREE.MeshPhongMaterial?(a.specular.value=r.specular,a.shininess.value=Math.max(r.shininess,1e-4),r.lightMap&&(a.lightMap.value=r.lightMap,a.lightMapIntensity.value=r.lightMapIntensity),r.emissiveMap&&(a.emissiveMap.value=r.emissiveMap),r.bumpMap&&(a.bumpMap.value=r.bumpMap,a.bumpScale.value=r.bumpScale),r.normalMap&&(a.normalMap.value=r.normalMap,a.normalScale.value.copy(r.normalScale)),r.displacementMap&&(a.displacementMap.value=r.displacementMap,a.displacementScale.value=r.displacementScale,a.displacementBias.value=r.displacementBias)):r instanceof THREE.MeshStandardMaterial?(a.roughness.value=r.roughness,a.metalness.value=r.metalness,r.roughnessMap&&(a.roughnessMap.value=r.roughnessMap),r.metalnessMap&&(a.metalnessMap.value=r.metalnessMap),r.lightMap&&(a.lightMap.value=r.lightMap,a.lightMapIntensity.value=r.lightMapIntensity),r.emissiveMap&&(a.emissiveMap.value=r.emissiveMap),r.bumpMap&&(a.bumpMap.value=r.bumpMap,a.bumpScale.value=r.bumpScale),r.normalMap&&(a.normalMap.value=r.normalMap,a.normalScale.value.copy(r.normalScale)),r.displacementMap&&(a.displacementMap.value=r.displacementMap,a.displacementScale.value=r.displacementScale,a.displacementBias.value=r.displacementBias),r.envMap&&(a.envMapIntensity.value=r.envMapIntensity)):r instanceof THREE.MeshDepthMaterial?(a.mNear.value=t.near,a.mFar.value=t.far,a.opacity.value=r.opacity):r instanceof THREE.MeshNormalMaterial&&(a.opacity.value=r.opacity),T(n.uniformsList);}if(j.uniformMatrix4fv(d.modelViewMatrix,!1,i.modelViewMatrix.elements),d.normalMatrix&&j.uniformMatrix3fv(d.normalMatrix,!1,i.normalMatrix.elements),void 0!==d.modelMatrix&&j.uniformMatrix4fv(d.modelMatrix,!1,i.matrixWorld.elements),!0===n.hasDynamicUniforms){for(r=[],p=0,e=(n=n.uniformsList).length;p<e;p++){void 0!==(a=(d=n[p][0]).onUpdateCallback)&&(a.bind(d)(i,t),r.push(n[p]));}T(r);}return o;}function g(){var t=et;return t>=gt.maxTextures&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+gt.maxTextures),et+=1,t;}function T(t){for(var e,r,i=0,n=t.length;i<n;i++){var o=t[i][0];if(!1!==o.needsUpdate){var a=o.type;e=o.value;var s=t[i][1];switch(a){case"1i":j.uniform1i(s,e);break;case"1f":j.uniform1f(s,e);break;case"2f":j.uniform2f(s,e[0],e[1]);break;case"3f":j.uniform3f(s,e[0],e[1],e[2]);break;case"4f":j.uniform4f(s,e[0],e[1],e[2],e[3]);break;case"1iv":j.uniform1iv(s,e);break;case"3iv":j.uniform3iv(s,e);break;case"1fv":j.uniform1fv(s,e);break;case"2fv":j.uniform2fv(s,e);break;case"3fv":j.uniform3fv(s,e);break;case"4fv":j.uniform4fv(s,e);break;case"Matrix2fv":j.uniformMatrix2fv(s,!1,e);break;case"Matrix3fv":j.uniformMatrix3fv(s,!1,e);break;case"Matrix4fv":j.uniformMatrix4fv(s,!1,e);break;case"i":j.uniform1i(s,e);break;case"f":j.uniform1f(s,e);break;case"v2":j.uniform2f(s,e.x,e.y);break;case"v3":j.uniform3f(s,e.x,e.y,e.z);break;case"v4":j.uniform4f(s,e.x,e.y,e.z,e.w);break;case"c":j.uniform3f(s,e.r,e.g,e.b);break;case"sa":for(a=0;a<e.length;a++){for(var h in o.properties){var c=s[a][h];switch(r=e[a][h],o.properties[h].type){case"i":j.uniform1i(c,r);break;case"f":j.uniform1f(c,r);break;case"v2":j.uniform2f(c,r.x,r.y);break;case"v3":j.uniform3f(c,r.x,r.y,r.z);break;case"v4":j.uniform4f(c,r.x,r.y,r.z,r.w);break;case"c":j.uniform3f(c,r.r,r.g,r.b);break;case"m4":j.uniformMatrix4fv(c,!1,r.elements);}}}break;case"iv1":j.uniform1iv(s,e);break;case"iv":j.uniform3iv(s,e);break;case"fv1":j.uniform1fv(s,e);break;case"fv":j.uniform3fv(s,e);break;case"v2v":for(void 0===o._array&&(o._array=new Float32Array(2*e.length)),r=a=0,c=e.length;a<c;a++,r+=2){o._array[r+0]=e[a].x,o._array[r+1]=e[a].y;}j.uniform2fv(s,o._array);break;case"v3v":for(void 0===o._array&&(o._array=new Float32Array(3*e.length)),r=a=0,c=e.length;a<c;a++,r+=3){o._array[r+0]=e[a].x,o._array[r+1]=e[a].y,o._array[r+2]=e[a].z;}j.uniform3fv(s,o._array);break;case"v4v":for(void 0===o._array&&(o._array=new Float32Array(4*e.length)),r=a=0,c=e.length;a<c;a++,r+=4){o._array[r+0]=e[a].x,o._array[r+1]=e[a].y,o._array[r+2]=e[a].z,o._array[r+3]=e[a].w;}j.uniform4fv(s,o._array);break;case"m2":j.uniformMatrix2fv(s,!1,e.elements);break;case"m3":j.uniformMatrix3fv(s,!1,e.elements);break;case"m3v":for(void 0===o._array&&(o._array=new Float32Array(9*e.length)),a=0,c=e.length;a<c;a++){e[a].flattenToArrayOffset(o._array,9*a);}j.uniformMatrix3fv(s,!1,o._array);break;case"m4":j.uniformMatrix4fv(s,!1,e.elements);break;case"m4v":for(void 0===o._array&&(o._array=new Float32Array(16*e.length)),a=0,c=e.length;a<c;a++){e[a].flattenToArrayOffset(o._array,16*a);}j.uniformMatrix4fv(s,!1,o._array);break;case"t":if(r=g(),j.uniform1i(s,r),!e)continue;e instanceof THREE.CubeTexture||Array.isArray(e.image)&&6===e.image.length?H(e,r):e instanceof THREE.WebGLRenderTargetCube?x(e.texture,r):e instanceof THREE.WebGLRenderTarget?W.setTexture(e.texture,r):W.setTexture(e,r);break;case"tv":for(void 0===o._array&&(o._array=[]),a=0,c=o.value.length;a<c;a++){o._array[a]=g();}for(j.uniform1iv(s,o._array),a=0,c=o.value.length;a<c;a++){e=o.value[a],r=o._array[a],e&&(e instanceof THREE.CubeTexture||e.image instanceof Array&&6===e.image.length?H(e,r):e instanceof THREE.WebGLRenderTarget?W.setTexture(e.texture,r):e instanceof THREE.WebGLRenderTargetCube?x(e.texture,r):W.setTexture(e,r));}break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+a);}}}}function v(t,e,r){r?(j.texParameteri(t,j.TEXTURE_WRAP_S,w(e.wrapS)),j.texParameteri(t,j.TEXTURE_WRAP_T,w(e.wrapT)),j.texParameteri(t,j.TEXTURE_MAG_FILTER,w(e.magFilter)),j.texParameteri(t,j.TEXTURE_MIN_FILTER,w(e.minFilter))):(j.texParameteri(t,j.TEXTURE_WRAP_S,j.CLAMP_TO_EDGE),j.texParameteri(t,j.TEXTURE_WRAP_T,j.CLAMP_TO_EDGE),e.wrapS===THREE.ClampToEdgeWrapping&&e.wrapT===THREE.ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",e),j.texParameteri(t,j.TEXTURE_MAG_FILTER,M(e.magFilter)),j.texParameteri(t,j.TEXTURE_MIN_FILTER,M(e.minFilter)),e.minFilter!==THREE.NearestFilter&&e.minFilter!==THREE.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",e)),!(r=mt.get("EXT_texture_filter_anisotropic"))||e.type===THREE.FloatType&&null===mt.get("OES_texture_float_linear")||e.type===THREE.HalfFloatType&&null===mt.get("OES_texture_half_float_linear")||!(1<e.anisotropy||vt.get(e).__currentAnisotropy)||(j.texParameterf(t,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,W.getMaxAnisotropy())),vt.get(e).__currentAnisotropy=e.anisotropy);}function y(t,e){if(t.width>e||t.height>e){var r=e/Math.max(t.width,t.height),i=document.createElement("canvas");return i.width=Math.floor(t.width*r),i.height=Math.floor(t.height*r),i.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,i.width,i.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+i.width+"x"+i.height,t),i;}return t;}function R(t){return THREE.Math.isPowerOfTwo(t.width)&&THREE.Math.isPowerOfTwo(t.height);}function H(t,e){var r=vt.get(t);if(6===t.image.length)if(0<t.version&&r.__version!==t.version){r.__image__webglTextureCube||(t.addEventListener("dispose",o),r.__image__webglTextureCube=j.createTexture(),Et.textures++),Tt.activeTexture(j.TEXTURE0+e),Tt.bindTexture(j.TEXTURE_CUBE_MAP,r.__image__webglTextureCube),j.pixelStorei(j.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var i=t instanceof THREE.CompressedTexture,n=t.image[0]instanceof THREE.DataTexture,a=[],s=0;6>s;s++){a[s]=!W.autoScaleCubemaps||i||n?n?t.image[s].image:t.image[s]:y(t.image[s],gt.maxCubemapSize);}var h=R(a[0]),c=w(t.format),l=w(t.type);for(v(j.TEXTURE_CUBE_MAP,t,h),s=0;6>s;s++){if(i)for(var u,d=a[s].mipmaps,p=0,E=d.length;p<E;p++){u=d[p],t.format!==THREE.RGBAFormat&&t.format!==THREE.RGBFormat?-1<Tt.getCompressedTextureFormats().indexOf(c)?Tt.compressedTexImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+s,p,c,u.width,u.height,0,u.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):Tt.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+s,p,c,u.width,u.height,0,c,l,u.data);}else n?Tt.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,c,a[s].width,a[s].height,0,c,l,a[s].data):Tt.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,c,c,l,a[s]);}t.generateMipmaps&&h&&j.generateMipmap(j.TEXTURE_CUBE_MAP),r.__version=t.version,t.onUpdate&&t.onUpdate(t);}else Tt.activeTexture(j.TEXTURE0+e),Tt.bindTexture(j.TEXTURE_CUBE_MAP,r.__image__webglTextureCube);}function x(t,e){Tt.activeTexture(j.TEXTURE0+e),Tt.bindTexture(j.TEXTURE_CUBE_MAP,vt.get(t).__webglTexture);}function b(t,e,r,i){var n=w(e.texture.format),o=w(e.texture.type);Tt.texImage2D(i,0,n,e.width,e.height,0,n,o,null),j.bindFramebuffer(j.FRAMEBUFFER,t),j.framebufferTexture2D(j.FRAMEBUFFER,r,i,vt.get(e.texture).__webglTexture,0),j.bindFramebuffer(j.FRAMEBUFFER,null);}function _(t,e){j.bindRenderbuffer(j.RENDERBUFFER,t),e.depthBuffer&&!e.stencilBuffer?(j.renderbufferStorage(j.RENDERBUFFER,j.DEPTH_COMPONENT16,e.width,e.height),j.framebufferRenderbuffer(j.FRAMEBUFFER,j.DEPTH_ATTACHMENT,j.RENDERBUFFER,t)):e.depthBuffer&&e.stencilBuffer?(j.renderbufferStorage(j.RENDERBUFFER,j.DEPTH_STENCIL,e.width,e.height),j.framebufferRenderbuffer(j.FRAMEBUFFER,j.DEPTH_STENCIL_ATTACHMENT,j.RENDERBUFFER,t)):j.renderbufferStorage(j.RENDERBUFFER,j.RGBA4,e.width,e.height),j.bindRenderbuffer(j.RENDERBUFFER,null);}function M(t){return t===THREE.NearestFilter||t===THREE.NearestMipMapNearestFilter||t===THREE.NearestMipMapLinearFilter?j.NEAREST:j.LINEAR;}function w(t){var e;if(t===THREE.RepeatWrapping)return j.REPEAT;if(t===THREE.ClampToEdgeWrapping)return j.CLAMP_TO_EDGE;if(t===THREE.MirroredRepeatWrapping)return j.MIRRORED_REPEAT;if(t===THREE.NearestFilter)return j.NEAREST;if(t===THREE.NearestMipMapNearestFilter)return j.NEAREST_MIPMAP_NEAREST;if(t===THREE.NearestMipMapLinearFilter)return j.NEAREST_MIPMAP_LINEAR;if(t===THREE.LinearFilter)return j.LINEAR;if(t===THREE.LinearMipMapNearestFilter)return j.LINEAR_MIPMAP_NEAREST;if(t===THREE.LinearMipMapLinearFilter)return j.LINEAR_MIPMAP_LINEAR;if(t===THREE.UnsignedByteType)return j.UNSIGNED_BYTE;if(t===THREE.UnsignedShort4444Type)return j.UNSIGNED_SHORT_4_4_4_4;if(t===THREE.UnsignedShort5551Type)return j.UNSIGNED_SHORT_5_5_5_1;if(t===THREE.UnsignedShort565Type)return j.UNSIGNED_SHORT_5_6_5;if(t===THREE.ByteType)return j.BYTE;if(t===THREE.ShortType)return j.SHORT;if(t===THREE.UnsignedShortType)return j.UNSIGNED_SHORT;if(t===THREE.IntType)return j.INT;if(t===THREE.UnsignedIntType)return j.UNSIGNED_INT;if(t===THREE.FloatType)return j.FLOAT;if(null!==(e=mt.get("OES_texture_half_float"))&&t===THREE.HalfFloatType)return e.HALF_FLOAT_OES;if(t===THREE.AlphaFormat)return j.ALPHA;if(t===THREE.RGBFormat)return j.RGB;if(t===THREE.RGBAFormat)return j.RGBA;if(t===THREE.LuminanceFormat)return j.LUMINANCE;if(t===THREE.LuminanceAlphaFormat)return j.LUMINANCE_ALPHA;if(t===THREE.AddEquation)return j.FUNC_ADD;if(t===THREE.SubtractEquation)return j.FUNC_SUBTRACT;if(t===THREE.ReverseSubtractEquation)return j.FUNC_REVERSE_SUBTRACT;if(t===THREE.ZeroFactor)return j.ZERO;if(t===THREE.OneFactor)return j.ONE;if(t===THREE.SrcColorFactor)return j.SRC_COLOR;if(t===THREE.OneMinusSrcColorFactor)return j.ONE_MINUS_SRC_COLOR;if(t===THREE.SrcAlphaFactor)return j.SRC_ALPHA;if(t===THREE.OneMinusSrcAlphaFactor)return j.ONE_MINUS_SRC_ALPHA;if(t===THREE.DstAlphaFactor)return j.DST_ALPHA;if(t===THREE.OneMinusDstAlphaFactor)return j.ONE_MINUS_DST_ALPHA;if(t===THREE.DstColorFactor)return j.DST_COLOR;if(t===THREE.OneMinusDstColorFactor)return j.ONE_MINUS_DST_COLOR;if(t===THREE.SrcAlphaSaturateFactor)return j.SRC_ALPHA_SATURATE;if(null!==(e=mt.get("WEBGL_compressed_texture_s3tc"))){if(t===THREE.RGB_S3TC_DXT1_Format)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===THREE.RGBA_S3TC_DXT1_Format)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===THREE.RGBA_S3TC_DXT3_Format)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===THREE.RGBA_S3TC_DXT5_Format)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT;}if(null!==(e=mt.get("WEBGL_compressed_texture_pvrtc"))){if(t===THREE.RGB_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===THREE.RGB_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===THREE.RGBA_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===THREE.RGBA_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;}if(null!==(e=mt.get("WEBGL_compressed_texture_etc1"))&&t===THREE.RGB_ETC1_Format)return e.COMPRESSED_RGB_ETC1_WEBGL;if(null!==(e=mt.get("EXT_blend_minmax"))){if(t===THREE.MinEquation)return e.MIN_EXT;if(t===THREE.MaxEquation)return e.MAX_EXT;}return 0;}console.log("THREE.WebGLRenderer",THREE.REVISION);var S=void 0!==(t=t||{}).canvas?t.canvas:document.createElement("canvas"),C=void 0!==t.context?t.context:null,L=void 0!==t.alpha&&t.alpha,A=void 0===t.depth||t.depth,P=void 0===t.stencil||t.stencil,k=void 0!==t.antialias&&t.antialias,I=void 0===t.premultipliedAlpha||t.premultipliedAlpha,F=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,U=[],D=[],B=-1,V=[],N=-1,O=new Float32Array(8),z=[],G=[];this.domElement=S,this.context=null,this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.gammaFactor=2,this.gammaOutput=this.gammaInput=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0;var j,W=this,X=null,q=null,Y=null,Z=-1,Q="",K=null,J=new THREE.Vector4(),$=null,tt=new THREE.Vector4(),et=0,rt=new THREE.Color(0),it=0,nt=S.width,ot=S.height,at=1,st=new THREE.Vector4(0,0,nt,ot),ht=!1,ct=new THREE.Vector4(0,0,nt,ot),lt=new THREE.Frustum(),ut=new THREE.Matrix4(),dt=new THREE.Vector3(),pt={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[],shadowsPointLight:0},Et={geometries:0,textures:0},ft={calls:0,vertices:0,faces:0,points:0};this.info={render:ft,memory:Et,programs:null};try{if(L={alpha:L,depth:A,stencil:P,antialias:k,premultipliedAlpha:I,preserveDrawingBuffer:F},null===(j=C||S.getContext("webgl",L)||S.getContext("experimental-webgl",L))){if(null!==S.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";throw"Error creating WebGL context.";}S.addEventListener("webglcontextlost",n,!1);}catch(t){console.error("THREE.WebGLRenderer: "+t);}var mt=new THREE.WebGLExtensions(j);mt.get("OES_texture_float"),mt.get("OES_texture_float_linear"),mt.get("OES_texture_half_float"),mt.get("OES_texture_half_float_linear"),mt.get("OES_standard_derivatives"),mt.get("ANGLE_instanced_arrays"),mt.get("OES_element_index_uint")&&(THREE.BufferGeometry.MaxIndex=4294967296);var gt=new THREE.WebGLCapabilities(j,mt,t),Tt=new THREE.WebGLState(j,mt,w),vt=new THREE.WebGLProperties(),yt=new THREE.WebGLObjects(j,vt,this.info),Rt=new THREE.WebGLPrograms(this,gt),Ht=new THREE.WebGLLights();this.info.programs=Rt.programs;var xt=new THREE.WebGLBufferRenderer(j,mt,ft),bt=new THREE.WebGLIndexedBufferRenderer(j,mt,ft);r(),this.context=j,this.capabilities=gt,this.extensions=mt,this.properties=vt,this.state=Tt;var _t=new THREE.WebGLShadowMap(this,pt,yt);this.shadowMap=_t;var Mt=new THREE.SpritePlugin(this,z),wt=new THREE.LensFlarePlugin(this,G);this.getContext=function(){return j;},this.getContextAttributes=function(){return j.getContextAttributes();},this.forceContextLoss=function(){mt.get("WEBGL_lose_context").loseContext();},this.getMaxAnisotropy=function(){var t;return function(){if(void 0!==t)return t;var e=mt.get("EXT_texture_filter_anisotropic");return t=null!==e?j.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0;};}(),this.getPrecision=function(){return gt.precision;},this.getPixelRatio=function(){return at;},this.setPixelRatio=function(t){void 0!==t&&(at=t,this.setSize(ct.z,ct.w,!1));},this.getSize=function(){return{width:nt,height:ot};},this.setSize=function(t,e,r){nt=t,ot=e,S.width=t*at,S.height=e*at,!1!==r&&(S.style.width=t+"px",S.style.height=e+"px"),this.setViewport(0,0,t,e);},this.setViewport=function(t,e,r,i){Tt.viewport(ct.set(t,e,r,i));},this.setScissor=function(t,e,r,i){Tt.scissor(st.set(t,e,r,i));},this.setScissorTest=function(t){Tt.setScissorTest(ht=t);},this.getClearColor=function(){return rt;},this.setClearColor=function(t,r){rt.set(t),it=void 0!==r?r:1,e(rt.r,rt.g,rt.b,it);},this.getClearAlpha=function(){return it;},this.setClearAlpha=function(t){it=t,e(rt.r,rt.g,rt.b,it);},this.clear=function(t,e,r){var i=0;(void 0===t||t)&&(i|=j.COLOR_BUFFER_BIT),(void 0===e||e)&&(i|=j.DEPTH_BUFFER_BIT),(void 0===r||r)&&(i|=j.STENCIL_BUFFER_BIT),j.clear(i);},this.clearColor=function(){this.clear(!0,!1,!1);},this.clearDepth=function(){this.clear(!1,!0,!1);},this.clearStencil=function(){this.clear(!1,!1,!0);},this.clearTarget=function(t,e,r,i){this.setRenderTarget(t),this.clear(e,r,i);},this.resetGLState=i,this.dispose=function(){S.removeEventListener("webglcontextlost",n,!1);},this.renderBufferImmediate=function(t,e,r){Tt.initAttributes();var i=vt.get(t);if(t.hasPositions&&!i.position&&(i.position=j.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=j.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=j.createBuffer()),t.hasColors&&!i.color&&(i.color=j.createBuffer()),e=e.getAttributes(),t.hasPositions&&(j.bindBuffer(j.ARRAY_BUFFER,i.position),j.bufferData(j.ARRAY_BUFFER,t.positionArray,j.DYNAMIC_DRAW),Tt.enableAttribute(e.position),j.vertexAttribPointer(e.position,3,j.FLOAT,!1,0,0)),t.hasNormals){if(j.bindBuffer(j.ARRAY_BUFFER,i.normal),"MeshPhongMaterial"!==r.type&&"MeshStandardMaterial"!==r.type&&r.shading===THREE.FlatShading)for(var n=0,o=3*t.count;n<o;n+=9){var a=t.normalArray,s=(a[n+0]+a[n+3]+a[n+6])/3,h=(a[n+1]+a[n+4]+a[n+7])/3,c=(a[n+2]+a[n+5]+a[n+8])/3;a[n+0]=s,a[n+1]=h,a[n+2]=c,a[n+3]=s,a[n+4]=h,a[n+5]=c,a[n+6]=s,a[n+7]=h,a[n+8]=c;}j.bufferData(j.ARRAY_BUFFER,t.normalArray,j.DYNAMIC_DRAW),Tt.enableAttribute(e.normal),j.vertexAttribPointer(e.normal,3,j.FLOAT,!1,0,0);}t.hasUvs&&r.map&&(j.bindBuffer(j.ARRAY_BUFFER,i.uv),j.bufferData(j.ARRAY_BUFFER,t.uvArray,j.DYNAMIC_DRAW),Tt.enableAttribute(e.uv),j.vertexAttribPointer(e.uv,2,j.FLOAT,!1,0,0)),t.hasColors&&r.vertexColors!==THREE.NoColors&&(j.bindBuffer(j.ARRAY_BUFFER,i.color),j.bufferData(j.ARRAY_BUFFER,t.colorArray,j.DYNAMIC_DRAW),Tt.enableAttribute(e.color),j.vertexAttribPointer(e.color,3,j.FLOAT,!1,0,0)),Tt.disableUnusedAttributes(),j.drawArrays(j.TRIANGLES,0,t.count),t.count=0;},this.renderBufferDirect=function(t,e,r,i,n,o){f(i);var a=m(t,e,i,n),s=!1;if((t=r.id+"_"+a.id+"_"+i.wireframe)!==Q&&(Q=t,s=!0),void 0!==(e=n.morphTargetInfluences)){t=[];var h=0;for(s=e.length;h<s;h++){var l=e[h];t.push([l,h]);}t.sort(c),8<t.length&&(t.length=8);var u=r.morphAttributes;for(h=0,s=t.length;h<s;h++){l=t[h],O[h]=l[0],0!==l[0]?(e=l[1],!0===i.morphTargets&&u.position&&r.addAttribute("morphTarget"+h,u.position[e]),!0===i.morphNormals&&u.normal&&r.addAttribute("morphNormal"+h,u.normal[e])):(!0===i.morphTargets&&r.removeAttribute("morphTarget"+h),!0===i.morphNormals&&r.removeAttribute("morphNormal"+h));}null!==(t=a.getUniforms()).morphTargetInfluences&&j.uniform1fv(t.morphTargetInfluences,O),s=!0;}if(e=r.index,h=r.attributes.position,!0===i.wireframe&&(e=yt.getWireframeAttribute(r)),null!==e?(t=bt).setIndex(e):t=xt,s){var d;s=void 0;if(r instanceof THREE.InstancedBufferGeometry&&null===(d=mt.get("ANGLE_instanced_arrays")))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===s&&(s=0),Tt.initAttributes();var p;l=r.attributes,a=a.getAttributes(),u=i.defaultAttributeValues;for(p in a){var E=a[p];if(0<=E)if(void 0!==(R=l[p])){var g=R.itemSize,T=yt.getAttributeBuffer(R);if(R instanceof THREE.InterleavedBufferAttribute){var v=R.data,y=v.stride,R=R.offset;v instanceof THREE.InstancedInterleavedBuffer?(Tt.enableAttributeAndDivisor(E,v.meshPerAttribute,d),void 0===r.maxInstancedCount&&(r.maxInstancedCount=v.meshPerAttribute*v.count)):Tt.enableAttribute(E),j.bindBuffer(j.ARRAY_BUFFER,T),j.vertexAttribPointer(E,g,j.FLOAT,!1,y*v.array.BYTES_PER_ELEMENT,(s*y+R)*v.array.BYTES_PER_ELEMENT);}else R instanceof THREE.InstancedBufferAttribute?(Tt.enableAttributeAndDivisor(E,R.meshPerAttribute,d),void 0===r.maxInstancedCount&&(r.maxInstancedCount=R.meshPerAttribute*R.count)):Tt.enableAttribute(E),j.bindBuffer(j.ARRAY_BUFFER,T),j.vertexAttribPointer(E,g,j.FLOAT,!1,0,s*g*4);}else if(void 0!==u&&void 0!==(g=u[p]))switch(g.length){case 2:j.vertexAttrib2fv(E,g);break;case 3:j.vertexAttrib3fv(E,g);break;case 4:j.vertexAttrib4fv(E,g);break;default:j.vertexAttrib1fv(E,g);}}Tt.disableUnusedAttributes();}null!==e&&j.bindBuffer(j.ELEMENT_ARRAY_BUFFER,yt.getAttributeBuffer(e));}if(d=1/0,null!==e?d=e.count:void 0!==h&&(d=h.count),p=r.drawRange.start,e=r.drawRange.count,h=null!==o?o.start:0,s=null!==o?o.count:1/0,o=Math.max(0,p,h),d=Math.min(0+d,p+e,h+s)-1,d=Math.max(0,d-o+1),n instanceof THREE.Mesh){if(!0===i.wireframe)Tt.setLineWidth(i.wireframeLinewidth*(null===q?at:1)),t.setMode(j.LINES);else switch(n.drawMode){case THREE.TrianglesDrawMode:t.setMode(j.TRIANGLES);break;case THREE.TriangleStripDrawMode:t.setMode(j.TRIANGLE_STRIP);break;case THREE.TriangleFanDrawMode:t.setMode(j.TRIANGLE_FAN);}}else n instanceof THREE.Line?(void 0===(i=i.linewidth)&&(i=1),Tt.setLineWidth(i*(null===q?at:1)),n instanceof THREE.LineSegments?t.setMode(j.LINES):t.setMode(j.LINE_STRIP)):n instanceof THREE.Points&&t.setMode(j.POINTS);r instanceof THREE.InstancedBufferGeometry&&0<r.maxInstancedCount?t.renderInstances(r,o,d):t.render(o,d);},this.render=function(t,e,r,i){if(!1==e instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var n=t.fog;Q="",Z=-1,K=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),ut.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),lt.setFromMatrix(ut),U.length=0,N=B=-1,z.length=0,G.length=0,p(t,e),D.length=B+1,V.length=N+1,!0===W.sortObjects&&(D.sort(l),V.sort(u));var o,a,s,h,c,d,f=U,m=0,g=0,T=0,v=e.matrixWorldInverse,y=0,H=0,x=0,b=0,_=0;for(o=pt.shadowsPointLight=0,a=f.length;o<a;o++){if(h=(s=f[o]).color,c=s.intensity,d=s.distance,s instanceof THREE.AmbientLight)m+=h.r*c,g+=h.g*c,T+=h.b*c;else if(s instanceof THREE.DirectionalLight){var M=Ht.get(s);M.color.copy(s.color).multiplyScalar(s.intensity),M.direction.setFromMatrixPosition(s.matrixWorld),dt.setFromMatrixPosition(s.target.matrixWorld),M.direction.sub(dt),M.direction.transformDirection(v),(M.shadow=s.castShadow)&&(M.shadowBias=s.shadow.bias,M.shadowRadius=s.shadow.radius,M.shadowMapSize=s.shadow.mapSize,pt.shadows[_++]=s),pt.directionalShadowMap[y]=s.shadow.map,pt.directionalShadowMatrix[y]=s.shadow.matrix,pt.directional[y++]=M;}else s instanceof THREE.SpotLight?((M=Ht.get(s)).position.setFromMatrixPosition(s.matrixWorld),M.position.applyMatrix4(v),M.color.copy(h).multiplyScalar(c),M.distance=d,M.direction.setFromMatrixPosition(s.matrixWorld),dt.setFromMatrixPosition(s.target.matrixWorld),M.direction.sub(dt),M.direction.transformDirection(v),M.angleCos=Math.cos(s.angle),M.penumbra=Math.cos(s.angle)*s.penumbra,M.decay=0===s.distance?0:s.decay,(M.shadow=s.castShadow)&&(M.shadowBias=s.shadow.bias,M.shadowRadius=s.shadow.radius,M.shadowMapSize=s.shadow.mapSize,pt.shadows[_++]=s),pt.spotShadowMap[x]=s.shadow.map,pt.spotShadowMatrix[x]=s.shadow.matrix,pt.spot[x++]=M):s instanceof THREE.PointLight?((M=Ht.get(s)).position.setFromMatrixPosition(s.matrixWorld),M.position.applyMatrix4(v),M.color.copy(s.color).multiplyScalar(s.intensity),M.distance=s.distance,M.decay=0===s.distance?0:s.decay,(M.shadow=s.castShadow)&&(M.shadowBias=s.shadow.bias,M.shadowRadius=s.shadow.radius,M.shadowMapSize=s.shadow.mapSize,pt.shadows[_++]=s),pt.pointShadowMap[H]=s.shadow.map,void 0===pt.pointShadowMatrix[H]&&(pt.pointShadowMatrix[H]=new THREE.Matrix4()),dt.setFromMatrixPosition(s.matrixWorld).negate(),pt.pointShadowMatrix[H].identity().setPosition(dt),pt.point[H++]=M):s instanceof THREE.HemisphereLight&&((M=Ht.get(s)).direction.setFromMatrixPosition(s.matrixWorld),M.direction.transformDirection(v),M.direction.normalize(),M.skyColor.copy(s.color).multiplyScalar(c),M.groundColor.copy(s.groundColor).multiplyScalar(c),pt.hemi[b++]=M);}pt.ambient[0]=m,pt.ambient[1]=g,pt.ambient[2]=T,pt.directional.length=y,pt.spot.length=x,pt.point.length=H,pt.hemi.length=b,pt.shadows.length=_,pt.hash=y+","+H+","+x+","+b+","+_,_t.render(t,e),ft.calls=0,ft.vertices=0,ft.faces=0,ft.points=0,void 0===r&&(r=null),this.setRenderTarget(r),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),t.overrideMaterial?(i=t.overrideMaterial,E(D,e,n,i),E(V,e,n,i)):(Tt.setBlending(THREE.NoBlending),E(D,e,n),E(V,e,n)),Mt.render(t,e),wt.render(t,e,tt),r&&(t=r.texture).generateMipmaps&&R(r)&&t.minFilter!==THREE.NearestFilter&&t.minFilter!==THREE.LinearFilter&&(t=r instanceof THREE.WebGLRenderTargetCube?j.TEXTURE_CUBE_MAP:j.TEXTURE_2D,r=vt.get(r.texture).__webglTexture,Tt.bindTexture(t,r),j.generateMipmap(t),Tt.bindTexture(t,null)),Tt.setDepthTest(!0),Tt.setDepthWrite(!0),Tt.setColorWrite(!0);}},this.setFaceCulling=function(t,e){t===THREE.CullFaceNone?Tt.disable(j.CULL_FACE):(e===THREE.FrontFaceDirectionCW?j.frontFace(j.CW):j.frontFace(j.CCW),t===THREE.CullFaceBack?j.cullFace(j.BACK):t===THREE.CullFaceFront?j.cullFace(j.FRONT):j.cullFace(j.FRONT_AND_BACK),Tt.enable(j.CULL_FACE));},this.setTexture=function(t,e){var r=vt.get(t);if(0<t.version&&r.__version!==t.version){if(void 0===(n=t.image))console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t);else if(!1===n.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t);else{void 0===r.__webglInit&&(r.__webglInit=!0,t.addEventListener("dispose",o),r.__webglTexture=j.createTexture(),Et.textures++),Tt.activeTexture(j.TEXTURE0+e),Tt.bindTexture(j.TEXTURE_2D,r.__webglTexture),j.pixelStorei(j.UNPACK_FLIP_Y_WEBGL,t.flipY),j.pixelStorei(j.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),j.pixelStorei(j.UNPACK_ALIGNMENT,t.unpackAlignment);var i=y(t.image,gt.maxTextureSize);if((t.wrapS!==THREE.ClampToEdgeWrapping||t.wrapT!==THREE.ClampToEdgeWrapping||t.minFilter!==THREE.NearestFilter&&t.minFilter!==THREE.LinearFilter)&&!1===R(i))if((n=i)instanceof HTMLImageElement||n instanceof HTMLCanvasElement){(a=document.createElement("canvas")).width=THREE.Math.nearestPowerOfTwo(n.width),a.height=THREE.Math.nearestPowerOfTwo(n.height),a.getContext("2d").drawImage(n,0,0,a.width,a.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+n.width+"x"+n.height+"). Resized to "+a.width+"x"+a.height,n),i=a;}else i=n;var n=R(i),a=w(t.format),s=w(t.type);v(j.TEXTURE_2D,t,n);var h=t.mipmaps;if(t instanceof THREE.DataTexture){if(0<h.length&&n){for(var c=0,l=h.length;c<l;c++){i=h[c],Tt.texImage2D(j.TEXTURE_2D,c,a,i.width,i.height,0,a,s,i.data);}t.generateMipmaps=!1;}else Tt.texImage2D(j.TEXTURE_2D,0,a,i.width,i.height,0,a,s,i.data);}else if(t instanceof THREE.CompressedTexture)for(c=0,l=h.length;c<l;c++){i=h[c],t.format!==THREE.RGBAFormat&&t.format!==THREE.RGBFormat?-1<Tt.getCompressedTextureFormats().indexOf(a)?Tt.compressedTexImage2D(j.TEXTURE_2D,c,a,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Tt.texImage2D(j.TEXTURE_2D,c,a,i.width,i.height,0,a,s,i.data);}else if(0<h.length&&n){for(c=0,l=h.length;c<l;c++){i=h[c],Tt.texImage2D(j.TEXTURE_2D,c,a,a,s,i);}t.generateMipmaps=!1;}else Tt.texImage2D(j.TEXTURE_2D,0,a,a,s,i);t.generateMipmaps&&n&&j.generateMipmap(j.TEXTURE_2D),r.__version=t.version,t.onUpdate&&t.onUpdate(t);}}else Tt.activeTexture(j.TEXTURE0+e),Tt.bindTexture(j.TEXTURE_2D,r.__webglTexture);},this.setRenderTarget=function(t){if((q=t)&&void 0===vt.get(t).__webglFramebuffer){var e=vt.get(t),r=vt.get(t.texture);t.addEventListener("dispose",a),r.__webglTexture=j.createTexture(),Et.textures++;var i=t instanceof THREE.WebGLRenderTargetCube,n=THREE.Math.isPowerOfTwo(t.width)&&THREE.Math.isPowerOfTwo(t.height);if(i){e.__webglFramebuffer=[];for(var o=0;6>o;o++){e.__webglFramebuffer[o]=j.createFramebuffer();}}else e.__webglFramebuffer=j.createFramebuffer();if(i){for(Tt.bindTexture(j.TEXTURE_CUBE_MAP,r.__webglTexture),v(j.TEXTURE_CUBE_MAP,t.texture,n),o=0;6>o;o++){b(e.__webglFramebuffer[o],t,j.COLOR_ATTACHMENT0,j.TEXTURE_CUBE_MAP_POSITIVE_X+o);}t.texture.generateMipmaps&&n&&j.generateMipmap(j.TEXTURE_CUBE_MAP),Tt.bindTexture(j.TEXTURE_CUBE_MAP,null);}else Tt.bindTexture(j.TEXTURE_2D,r.__webglTexture),v(j.TEXTURE_2D,t.texture,n),b(e.__webglFramebuffer,t,j.COLOR_ATTACHMENT0,j.TEXTURE_2D),t.texture.generateMipmaps&&n&&j.generateMipmap(j.TEXTURE_2D),Tt.bindTexture(j.TEXTURE_2D,null);if(t.depthBuffer){if(e=vt.get(t),t instanceof THREE.WebGLRenderTargetCube)for(e.__webglDepthbuffer=[],r=0;6>r;r++){j.bindFramebuffer(j.FRAMEBUFFER,e.__webglFramebuffer[r]),e.__webglDepthbuffer[r]=j.createRenderbuffer(),_(e.__webglDepthbuffer[r],t);}else j.bindFramebuffer(j.FRAMEBUFFER,e.__webglFramebuffer),e.__webglDepthbuffer=j.createRenderbuffer(),_(e.__webglDepthbuffer,t);j.bindFramebuffer(j.FRAMEBUFFER,null);}}e=t instanceof THREE.WebGLRenderTargetCube,t?(r=vt.get(t),r=e?r.__webglFramebuffer[t.activeCubeFace]:r.__webglFramebuffer,J.copy(t.scissor),$=t.scissorTest,tt.copy(t.viewport)):(r=null,J.copy(st).multiplyScalar(at),$=ht,tt.copy(ct).multiplyScalar(at)),Y!==r&&(j.bindFramebuffer(j.FRAMEBUFFER,r),Y=r),Tt.scissor(J),Tt.setScissorTest($),Tt.viewport(tt),e&&(e=vt.get(t.texture),j.framebufferTexture2D(j.FRAMEBUFFER,j.COLOR_ATTACHMENT0,j.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,e.__webglTexture,0));},this.readRenderTargetPixels=function(t,e,r,i,n,o){if(!1==t instanceof THREE.WebGLRenderTarget)console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");else{var a=vt.get(t).__webglFramebuffer;if(a){var s=!1;a!==Y&&(j.bindFramebuffer(j.FRAMEBUFFER,a),s=!0);try{var h=t.texture;h.format!==THREE.RGBAFormat&&w(h.format)!==j.getParameter(j.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):h.type===THREE.UnsignedByteType||w(h.type)===j.getParameter(j.IMPLEMENTATION_COLOR_READ_TYPE)||h.type===THREE.FloatType&&mt.get("WEBGL_color_buffer_float")||h.type===THREE.HalfFloatType&&mt.get("EXT_color_buffer_half_float")?j.checkFramebufferStatus(j.FRAMEBUFFER)===j.FRAMEBUFFER_COMPLETE?j.readPixels(e,r,i,n,w(h.format),w(h.type),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");}finally{s&&j.bindFramebuffer(j.FRAMEBUFFER,Y);}}}};},THREE.WebGLRenderTarget=function(t,e,r){this.uuid=THREE.Math.generateUUID(),this.width=t,this.height=e,this.scissor=new THREE.Vector4(0,0,t,e),this.scissorTest=!1,this.viewport=new THREE.Vector4(0,0,t,e),void 0===(r=r||{}).minFilter&&(r.minFilter=THREE.LinearFilter),this.texture=new THREE.Texture(void 0,void 0,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy),this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer;},THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,setSize:function setSize(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e);},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.shareDepthFrom=t.shareDepthFrom,this;},dispose:function dispose(){this.dispatchEvent({type:"dispose"});}},THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube=function(t,e,r){THREE.WebGLRenderTarget.call(this,t,e,r),this.activeCubeFace=0;},THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube,THREE.WebGLBufferRenderer=function(t,e,r){var i;this.setMode=function(t){i=t;},this.render=function(e,n){t.drawArrays(i,e,n),r.calls++,r.vertices+=n,i===t.TRIANGLES&&(r.faces+=n/3);},this.renderInstances=function(n){var o=e.get("ANGLE_instanced_arrays");if(null===o)console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{var a=n.attributes.position,s=a instanceof THREE.InterleavedBufferAttribute?a.data.count:a.count;o.drawArraysInstancedANGLE(i,0,s,n.maxInstancedCount),r.calls++,r.vertices+=s*n.maxInstancedCount,i===t.TRIANGLES&&(r.faces+=n.maxInstancedCount*s/3);}};},THREE.WebGLIndexedBufferRenderer=function(t,e,r){var i,n,o;this.setMode=function(t){i=t;},this.setIndex=function(r){r.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(n=t.UNSIGNED_INT,o=4):(n=t.UNSIGNED_SHORT,o=2);},this.render=function(e,a){t.drawElements(i,a,n,e*o),r.calls++,r.vertices+=a,i===t.TRIANGLES&&(r.faces+=a/3);},this.renderInstances=function(a,s,h){var c=e.get("ANGLE_instanced_arrays");null===c?console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(c.drawElementsInstancedANGLE(i,h,n,s*o,a.maxInstancedCount),r.calls++,r.vertices+=h*a.maxInstancedCount,i===t.TRIANGLES&&(r.faces+=a.maxInstancedCount*h/3));};},THREE.WebGLExtensions=function(t){var e={};this.get=function(r){if(void 0!==e[r])return e[r];var i;switch(r){case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":i=t.getExtension("WEBGL_compressed_texture_etc1");break;default:i=t.getExtension(r);}return null===i&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),e[r]=i;};},THREE.WebGLCapabilities=function(t,e,r){function i(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision)return"highp";e="mediump";}return"mediump"===e&&0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision?"mediump":"lowp";}this.getMaxPrecision=i,this.precision=void 0!==r.precision?r.precision:"highp",this.logarithmicDepthBuffer=void 0!==r.logarithmicDepthBuffer&&r.logarithmicDepthBuffer,this.maxTextures=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxCubemapSize=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxAttributes=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.maxVertexUniforms=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),this.maxVaryings=t.getParameter(t.MAX_VARYING_VECTORS),this.maxFragmentUniforms=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),this.vertexTextures=0<this.maxVertexTextures,this.floatFragmentTextures=!!e.get("OES_texture_float"),this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures,(r=i(this.precision))!==this.precision&&(console.warn("THREE.WebGLRenderer:",this.precision,"not supported, using",r,"instead."),this.precision=r),this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!e.get("EXT_frag_depth"));},THREE.WebGLGeometries=function(t,e,r){function i(t){var a=t.target;null!==(t=o[a.id]).index&&n(t.index);var s,h=t.attributes;for(s in h){n(h[s]);}a.removeEventListener("dispose",i),delete o[a.id],(s=e.get(a)).wireframe&&n(s.wireframe),e.delete(a),(a=e.get(t)).wireframe&&n(a.wireframe),e.delete(t),r.memory.geometries--;}function n(r){var i;void 0!==(i=r instanceof THREE.InterleavedBufferAttribute?e.get(r.data).__webglBuffer:e.get(r).__webglBuffer)&&(t.deleteBuffer(i),r instanceof THREE.InterleavedBufferAttribute?e.delete(r.data):e.delete(r));}var o={};this.get=function(t){var e,n=t.geometry;return void 0!==o[n.id]?o[n.id]:(n.addEventListener("dispose",i),n instanceof THREE.BufferGeometry?e=n:n instanceof THREE.Geometry&&(void 0===n._bufferGeometry&&(n._bufferGeometry=new THREE.BufferGeometry().setFromObject(t)),e=n._bufferGeometry),o[n.id]=e,r.memory.geometries++,e);};},THREE.WebGLLights=function(){var t={};this.get=function(e){if(void 0!==t[e.id])return t[e.id];var r;switch(e.type){case"DirectionalLight":r={direction:new THREE.Vector3(),color:new THREE.Color(),shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2()};break;case"SpotLight":r={position:new THREE.Vector3(),direction:new THREE.Vector3(),color:new THREE.Color(),distance:0,angleCos:0,penumbra:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2()};break;case"PointLight":r={position:new THREE.Vector3(),color:new THREE.Color(),distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2()};break;case"HemisphereLight":r={direction:new THREE.Vector3(),skyColor:new THREE.Color(),groundColor:new THREE.Color()};}return t[e.id]=r;};},THREE.WebGLObjects=function(t,e,r){function i(r,i){var n=r instanceof THREE.InterleavedBufferAttribute?r.data:r,o=e.get(n);void 0===o.__webglBuffer?(o.__webglBuffer=t.createBuffer(),t.bindBuffer(i,o.__webglBuffer),t.bufferData(i,n.array,n.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW),o.version=n.version):o.version!==n.version&&(t.bindBuffer(i,o.__webglBuffer),!1===n.dynamic||-1===n.updateRange.count?t.bufferSubData(i,0,n.array):0===n.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(i,n.updateRange.offset*n.array.BYTES_PER_ELEMENT,n.array.subarray(n.updateRange.offset,n.updateRange.offset+n.updateRange.count)),n.updateRange.count=0),o.version=n.version);}function n(t,e,r){if(e>r){var i=e;e=r,r=i;}return void 0===(i=t[e])?(t[e]=[r],!0):-1===i.indexOf(r)&&(i.push(r),!0);}var o=new THREE.WebGLGeometries(t,e,r);this.getAttributeBuffer=function(t){return t instanceof THREE.InterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer;},this.getWireframeAttribute=function(r){var o=e.get(r);if(void 0!==o.wireframe)return o.wireframe;var a=[],s=r.index;if(r=(h=r.attributes).position,null!==s)for(var h={},c=0,l=(s=s.array).length;c<l;c+=3){var u=s[c+0],d=s[c+1],p=s[c+2];n(h,u,d)&&a.push(u,d),n(h,d,p)&&a.push(d,p),n(h,p,u)&&a.push(p,u);}else for(c=0,l=(s=h.position.array).length/3-1;c<l;c+=3){u=c+0,d=c+1,p=c+2,a.push(u,d,d,p,p,u);}return i(a=new THREE.BufferAttribute(new(65535<r.count?Uint32Array:Uint16Array)(a),1),t.ELEMENT_ARRAY_BUFFER),o.wireframe=a;},this.update=function(e){var r=o.get(e);e.geometry instanceof THREE.Geometry&&r.updateFromObject(e),e=r.index;var n=r.attributes;for(var a in null!==e&&i(e,t.ELEMENT_ARRAY_BUFFER),n){i(n[a],t.ARRAY_BUFFER);}for(a in e=r.morphAttributes){for(var s=0,h=(n=e[a]).length;s<h;s++){i(n[s],t.ARRAY_BUFFER);}}return r;};},THREE.WebGLProgram=function(){function t(t){return""!==t;}function e(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights);}function r(t){return t.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,r,i){for(t="",e=parseInt(e);e<parseInt(r);e++){t+=i.replace(/\[ i \]/g,"[ "+e+" ]");}return t;});}var i=0,n=/^([\w\d_]+)\.([\w\d_]+)$/,o=/^([\w\d_]+)\[(\d+)\]\.([\w\d_]+)$/,a=/^([\w\d_]+)\[0\]$/;return function(s,h,c,l){var u=s.context,d=c.extensions,p=c.defines,E=c.__webglShader.vertexShader,f=c.__webglShader.fragmentShader,m="SHADOWMAP_TYPE_BASIC";l.shadowMapType===THREE.PCFShadowMap?m="SHADOWMAP_TYPE_PCF":l.shadowMapType===THREE.PCFSoftShadowMap&&(m="SHADOWMAP_TYPE_PCF_SOFT");var g="ENVMAP_TYPE_CUBE",T="ENVMAP_MODE_REFLECTION",v="ENVMAP_BLENDING_MULTIPLY";if(l.envMap){switch(c.envMap.mapping){case THREE.CubeReflectionMapping:case THREE.CubeRefractionMapping:g="ENVMAP_TYPE_CUBE";break;case THREE.EquirectangularReflectionMapping:case THREE.EquirectangularRefractionMapping:g="ENVMAP_TYPE_EQUIREC";break;case THREE.SphericalReflectionMapping:g="ENVMAP_TYPE_SPHERE";}switch(c.envMap.mapping){case THREE.CubeRefractionMapping:case THREE.EquirectangularRefractionMapping:T="ENVMAP_MODE_REFRACTION";}switch(c.combine){case THREE.MultiplyOperation:v="ENVMAP_BLENDING_MULTIPLY";break;case THREE.MixOperation:v="ENVMAP_BLENDING_MIX";break;case THREE.AddOperation:v="ENVMAP_BLENDING_ADD";}}var y,R,H=0<s.gammaFactor?s.gammaFactor:1,x=(d=function(e,r,i){return[(e=e||{}).derivatives||r.bumpMap||r.normalMap||r.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||r.logarithmicDepthBuffer)&&i.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&i.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||r.envMap)&&i.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(t).join("\n");}(d,l,s.extensions),function(t){var e,r=[];for(e in t){var i=t[e];!1!==i&&r.push("#define "+e+" "+i);}return r.join("\n");}(p)),b=u.createProgram();return c instanceof THREE.RawShaderMaterial?s=p="":(p=["precision "+l.precision+" float;","precision "+l.precision+" int;","#define SHADER_NAME "+c.__webglShader.name,x,l.supportsVertexTextures?"#define VERTEX_TEXTURES":"",s.gammaInput?"#define GAMMA_INPUT":"",s.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+H,"#define MAX_BONES "+l.maxBones,l.map?"#define USE_MAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+T:"",l.lightMap?"#define USE_LIGHTMAP":"",l.aoMap?"#define USE_AOMAP":"",l.emissiveMap?"#define USE_EMISSIVEMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.displacementMap&&l.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.roughnessMap?"#define USE_ROUGHNESSMAP":"",l.metalnessMap?"#define USE_METALNESSMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.vertexColors?"#define USE_COLOR":"",l.flatShading?"#define FLAT_SHADED":"",l.skinning?"#define USE_SKINNING":"",l.useVertexTexture?"#define BONE_TEXTURE":"",l.morphTargets?"#define USE_MORPHTARGETS":"",l.morphNormals&&!1===l.flatShading?"#define USE_MORPHNORMALS":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+m:"",0<l.pointLightShadows?"#define POINT_LIGHT_SHADOWS":"",l.sizeAttenuation?"#define USE_SIZEATTENUATION":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",l.logarithmicDepthBuffer&&s.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(t).join("\n"),s=[d,"precision "+l.precision+" float;","precision "+l.precision+" int;","#define SHADER_NAME "+c.__webglShader.name,x,l.alphaTest?"#define ALPHATEST "+l.alphaTest:"",s.gammaInput?"#define GAMMA_INPUT":"",s.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+H,l.useFog&&l.fog?"#define USE_FOG":"",l.useFog&&l.fogExp?"#define FOG_EXP2":"",l.map?"#define USE_MAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+g:"",l.envMap?"#define "+T:"",l.envMap?"#define "+v:"",l.lightMap?"#define USE_LIGHTMAP":"",l.aoMap?"#define USE_AOMAP":"",l.emissiveMap?"#define USE_EMISSIVEMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.roughnessMap?"#define USE_ROUGHNESSMAP":"",l.metalnessMap?"#define USE_METALNESSMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.vertexColors?"#define USE_COLOR":"",l.flatShading?"#define FLAT_SHADED":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+m:"",0<l.pointLightShadows?"#define POINT_LIGHT_SHADOWS":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",l.logarithmicDepthBuffer&&s.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",l.envMap&&s.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","\n"].filter(t).join("\n")),E=e(E,l),f=e(f,l),!1==c instanceof THREE.ShaderMaterial&&(E=r(E),f=r(f)),f=s+f,E=THREE.WebGLShader(u,u.VERTEX_SHADER,p+E),f=THREE.WebGLShader(u,u.FRAGMENT_SHADER,f),u.attachShader(b,E),u.attachShader(b,f),void 0!==c.index0AttributeName?u.bindAttribLocation(b,0,c.index0AttributeName):!0===l.morphTargets&&u.bindAttribLocation(b,0,"position"),u.linkProgram(b),l=u.getProgramInfoLog(b),m=u.getShaderInfoLog(E),g=u.getShaderInfoLog(f),v=T=!0,!1===u.getProgramParameter(b,u.LINK_STATUS)?(T=!1,console.error("THREE.WebGLProgram: shader error: ",u.getError(),"gl.VALIDATE_STATUS",u.getProgramParameter(b,u.VALIDATE_STATUS),"gl.getProgramInfoLog",l,m,g)):""!==l?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",l):""!==m&&""!==g||(v=!1),v&&(this.diagnostics={runnable:T,material:c,programLog:l,vertexShader:{log:m,prefix:p},fragmentShader:{log:g,prefix:s}}),u.deleteShader(E),u.deleteShader(f),this.getUniforms=function(){if(void 0===y){for(var t={},e=u.getProgramParameter(b,u.ACTIVE_UNIFORMS),r=0;r<e;r++){var i=u.getActiveUniform(b,r).name,s=u.getUniformLocation(b,i);if(h=n.exec(i)){i=h[1];var h=h[2];(c=t[i])||(c=t[i]={}),c[h]=s;}else if(h=o.exec(i)){var c=h[1],l=(i=h[2],h=h[3],t[c]);l||(l=t[c]=[]),(c=l[i])||(c=l[i]={}),c[h]=s;}else(h=a.exec(i))?t[c=h[1]]=s:t[i]=s;}y=t;}return y;},this.getAttributes=function(){if(void 0===R){for(var t={},e=u.getProgramParameter(b,u.ACTIVE_ATTRIBUTES),r=0;r<e;r++){var i=u.getActiveAttrib(b,r).name;t[i]=u.getAttribLocation(b,i);}R=t;}return R;},this.destroy=function(){u.deleteProgram(b),this.program=void 0;},Object.defineProperties(this,{uniforms:{get:function get(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms();}},attributes:{get:function get(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes();}}}),this.id=i++,this.code=h,this.usedTimes=1,this.program=b,this.vertexShader=E,this.fragmentShader=f,this;};}(),THREE.WebGLPrograms=function(t,e){var r=[],i={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"standard",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},n="precision supportsVertexTextures map envMap envMapMode lightMap aoMap emissiveMap bumpMap normalMap displacementMap specularMap roughnessMap metalnessMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals numDirLights numPointLights numSpotLights numHemiLights shadowMapEnabled pointLightShadows shadowMapType alphaTest doubleSided flipSided".split(" ");this.getParameters=function(r,n,o,a){var s,h=i[r.type];e.floatVertexTextures&&a&&a.skeleton&&a.skeleton.useVertexTexture?s=1024:(s=Math.floor((e.maxVertexUniforms-20)/4),void 0!==a&&a instanceof THREE.SkinnedMesh&&(s=Math.min(a.skeleton.bones.length,s))<a.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+a.skeleton.bones.length+", this GPU supports just "+s+" (try OpenGL instead of ANGLE)"));var c=t.getPrecision();return null!==r.precision&&(c=e.getMaxPrecision(r.precision))!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",c,"instead."),{shaderID:h,precision:c,supportsVertexTextures:e.vertexTextures,map:!!r.map,envMap:!!r.envMap,envMapMode:r.envMap&&r.envMap.mapping,lightMap:!!r.lightMap,aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,combine:r.combine,vertexColors:r.vertexColors,fog:o,useFog:r.fog,fogExp:o instanceof THREE.FogExp2,flatShading:r.shading===THREE.FlatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:e.logarithmicDepthBuffer,skinning:r.skinning,maxBones:s,useVertexTexture:e.floatVertexTextures&&a&&a.skeleton&&a.skeleton.useVertexTexture,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:n.directional.length,numPointLights:n.point.length,numSpotLights:n.spot.length,numHemiLights:n.hemi.length,pointLightShadows:n.shadowsPointLight,shadowMapEnabled:t.shadowMap.enabled&&a.receiveShadow&&0<n.shadows.length,shadowMapType:t.shadowMap.type,alphaTest:r.alphaTest,doubleSided:r.side===THREE.DoubleSide,flipSided:r.side===THREE.BackSide};},this.getProgramCode=function(t,e){var r=[];if(e.shaderID?r.push(e.shaderID):(r.push(t.fragmentShader),r.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines){r.push(i),r.push(t.defines[i]);}for(i=0;i<n.length;i++){var o=n[i];r.push(o),r.push(e[o]);}return r.join();},this.acquireProgram=function(e,i,n){for(var o,a=0,s=r.length;a<s;a++){var h=r[a];if(h.code===n){++(o=h).usedTimes;break;}}return void 0===o&&(o=new THREE.WebGLProgram(t,n,e,i),r.push(o)),o;},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy();}},this.programs=r;},THREE.WebGLProperties=function(){var t={};this.get=function(e){e=e.uuid;var r=t[e];return void 0===r&&(r={},t[e]=r),r;},this.delete=function(e){delete t[e.uuid];},this.clear=function(){t={};};},THREE.WebGLShader=function(){return function(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),!1===t.getShaderParameter(i,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(i),function(t){t=t.split("\n");for(var e=0;e<t.length;e++){t[e]=e+1+": "+t[e];}return t.join("\n");}(r)),i;};}(),THREE.WebGLShadowMap=function(t,e,r){function i(t,e,r,i){var n=t.geometry,o=null,a=(o=p,t.customDepthMaterial);return r&&(o=E,a=t.customDistanceMaterial),a?o=a:(t=t instanceof THREE.SkinnedMesh&&e.skinning,a=0,void 0!==n.morphTargets&&0<n.morphTargets.length&&e.morphTargets&&(a|=1),t&&(a|=2),o=o[a]),o.visible=e.visible,o.wireframe=e.wireframe,o.wireframeLinewidth=e.wireframeLinewidth,r&&void 0!==o.uniforms.lightPos&&o.uniforms.lightPos.value.copy(i),o;}function n(t,e,r){if(!1!==t.visible){t.layers.test(e.layers)&&(t instanceof THREE.Mesh||t instanceof THREE.Line||t instanceof THREE.Points)&&t.castShadow&&(!1===t.frustumCulled||!0===s.intersectsObject(t))&&!0===t.material.visible&&(t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),d.push(t));for(var i=0,o=(t=t.children).length;i<o;i++){n(t[i],e,r);}}}for(var o=t.context,a=t.state,s=new THREE.Frustum(),h=new THREE.Matrix4(),c=new THREE.Vector2(),l=new THREE.Vector3(),u=new THREE.Vector3(),d=[],p=Array(4),E=Array(4),f=[new THREE.Vector3(1,0,0),new THREE.Vector3(-1,0,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,-1),new THREE.Vector3(0,1,0),new THREE.Vector3(0,-1,0)],m=[new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,-1)],g=[new THREE.Vector4(),new THREE.Vector4(),new THREE.Vector4(),new THREE.Vector4(),new THREE.Vector4(),new THREE.Vector4()],T=THREE.ShaderLib.depthRGBA,v=THREE.UniformsUtils.clone(T.uniforms),y=THREE.ShaderLib.distanceRGBA,R=THREE.UniformsUtils.clone(y.uniforms),H=0;4!==H;++H){var x=0!=(1&H),b=0!=(2&H),_=new THREE.ShaderMaterial({uniforms:v,vertexShader:T.vertexShader,fragmentShader:T.fragmentShader,morphTargets:x,skinning:b});_._shadowPass=!0,p[H]=_,(x=new THREE.ShaderMaterial({uniforms:R,vertexShader:y.vertexShader,fragmentShader:y.fragmentShader,morphTargets:x,skinning:b}))._shadowPass=!0,E[H]=x;}var M=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=THREE.PCFShadowMap,this.cullFace=THREE.CullFaceFront,this.render=function(p,E){var T,v;if(!1!==M.enabled&&(!1!==M.autoUpdate||!1!==M.needsUpdate)){a.clearColor(1,1,1,1),a.disable(o.BLEND),a.enable(o.CULL_FACE),o.frontFace(o.CCW),o.cullFace(M.cullFace===THREE.CullFaceFront?o.FRONT:o.BACK),a.setDepthTest(!0),a.setScissorTest(!1);for(var y=e.shadows,R=0,H=y.length;R<H;R++){var x=y[R],b=x.shadow,_=b.camera;if(c.copy(b.mapSize),x instanceof THREE.PointLight){T=6,v=!0;var w=c.x,S=c.y;g[0].set(2*w,S,w,S),g[1].set(0,S,w,S),g[2].set(3*w,S,w,S),g[3].set(w,S,w,S),g[4].set(3*w,0,w,S),g[5].set(w,0,w,S),c.x*=4,c.y*=2;}else T=1,v=!1;for(null===b.map&&(b.map=new THREE.WebGLRenderTarget(c.x,c.y,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat}),x instanceof THREE.SpotLight&&(_.aspect=c.x/c.y),_.updateProjectionMatrix()),w=b.map,b=b.matrix,u.setFromMatrixPosition(x.matrixWorld),_.position.copy(u),t.setRenderTarget(w),t.clear(),w=0;w<T;w++){v?(l.copy(_.position),l.add(f[w]),_.up.copy(m[w]),_.lookAt(l),a.viewport(g[w])):(l.setFromMatrixPosition(x.target.matrixWorld),_.lookAt(l)),_.updateMatrixWorld(),_.matrixWorldInverse.getInverse(_.matrixWorld),b.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),b.multiply(_.projectionMatrix),b.multiply(_.matrixWorldInverse),h.multiplyMatrices(_.projectionMatrix,_.matrixWorldInverse),s.setFromMatrix(h),d.length=0,n(p,E,_);S=0;for(var C=d.length;S<C;S++){var L=d[S],A=r.update(L);if((k=L.material)instanceof THREE.MultiMaterial)for(var P=A.groups,k=k.materials,I=0,F=P.length;I<F;I++){var U=P[I],D=k[U.materialIndex];!0===D.visible&&(D=i(L,D,v,u),t.renderBufferDirect(_,null,A,D,L,U));}else D=i(L,k,v,u),t.renderBufferDirect(_,null,A,D,L,null);}}t.resetGLState();}T=t.getClearColor(),v=t.getClearAlpha(),t.setClearColor(T,v),a.enable(o.BLEND),M.cullFace===THREE.CullFaceFront&&o.cullFace(o.BACK),t.resetGLState(),M.needsUpdate=!1;}};},THREE.WebGLState=function(t,e,r){var i=this,n=new THREE.Vector4(),o=new Uint8Array(16),a=new Uint8Array(16),s=new Uint8Array(16),h={},c=null,l=null,u=null,d=null,p=null,E=null,f=null,m=null,g=null,T=null,v=null,y=null,R=null,H=null,x=null,b=null,_=null,M=null,w=null,S=null,C=null,L=null,A=null,P=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),k=void 0,I={},F=new THREE.Vector4(),U=null,D=null,B=new THREE.Vector4(),V=new THREE.Vector4();this.init=function(){this.clearColor(0,0,0,1),this.clearDepth(1),this.clearStencil(0),this.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.frontFace(t.CCW),t.cullFace(t.BACK),this.enable(t.CULL_FACE),this.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA);},this.initAttributes=function(){for(var t=0,e=o.length;t<e;t++){o[t]=0;}},this.enableAttribute=function(r){o[r]=1,0===a[r]&&(t.enableVertexAttribArray(r),a[r]=1),0!==s[r]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(r,0),s[r]=0);},this.enableAttributeAndDivisor=function(e,r,i){o[e]=1,0===a[e]&&(t.enableVertexAttribArray(e),a[e]=1),s[e]!==r&&(i.vertexAttribDivisorANGLE(e,r),s[e]=r);},this.disableUnusedAttributes=function(){for(var e=0,r=a.length;e<r;e++){a[e]!==o[e]&&(t.disableVertexAttribArray(e),a[e]=0);}},this.enable=function(e){!0!==h[e]&&(t.enable(e),h[e]=!0);},this.disable=function(e){!1!==h[e]&&(t.disable(e),h[e]=!1);},this.getCompressedTextureFormats=function(){if(null===c&&(c=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var r=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),i=0;i<r.length;i++){c.push(r[i]);}return c;},this.setBlending=function(e,i,n,o,a,s,h){e===THREE.NoBlending?this.disable(t.BLEND):this.enable(t.BLEND),e!==l&&(e===THREE.AdditiveBlending?(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):e===THREE.SubtractiveBlending?(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):e===THREE.MultiplyBlending?(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),l=e),e===THREE.CustomBlending?(a=a||i,s=s||n,h=h||o,i===u&&a===E||(t.blendEquationSeparate(r(i),r(a)),u=i,E=a),n===d&&o===p&&s===f&&h===m||(t.blendFuncSeparate(r(n),r(o),r(s),r(h)),d=n,p=o,f=s,m=h)):m=f=E=p=d=u=null;},this.setDepthFunc=function(e){if(g!==e){if(e)switch(e){case THREE.NeverDepth:t.depthFunc(t.NEVER);break;case THREE.AlwaysDepth:t.depthFunc(t.ALWAYS);break;case THREE.LessDepth:t.depthFunc(t.LESS);break;case THREE.LessEqualDepth:t.depthFunc(t.LEQUAL);break;case THREE.EqualDepth:t.depthFunc(t.EQUAL);break;case THREE.GreaterEqualDepth:t.depthFunc(t.GEQUAL);break;case THREE.GreaterDepth:t.depthFunc(t.GREATER);break;case THREE.NotEqualDepth:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL);}else t.depthFunc(t.LEQUAL);g=e;}},this.setDepthTest=function(e){e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST);},this.setDepthWrite=function(e){T!==e&&(t.depthMask(e),T=e);},this.setColorWrite=function(e){v!==e&&(t.colorMask(e,e,e,e),v=e);},this.setStencilFunc=function(e,r,i){R===e&&H===r&&x===i||(t.stencilFunc(e,r,i),R=e,H=r,x=i);},this.setStencilOp=function(e,r,i){b===e&&_===r&&M===i||(t.stencilOp(e,r,i),b=e,_=r,M=i);},this.setStencilTest=function(e){e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST);},this.setStencilWrite=function(e){y!==e&&(t.stencilMask(e),y=e);},this.setFlipSided=function(e){w!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),w=e);},this.setLineWidth=function(e){e!==S&&(t.lineWidth(e),S=e);},this.setPolygonOffset=function(e,r,i){e?this.enable(t.POLYGON_OFFSET_FILL):this.disable(t.POLYGON_OFFSET_FILL),!e||C===r&&L===i||(t.polygonOffset(r,i),C=r,L=i);},this.getScissorTest=function(){return A;},this.setScissorTest=function(e){(A=e)?this.enable(t.SCISSOR_TEST):this.disable(t.SCISSOR_TEST);},this.activeTexture=function(e){void 0===e&&(e=t.TEXTURE0+P-1),k!==e&&(t.activeTexture(e),k=e);},this.bindTexture=function(e,r){void 0===k&&i.activeTexture();var n=I[k];void 0===n&&(n={type:void 0,texture:void 0},I[k]=n),n.type===e&&n.texture===r||(t.bindTexture(e,r),n.type=e,n.texture=r);},this.compressedTexImage2D=function(){try{t.compressedTexImage2D.apply(t,arguments);}catch(t){console.error(t);}},this.texImage2D=function(){try{t.texImage2D.apply(t,arguments);}catch(t){console.error(t);}},this.clearColor=function(e,r,i,o){n.set(e,r,i,o),!1===F.equals(n)&&(t.clearColor(e,r,i,o),F.copy(n));},this.clearDepth=function(e){U!==e&&(t.clearDepth(e),U=e);},this.clearStencil=function(e){D!==e&&(t.clearStencil(e),D=e);},this.scissor=function(e){!1===B.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),B.copy(e));},this.viewport=function(e){!1===V.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),V.copy(e));},this.reset=function(){for(var e=0;e<a.length;e++){1===a[e]&&(t.disableVertexAttribArray(e),a[e]=0);}h={},w=y=T=v=l=c=null;};},THREE.LensFlarePlugin=function(t,e){var r,i,n,o,a,s,h,c,l,u,d,p,E,f,m,g,T=t.context,v=t.state;this.render=function(y,R,H){if(0!==e.length){y=new THREE.Vector3();var x=H.w/H.z,b=.5*H.z,_=.5*H.w,M=16/H.w,w=new THREE.Vector2(M*x,M),S=new THREE.Vector3(1,1,0),C=new THREE.Vector2(1,1);if(void 0===E){M=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]);var L=new Uint16Array([0,1,2,0,2,3]);d=T.createBuffer(),p=T.createBuffer(),T.bindBuffer(T.ARRAY_BUFFER,d),T.bufferData(T.ARRAY_BUFFER,M,T.STATIC_DRAW),T.bindBuffer(T.ELEMENT_ARRAY_BUFFER,p),T.bufferData(T.ELEMENT_ARRAY_BUFFER,L,T.STATIC_DRAW),m=T.createTexture(),g=T.createTexture(),v.bindTexture(T.TEXTURE_2D,m),T.texImage2D(T.TEXTURE_2D,0,T.RGB,16,16,0,T.RGB,T.UNSIGNED_BYTE,null),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.NEAREST),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.NEAREST),v.bindTexture(T.TEXTURE_2D,g),T.texImage2D(T.TEXTURE_2D,0,T.RGBA,16,16,0,T.RGBA,T.UNSIGNED_BYTE,null),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.NEAREST),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.NEAREST);M=(f=0<T.getParameter(T.MAX_VERTEX_TEXTURE_IMAGE_UNITS))?{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},L=T.createProgram();var A=T.createShader(T.FRAGMENT_SHADER),P=T.createShader(T.VERTEX_SHADER),k="precision "+t.getPrecision()+" float;\n";T.shaderSource(A,k+M.fragmentShader),T.shaderSource(P,k+M.vertexShader),T.compileShader(A),T.compileShader(P),T.attachShader(L,A),T.attachShader(L,P),T.linkProgram(L),E=L,l=T.getAttribLocation(E,"position"),u=T.getAttribLocation(E,"uv"),r=T.getUniformLocation(E,"renderType"),i=T.getUniformLocation(E,"map"),n=T.getUniformLocation(E,"occlusionMap"),o=T.getUniformLocation(E,"opacity"),a=T.getUniformLocation(E,"color"),s=T.getUniformLocation(E,"scale"),h=T.getUniformLocation(E,"rotation"),c=T.getUniformLocation(E,"screenPosition");}for(T.useProgram(E),v.initAttributes(),v.enableAttribute(l),v.enableAttribute(u),v.disableUnusedAttributes(),T.uniform1i(n,0),T.uniform1i(i,1),T.bindBuffer(T.ARRAY_BUFFER,d),T.vertexAttribPointer(l,2,T.FLOAT,!1,16,0),T.vertexAttribPointer(u,2,T.FLOAT,!1,16,8),T.bindBuffer(T.ELEMENT_ARRAY_BUFFER,p),v.disable(T.CULL_FACE),v.setDepthWrite(!1),L=0,A=e.length;L<A;L++){if(M=16/H.w,w.set(M*x,M),P=e[L],y.set(P.matrixWorld.elements[12],P.matrixWorld.elements[13],P.matrixWorld.elements[14]),y.applyMatrix4(R.matrixWorldInverse),y.applyProjection(R.projectionMatrix),S.copy(y),C.x=S.x*b+b,C.y=S.y*_+_,f||0<C.x&&C.x<H.z&&0<C.y&&C.y<H.w){v.activeTexture(T.TEXTURE0),v.bindTexture(T.TEXTURE_2D,null),v.activeTexture(T.TEXTURE1),v.bindTexture(T.TEXTURE_2D,m),T.copyTexImage2D(T.TEXTURE_2D,0,T.RGB,H.x+C.x-8,H.y+C.y-8,16,16,0),T.uniform1i(r,0),T.uniform2f(s,w.x,w.y),T.uniform3f(c,S.x,S.y,S.z),v.disable(T.BLEND),v.enable(T.DEPTH_TEST),T.drawElements(T.TRIANGLES,6,T.UNSIGNED_SHORT,0),v.activeTexture(T.TEXTURE0),v.bindTexture(T.TEXTURE_2D,g),T.copyTexImage2D(T.TEXTURE_2D,0,T.RGBA,H.x+C.x-8,H.y+C.y-8,16,16,0),T.uniform1i(r,1),v.disable(T.DEPTH_TEST),v.activeTexture(T.TEXTURE1),v.bindTexture(T.TEXTURE_2D,m),T.drawElements(T.TRIANGLES,6,T.UNSIGNED_SHORT,0),P.positionScreen.copy(S),P.customUpdateCallback?P.customUpdateCallback(P):P.updateLensFlares(),T.uniform1i(r,2),v.enable(T.BLEND);k=0;for(var I=P.lensFlares.length;k<I;k++){var F=P.lensFlares[k];.001<F.opacity&&.001<F.scale&&(S.x=F.x,S.y=F.y,S.z=F.z,M=F.size*F.scale/H.w,w.x=M*x,w.y=M,T.uniform3f(c,S.x,S.y,S.z),T.uniform2f(s,w.x,w.y),T.uniform1f(h,F.rotation),T.uniform1f(o,F.opacity),T.uniform3f(a,F.color.r,F.color.g,F.color.b),v.setBlending(F.blending,F.blendEquation,F.blendSrc,F.blendDst),t.setTexture(F.texture,1),T.drawElements(T.TRIANGLES,6,T.UNSIGNED_SHORT,0));}}}v.enable(T.CULL_FACE),v.enable(T.DEPTH_TEST),v.setDepthWrite(!0),t.resetGLState();}};},THREE.SpritePlugin=function(t,e){var r,i,n,o,a,s,h,c,l,u,d,p,E,f,m,g,T;function v(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id;}var y,R,H,x,b=t.context,_=t.state,M=new THREE.Vector3(),w=new THREE.Quaternion(),S=new THREE.Vector3();this.render=function(C,L){if(0!==e.length){if(void 0===H){var A=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),P=new Uint16Array([0,1,2,0,2,3]);y=b.createBuffer(),R=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,y),b.bufferData(b.ARRAY_BUFFER,A,b.STATIC_DRAW),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,R),b.bufferData(b.ELEMENT_ARRAY_BUFFER,P,b.STATIC_DRAW);A=b.createProgram(),P=b.createShader(b.VERTEX_SHADER);var k=b.createShader(b.FRAGMENT_SHADER);b.shaderSource(P,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n")),b.shaderSource(k,["precision "+t.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n")),b.compileShader(P),b.compileShader(k),b.attachShader(A,P),b.attachShader(A,k),b.linkProgram(A),H=A,g=b.getAttribLocation(H,"position"),T=b.getAttribLocation(H,"uv"),r=b.getUniformLocation(H,"uvOffset"),i=b.getUniformLocation(H,"uvScale"),n=b.getUniformLocation(H,"rotation"),o=b.getUniformLocation(H,"scale"),a=b.getUniformLocation(H,"color"),s=b.getUniformLocation(H,"map"),h=b.getUniformLocation(H,"opacity"),c=b.getUniformLocation(H,"modelViewMatrix"),l=b.getUniformLocation(H,"projectionMatrix"),u=b.getUniformLocation(H,"fogType"),d=b.getUniformLocation(H,"fogDensity"),p=b.getUniformLocation(H,"fogNear"),E=b.getUniformLocation(H,"fogFar"),f=b.getUniformLocation(H,"fogColor"),m=b.getUniformLocation(H,"alphaTest"),(A=document.createElement("canvas")).width=8,A.height=8,(P=A.getContext("2d")).fillStyle="white",P.fillRect(0,0,8,8),(x=new THREE.Texture(A)).needsUpdate=!0;}b.useProgram(H),_.initAttributes(),_.enableAttribute(g),_.enableAttribute(T),_.disableUnusedAttributes(),_.disable(b.CULL_FACE),_.enable(b.BLEND),b.bindBuffer(b.ARRAY_BUFFER,y),b.vertexAttribPointer(g,2,b.FLOAT,!1,16,0),b.vertexAttribPointer(T,2,b.FLOAT,!1,16,8),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,R),b.uniformMatrix4fv(l,!1,L.projectionMatrix.elements),_.activeTexture(b.TEXTURE0),b.uniform1i(s,0),P=A=0,(k=C.fog)?(b.uniform3f(f,k.color.r,k.color.g,k.color.b),k instanceof THREE.Fog?(b.uniform1f(p,k.near),b.uniform1f(E,k.far),b.uniform1i(u,1),P=A=1):k instanceof THREE.FogExp2&&(b.uniform1f(d,k.density),b.uniform1i(u,2),P=A=2)):(b.uniform1i(u,0),P=A=0);k=0;for(var I=e.length;k<I;k++){(U=e[k]).modelViewMatrix.multiplyMatrices(L.matrixWorldInverse,U.matrixWorld),U.z=-U.modelViewMatrix.elements[14];}e.sort(v);var F=[];for(k=0,I=e.length;k<I;k++){var U,D=(U=e[k]).material;b.uniform1f(m,D.alphaTest),b.uniformMatrix4fv(c,!1,U.modelViewMatrix.elements),U.matrixWorld.decompose(M,w,S),F[0]=S.x,F[1]=S.y,U=0,C.fog&&D.fog&&(U=P),A!==U&&(b.uniform1i(u,U),A=U),null!==D.map?(b.uniform2f(r,D.map.offset.x,D.map.offset.y),b.uniform2f(i,D.map.repeat.x,D.map.repeat.y)):(b.uniform2f(r,0,0),b.uniform2f(i,1,1)),b.uniform1f(h,D.opacity),b.uniform3f(a,D.color.r,D.color.g,D.color.b),b.uniform1f(n,D.rotation),b.uniform2fv(o,F),_.setBlending(D.blending,D.blendEquation,D.blendSrc,D.blendDst),_.setDepthTest(D.depthTest),_.setDepthWrite(D.depthWrite),D.map&&D.map.image&&D.map.image.width?t.setTexture(D.map,0):t.setTexture(x,0),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);}_.enable(b.CULL_FACE),t.resetGLState();}};},Object.defineProperties(THREE.Box2.prototype,{empty:{value:function value(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty();}},isIntersectionBox:{value:function value(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t);}}}),Object.defineProperties(THREE.Box3.prototype,{empty:{value:function value(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty();}},isIntersectionBox:{value:function value(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t);}},isIntersectionSphere:{value:function value(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t);}}}),Object.defineProperties(THREE.Matrix3.prototype,{multiplyVector3:{value:function value(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this);}},multiplyVector3Array:{value:function value(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t);}}}),Object.defineProperties(THREE.Matrix4.prototype,{extractPosition:{value:function value(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t);}},setRotationFromQuaternion:{value:function value(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t);}},multiplyVector3:{value:function value(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this);}},multiplyVector4:{value:function value(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this);}},multiplyVector3Array:{value:function value(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t);}},rotateAxis:{value:function value(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this);}},crossVector:{value:function value(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this);}},translate:{value:function value(t){console.error("THREE.Matrix4: .translate() has been removed.");}},rotateX:{value:function value(t){console.error("THREE.Matrix4: .rotateX() has been removed.");}},rotateY:{value:function value(t){console.error("THREE.Matrix4: .rotateY() has been removed.");}},rotateZ:{value:function value(t){console.error("THREE.Matrix4: .rotateZ() has been removed.");}},rotateByAxis:{value:function value(t,e){console.error("THREE.Matrix4: .rotateByAxis() has been removed.");}}}),Object.defineProperties(THREE.Plane.prototype,{isIntersectionLine:{value:function value(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t);}}}),Object.defineProperties(THREE.Quaternion.prototype,{multiplyVector3:{value:function value(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this);}}}),Object.defineProperties(THREE.Ray.prototype,{isIntersectionBox:{value:function value(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t);}},isIntersectionPlane:{value:function value(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t);}},isIntersectionSphere:{value:function value(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t);}}}),Object.defineProperties(THREE.Vector3.prototype,{setEulerFromRotationMatrix:{value:function value(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.");}},setEulerFromQuaternion:{value:function value(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.");}},getPositionFromMatrix:{value:function value(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t);}},getScaleFromMatrix:{value:function value(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t);}},getColumnFromMatrix:{value:function value(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e);}}}),THREE.Face4=function(t,e,r,i,n,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new THREE.Face3(t,e,r,n,o,a);},Object.defineProperties(THREE.Object3D.prototype,{eulerOrder:{get:function get(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order;},set:function set(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t;}},getChildByName:{value:function value(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t);}},renderDepth:{set:function set(t){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.");}},translate:{value:function value(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t);}},useQuaternion:{get:function get(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.");},set:function set(t){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.");}}}),Object.defineProperties(THREE,{PointCloud:{value:function value(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new THREE.Points(t,e);}},ParticleSystem:{value:function value(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new THREE.Points(t,e);}}}),Object.defineProperties(THREE.Light.prototype,{onlyShadow:{set:function set(t){console.warn("THREE.Light: .onlyShadow has been removed.");}},shadowCameraFov:{set:function set(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t;}},shadowCameraLeft:{set:function set(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t;}},shadowCameraRight:{set:function set(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t;}},shadowCameraTop:{set:function set(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t;}},shadowCameraBottom:{set:function set(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t;}},shadowCameraNear:{set:function set(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t;}},shadowCameraFar:{set:function set(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t;}},shadowCameraVisible:{set:function set(t){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.");}},shadowBias:{set:function set(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t;}},shadowDarkness:{set:function set(t){console.warn("THREE.Light: .shadowDarkness has been removed.");}},shadowMapWidth:{set:function set(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t;}},shadowMapHeight:{set:function set(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t;}}}),Object.defineProperties(THREE.BufferAttribute.prototype,{length:{get:function get(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length;}}}),Object.defineProperties(THREE.BufferGeometry.prototype,{drawcalls:{get:function get(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups;}},offsets:{get:function get(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups;}},addIndex:{value:function value(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t);}},addDrawCall:{value:function value(t,e,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e);}},clearDrawCalls:{value:function value(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups();}},computeTangents:{value:function value(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.");}},computeOffsets:{value:function value(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.");}}}),Object.defineProperties(THREE.Material.prototype,{wrapAround:{get:function get(){console.warn("THREE."+this.type+": .wrapAround has been removed.");},set:function set(t){console.warn("THREE."+this.type+": .wrapAround has been removed.");}},wrapRGB:{get:function get(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new THREE.Color();}}}),Object.defineProperties(THREE,{PointCloudMaterial:{value:function value(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new THREE.PointsMaterial(t);}},ParticleBasicMaterial:{value:function value(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new THREE.PointsMaterial(t);}},ParticleSystemMaterial:{value:function value(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new THREE.PointsMaterial(t);}}}),Object.defineProperties(THREE.MeshPhongMaterial.prototype,{metal:{get:function get(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1;},set:function set(t){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead");}}}),Object.defineProperties(THREE.ShaderMaterial.prototype,{derivatives:{get:function get(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives;},set:function set(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t;}}}),Object.defineProperties(THREE.WebGLRenderer.prototype,{supportsFloatTextures:{value:function value(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float");}},supportsHalfFloatTextures:{value:function value(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float");}},supportsStandardDerivatives:{value:function value(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives");}},supportsCompressedTextureS3TC:{value:function value(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc");}},supportsCompressedTexturePVRTC:{value:function value(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc");}},supportsBlendMinMax:{value:function value(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax");}},supportsVertexTextures:{value:function value(){return this.capabilities.vertexTextures;}},supportsInstancedArrays:{value:function value(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays");}},enableScissorTest:{value:function value(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t);}},initMaterial:{value:function value(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.");}},addPrePlugin:{value:function value(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.");}},addPostPlugin:{value:function value(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.");}},updateShadowMap:{value:function value(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.");}},shadowMapEnabled:{get:function get(){return this.shadowMap.enabled;},set:function set(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t;}},shadowMapType:{get:function get(){return this.shadowMap.type;},set:function set(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t;}},shadowMapCullFace:{get:function get(){return this.shadowMap.cullFace;},set:function set(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=t;}}}),Object.defineProperties(THREE.WebGLRenderTarget.prototype,{wrapS:{get:function get(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS;},set:function set(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t;}},wrapT:{get:function get(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT;},set:function set(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t;}},magFilter:{get:function get(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter;},set:function set(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t;}},minFilter:{get:function get(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter;},set:function set(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t;}},anisotropy:{get:function get(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy;},set:function set(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t;}},offset:{get:function get(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset;},set:function set(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t;}},repeat:{get:function get(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat;},set:function set(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t;}},format:{get:function get(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format;},set:function set(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t;}},type:{get:function get(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type;},set:function set(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t;}},generateMipmaps:{get:function get(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps;},set:function set(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t;}}}),THREE.GeometryUtils={merge:function merge(t,e,r){var i;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e instanceof THREE.Mesh&&(e.matrixAutoUpdate&&e.updateMatrix(),i=e.matrix,e=e.geometry),t.merge(e,i,r);},center:function center(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center();}},THREE.ImageUtils={crossOrigin:void 0,loadTexture:function loadTexture(t,e,r,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var n=new THREE.TextureLoader();return n.setCrossOrigin(this.crossOrigin),t=n.load(t,r,void 0,i),e&&(t.mapping=e),t;},loadTextureCube:function loadTextureCube(t,e,r,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var n=new THREE.CubeTextureLoader();return n.setCrossOrigin(this.crossOrigin),t=n.load(t,r,void 0,i),e&&(t.mapping=e),t;},loadCompressedTexture:function loadCompressedTexture(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.");},loadCompressedTextureCube:function loadCompressedTextureCube(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.");}},THREE.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e);},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e);},this.pickingRay=function(t,e){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().");};},THREE.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){};},THREE.MeshFaceMaterial=THREE.MultiMaterial,THREE.CurveUtils={tangentQuadraticBezier:function tangentQuadraticBezier(t,e,r,i){return 2*(1-t)*(r-e)+2*t*(i-r);},tangentCubicBezier:function tangentCubicBezier(t,e,r,i,n){return-3*e*(1-t)*(1-t)+3*r*(1-t)*(1-t)-6*t*r*(1-t)+6*t*i*(1-t)-3*t*t*i+3*t*t*n;},tangentSpline:function tangentSpline(t,e,r,i,n){return 6*t*t-6*t+(3*t*t-4*t+1)+(-6*t*t+6*t)+(3*t*t-2*t);},interpolate:function interpolate(t,e,r,i,n){var o=n*n;return(2*e-2*r+(t=.5*(r-t))+(i=.5*(i-e)))*n*o+(-3*e+3*r-2*t-i)*o+t*n+e;}},THREE.SceneUtils={createMultiMaterialObject:function createMultiMaterialObject(t,e){for(var r=new THREE.Group(),i=0,n=e.length;i<n;i++){r.add(new THREE.Mesh(t,e[i]));}return r;},detach:function detach(t,e,r){t.applyMatrix(e.matrixWorld),e.remove(t),r.add(t);},attach:function attach(t,e,r){var i=new THREE.Matrix4();i.getInverse(r.matrixWorld),t.applyMatrix(i),e.remove(t),r.add(t);}},THREE.ShapeUtils={area:function area(t){for(var e=t.length,r=0,i=e-1,n=0;n<e;i=n++){r+=t[i].x*t[n].y-t[n].x*t[i].y;}return .5*r;},triangulate:function triangulate(t,e){var r=t.length;if(3>r)return null;var i,n,o,a=[],s=[],h=[];if(0<THREE.ShapeUtils.area(t))for(n=0;n<r;n++){s[n]=n;}else for(n=0;n<r;n++){s[n]=r-1-n;}var c=2*r;for(n=r-1;2<r;){if(0>=c--){console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()");break;}var l;r<=(i=n)&&(i=0),r<=(n=i+1)&&(n=0),r<=(o=n+1)&&(o=0);t:{var u=l=void 0,d=void 0,p=void 0,E=(u=t[s[i]].x,t[s[i]].y),f=t[s[n]].x,m=t[s[n]].y,g=t[s[o]].x,T=t[s[o]].y;if(Number.EPSILON>(f-u)*(T-E)-(m-E)*(g-u))l=!1;else{var v=void 0,y=void 0,R=void 0,H=void 0,x=(R=y=v=p=d=void 0,g-f),b=T-m,_=u-g,M=E-T,w=f-u,S=m-E;for(l=0;l<r;l++){if(d=t[s[l]].x,p=t[s[l]].y,!(d===u&&p===E||d===f&&p===m||d===g&&p===T)&&(R=d-f,H=p-m,v=w*(y=p-E)-S*(v=d-u),y=_*(p-=T)-M*(d-=g),(R=x*H-b*R)>=-Number.EPSILON&&y>=-Number.EPSILON&&v>=-Number.EPSILON)){l=!1;break t;}}l=!0;}}if(l){for(a.push([t[s[i]],t[s[n]],t[s[o]]]),h.push([s[i],s[n],s[o]]),i=n,o=n+1;o<r;i++,o++){s[i]=s[o];}c=2*--r;}}return e?h:a;},triangulateShape:function triangulateShape(t,e){function r(t,e,r){return t.x!==e.x?t.x<e.x?t.x<=r.x&&r.x<=e.x:e.x<=r.x&&r.x<=t.x:t.y<e.y?t.y<=r.y&&r.y<=e.y:e.y<=r.y&&r.y<=t.y;}function i(t,e,i,n,o){var a=e.x-t.x,s=e.y-t.y,h=n.x-i.x,c=n.y-i.y,l=t.x-i.x,u=t.y-i.y,d=s*h-a*c,p=s*l-a*u;if(Math.abs(d)>Number.EPSILON){if(0<d){if(0>p||p>d)return[];if(0>(h=c*l-h*u)||h>d)return[];}else{if(0<p||p<d)return[];if(0<(h=c*l-h*u)||h<d)return[];}return 0===h?!o||0!==p&&p!==d?[t]:[]:h===d?!o||0!==p&&p!==d?[e]:[]:0===p?[i]:p===d?[n]:(o=h/d,[{x:t.x+o*a,y:t.y+o*s}]);}return 0!==p||c*l!=h*u?[]:(h=0===h&&0===c,(s=0===a&&0===s)&&h?t.x!==i.x||t.y!==i.y?[]:[t]:s?r(i,n,t)?[t]:[]:h?r(t,e,i)?[i]:[]:(0!==a?(t.x<e.x?(a=t,h=t.x,s=e,t=e.x):(a=e,h=e.x,s=t,t=t.x),i.x<n.x?(e=i,d=i.x,c=n,i=n.x):(e=n,d=n.x,c=i,i=i.x)):(t.y<e.y?(a=t,h=t.y,s=e,t=e.y):(a=e,h=e.y,s=t,t=t.y),i.y<n.y?(e=i,d=i.y,c=n,i=n.y):(e=n,d=n.y,c=i,i=i.y)),h<=d?t<d?[]:t===d?o?[]:[e]:t<=i?[e,s]:[e,c]:h>i?[]:h===i?o?[]:[a]:t<=i?[a,s]:[a,c]));}function n(t,e,r,i){var n=e.x-t.x,o=e.y-t.y;e=r.x-t.x,r=r.y-t.y;var a=i.x-t.x;return i=i.y-t.y,t=n*r-o*e,n=n*i-o*a,Math.abs(t)>Number.EPSILON?(e=a*r-i*e,0<t?0<=n&&0<=e:0<=n||0<=e):0<n;}var o,a,s,h,c,l={};for(s=t.concat(),o=0,a=e.length;o<a;o++){Array.prototype.push.apply(s,e[o]);}for(o=0,a=s.length;o<a;o++){void 0!==l[c=s[o].x+":"+s[o].y]&&console.warn("THREE.Shape: Duplicate point",c),l[c]=o;}o=function(t,e){function r(t,e){var r=m.length-1,i=t-1;0>i&&(i=r);var o=t+1;return o>r&&(o=0),!!(r=n(m[t],m[i],m[o],s[e]))&&(r=s.length-1,0>(i=e-1)&&(i=r),(o=e+1)>r&&(o=0),!!(r=n(s[e],s[i],s[o],m[t])));}function o(t,e){var r,n;for(r=0;r<m.length;r++){if(n=r+1,n%=m.length,0<(n=i(t,e,m[r],m[n],!0)).length)return!0;}return!1;}function a(t,r){var n,o,a,s;for(n=0;n<g.length;n++){for(o=e[g[n]],a=0;a<o.length;a++){if(s=a+1,s%=o.length,0<(s=i(t,r,o[a],o[s],!0)).length)return!0;}}return!1;}var s,h,c,l,u,d,p,E,f,m=t.concat(),g=[],T=[],v=0;for(h=e.length;v<h;v++){g.push(v);}p=0;for(var y=2*g.length;0<g.length;){if(0>--y){console.log("Infinite Loop! Holes left:"+g.length+", Probably Hole outside Shape!");break;}for(c=p;c<m.length;c++){for(l=m[c],h=-1,v=0;v<g.length;v++){if(u=g[v],void 0===T[d=l.x+":"+l.y+":"+u]){for(s=e[u],E=0;E<s.length;E++){if(u=s[E],r(c,E)&&!o(l,u)&&!a(l,u)){h=E,g.splice(v,1),p=m.slice(0,c+1),u=m.slice(c),E=s.slice(h),f=s.slice(0,h+1),m=p.concat(E).concat(f).concat(u),p=c;break;}}if(0<=h)break;T[d]=!0;}}if(0<=h)break;}}return m;}(t,e);var u=THREE.ShapeUtils.triangulate(o,!1);for(o=0,a=u.length;o<a;o++){for(h=u[o],s=0;3>s;s++){void 0!==(c=l[c=h[s].x+":"+h[s].y])&&(h[s]=c);}}return u.concat();},isClockWise:function isClockWise(t){return 0>THREE.ShapeUtils.area(t);},b2:function b2(t,e,r,i){var n=1-t;return n*n*e+2*(1-t)*t*r+t*t*i;},b3:function b3(t,e,r,i,n){var o=1-t,a=1-t;return o*o*o*e+3*a*a*t*r+3*(1-t)*t*t*i+t*t*t*n;}},THREE.Curve=function(){},THREE.Curve.prototype={constructor:THREE.Curve,getPoint:function getPoint(t){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null;},getPointAt:function getPointAt(t){return t=this.getUtoTmapping(t),this.getPoint(t);},getPoints:function getPoints(t){t||(t=5);var e,r=[];for(e=0;e<=t;e++){r.push(this.getPoint(e/t));}return r;},getSpacedPoints:function getSpacedPoints(t){t||(t=5);var e,r=[];for(e=0;e<=t;e++){r.push(this.getPointAt(e/t));}return r;},getLength:function getLength(){var t=this.getLengths();return t[t.length-1];},getLengths:function getLengths(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,r,i=[],n=this.getPoint(0),o=0;for(i.push(0),r=1;r<=t;r++){o+=(e=this.getPoint(r/t)).distanceTo(n),i.push(o),n=e;}return this.cacheArcLengths=i;},updateArcLengths:function updateArcLengths(){this.needsUpdate=!0,this.getLengths();},getUtoTmapping:function getUtoTmapping(t,e){var r,i=this.getLengths(),n=0,o=i.length;r=e||t*i[o-1];for(var a,s=0,h=o-1;s<=h;){if(0>(a=i[n=Math.floor(s+(h-s)/2)]-r))s=n+1;else{if(!(0<a)){h=n;break;}h=n-1;}}return i[n=h]===r?n/(o-1):(n+(r-(s=i[n]))/(i[n+1]-s))/(o-1);},getTangent:function getTangent(t){var e=t-1e-4;return 0>e&&(e=0),1<(t+=1e-4)&&(t=1),e=this.getPoint(e),this.getPoint(t).clone().sub(e).normalize();},getTangentAt:function getTangentAt(t){return t=this.getUtoTmapping(t),this.getTangent(t);}},THREE.Curve.create=function(t,e){return t.prototype=Object.create(THREE.Curve.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t;},THREE.CurvePath=function(){this.curves=[],this.autoClose=!1;},THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype),THREE.CurvePath.prototype.constructor=THREE.CurvePath,THREE.CurvePath.prototype.add=function(t){this.curves.push(t);},THREE.CurvePath.prototype.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new THREE.LineCurve(e,t));},THREE.CurvePath.prototype.getPoint=function(t){for(var e=t*this.getLength(),r=this.getCurveLengths(),i=0;i<r.length;){if(r[i]>=e)return t=this.curves[i],e=1-(r[i]-e)/t.getLength(),t.getPointAt(e);i++;}return null;},THREE.CurvePath.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1];},THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,r=0,i=this.curves.length;r<i;r++){e+=this.curves[r].getLength(),t.push(e);}return this.cacheLengths=t;},THREE.CurvePath.prototype.createPointsGeometry=function(t){return t=this.getPoints(t),this.createGeometry(t);},THREE.CurvePath.prototype.createSpacedPointsGeometry=function(t){return t=this.getSpacedPoints(t),this.createGeometry(t);},THREE.CurvePath.prototype.createGeometry=function(t){for(var e=new THREE.Geometry(),r=0,i=t.length;r<i;r++){var n=t[r];e.vertices.push(new THREE.Vector3(n.x,n.y,n.z||0));}return e;},THREE.Font=function(t){this.data=t;},THREE.Font.prototype={constructor:THREE.Font,generateShapes:function generateShapes(t,e,r){void 0===e&&(e=100),void 0===r&&(r=4);var i=this.data;t=String(t).split("");var n=e/i.resolution,o=0;e=[];for(var a=0;a<t.length;a++){var s;s=n;var h=o,c=i.glyphs[t[a]]||i.glyphs["?"];if(c){var l=new THREE.Path(),u=[],d=THREE.ShapeUtils.b2,p=THREE.ShapeUtils.b3,E=void 0,f=void 0,m=f=E=void 0,g=void 0,T=void 0,v=void 0,y=void 0,R=void 0;g=void 0;if(c.o)for(var H=c._cachedOutline||(c._cachedOutline=c.o.split(" ")),x=0,b=H.length;x<b;){switch(H[x++]){case"m":E=H[x++]*s+h,f=H[x++]*s,l.moveTo(E,f);break;case"l":E=H[x++]*s+h,f=H[x++]*s,l.lineTo(E,f);break;case"q":if(E=H[x++]*s+h,f=H[x++]*s,T=H[x++]*s+h,v=H[x++]*s,l.quadraticCurveTo(T,v,E,f),g=u[u.length-1]){m=g.x,g=g.y;for(var _=1;_<=r;_++){var M=_/r;d(M,m,T,E),d(M,g,v,f);}}break;case"b":if(E=H[x++]*s+h,f=H[x++]*s,T=H[x++]*s+h,v=H[x++]*s,y=H[x++]*s+h,R=H[x++]*s,l.bezierCurveTo(T,v,y,R,E,f),g=u[u.length-1])for(m=g.x,g=g.y,_=1;_<=r;_++){p(M=_/r,m,T,y,E),p(M,g,v,R,f);}}}s={offset:c.ha*s,path:l};}else s=void 0;o+=s.offset,e.push(s.path);}for(r=[],i=0,t=e.length;i<t;i++){Array.prototype.push.apply(r,e[i].toShapes());}return r;}},THREE.Path=function(t){THREE.CurvePath.call(this),this.actions=[],t&&this.fromPoints(t);},THREE.Path.prototype=Object.create(THREE.CurvePath.prototype),THREE.Path.prototype.constructor=THREE.Path,THREE.Path.prototype.fromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,r=t.length;e<r;e++){this.lineTo(t[e].x,t[e].y);}},THREE.Path.prototype.moveTo=function(t,e){this.actions.push({action:"moveTo",args:[t,e]});},THREE.Path.prototype.lineTo=function(t,e){var r=this.actions[this.actions.length-1].args;r=new THREE.LineCurve(new THREE.Vector2(r[r.length-2],r[r.length-1]),new THREE.Vector2(t,e));this.curves.push(r),this.actions.push({action:"lineTo",args:[t,e]});},THREE.Path.prototype.quadraticCurveTo=function(t,e,r,i){var n=this.actions[this.actions.length-1].args;n=new THREE.QuadraticBezierCurve(new THREE.Vector2(n[n.length-2],n[n.length-1]),new THREE.Vector2(t,e),new THREE.Vector2(r,i));this.curves.push(n),this.actions.push({action:"quadraticCurveTo",args:[t,e,r,i]});},THREE.Path.prototype.bezierCurveTo=function(t,e,r,i,n,o){var a=this.actions[this.actions.length-1].args;a=new THREE.CubicBezierCurve(new THREE.Vector2(a[a.length-2],a[a.length-1]),new THREE.Vector2(t,e),new THREE.Vector2(r,i),new THREE.Vector2(n,o));this.curves.push(a),this.actions.push({action:"bezierCurveTo",args:[t,e,r,i,n,o]});},THREE.Path.prototype.splineThru=function(t){var e=Array.prototype.slice.call(arguments),r=this.actions[this.actions.length-1].args;r=[new THREE.Vector2(r[r.length-2],r[r.length-1])];Array.prototype.push.apply(r,t),r=new THREE.SplineCurve(r),this.curves.push(r),this.actions.push({action:"splineThru",args:e});},THREE.Path.prototype.arc=function(t,e,r,i,n,o){var a=this.actions[this.actions.length-1].args;this.absarc(t+a[a.length-2],e+a[a.length-1],r,i,n,o);},THREE.Path.prototype.absarc=function(t,e,r,i,n,o){this.absellipse(t,e,r,r,i,n,o);},THREE.Path.prototype.ellipse=function(t,e,r,i,n,o,a,s){var h=this.actions[this.actions.length-1].args;this.absellipse(t+h[h.length-2],e+h[h.length-1],r,i,n,o,a,s);},THREE.Path.prototype.absellipse=function(t,e,r,i,n,o,a,s){var h=[t,e,r,i,n,o,a,s||0];t=new THREE.EllipseCurve(t,e,r,i,n,o,a,s),this.curves.push(t),t=t.getPoint(1),h.push(t.x),h.push(t.y),this.actions.push({action:"ellipse",args:h});},THREE.Path.prototype.getSpacedPoints=function(t){t||(t=40);for(var e=[],r=0;r<t;r++){e.push(this.getPoint(r/t));}return this.autoClose&&e.push(e[0]),e;},THREE.Path.prototype.getPoints=function(t){t=t||12;for(var e,r,i,n,o,a,s,h,c,l,u=THREE.ShapeUtils.b2,d=THREE.ShapeUtils.b3,p=[],E=0,f=this.actions.length;E<f;E++){var m=(c=this.actions[E]).args;switch(c.action){case"moveTo":case"lineTo":p.push(new THREE.Vector2(m[0],m[1]));break;case"quadraticCurveTo":for(e=m[2],r=m[3],o=m[0],a=m[1],0<p.length?(s=(c=p[p.length-1]).x,h=c.y):(s=(c=this.actions[E-1].args)[c.length-2],h=c[c.length-1]),m=1;m<=t;m++){c=u(l=m/t,s,o,e),l=u(l,h,a,r),p.push(new THREE.Vector2(c,l));}break;case"bezierCurveTo":for(e=m[4],r=m[5],o=m[0],a=m[1],i=m[2],n=m[3],0<p.length?(s=(c=p[p.length-1]).x,h=c.y):(s=(c=this.actions[E-1].args)[c.length-2],h=c[c.length-1]),m=1;m<=t;m++){c=d(l=m/t,s,o,i,e),l=d(l,h,a,n,r),p.push(new THREE.Vector2(c,l));}break;case"splineThru":for(c=this.actions[E-1].args,l=[new THREE.Vector2(c[c.length-2],c[c.length-1])],c=t*m[0].length,l=l.concat(m[0]),l=new THREE.SplineCurve(l),m=1;m<=c;m++){p.push(l.getPointAt(m/c));}break;case"arc":for(e=m[0],r=m[1],a=m[2],i=m[3],c=m[4],o=!!m[5],s=c-i,h=2*t,m=1;m<=h;m++){l=m/h,o||(l=1-l),l=i+l*s,c=e+a*Math.cos(l),l=r+a*Math.sin(l),p.push(new THREE.Vector2(c,l));}break;case"ellipse":e=m[0],r=m[1],a=m[2],n=m[3],i=m[4],c=m[5],o=!!m[6];var g,T,v=m[7];for(s=c-i,h=2*t,0!==v&&(g=Math.cos(v),T=Math.sin(v)),m=1;m<=h;m++){if(l=m/h,o||(l=1-l),l=i+l*s,c=e+a*Math.cos(l),l=r+n*Math.sin(l),0!==v){var y=c;c=(y-e)*g-(l-r)*T+e,l=(y-e)*T+(l-r)*g+r;}p.push(new THREE.Vector2(c,l));}}}return t=p[p.length-1],Math.abs(t.x-p[0].x)<Number.EPSILON&&Math.abs(t.y-p[0].y)<Number.EPSILON&&p.splice(p.length-1,1),this.autoClose&&p.push(p[0]),p;},THREE.Path.prototype.toShapes=function(t,e){function r(t){for(var e=[],r=0,i=t.length;r<i;r++){var n=t[r],o=new THREE.Shape();o.actions=n.actions,o.curves=n.curves,e.push(o);}return e;}function i(t,e){for(var r=e.length,i=!1,n=r-1,o=0;o<r;n=o++){var a=e[n],s=e[o],h=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(0>c&&(a=e[o],h=-h,s=e[n],c=-c),!(t.y<a.y||t.y>s.y))if(t.y===a.y){if(t.x===a.x)return!0;}else{if(0===(n=c*(t.x-a.x)-h*(t.y-a.y)))return!0;0>n||(i=!i);}}else if(t.y===a.y&&(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x))return!0;}return i;}var n=THREE.ShapeUtils.isClockWise,o=function(t){for(var e=[],r=new THREE.Path(),i=0,n=t.length;i<n;i++){var o,a=(o=t[i]).args;"moveTo"===(o=o.action)&&0!==r.actions.length&&(e.push(r),r=new THREE.Path()),r[o].apply(r,a);}return 0!==r.actions.length&&e.push(r),e;}(this.actions);if(0===o.length)return[];if(!0===e)return r(o);var a,s,h,c=[];if(1===o.length)return s=o[0],(h=new THREE.Shape()).actions=s.actions,h.curves=s.curves,c.push(h),c;var l=!n(o[0].getPoints());l=t?!l:l;h=[];var u,d=[],p=[],E=0;d[E]=void 0,p[E]=[];for(var f=0,m=o.length;f<m;f++){a=n(u=(s=o[f]).getPoints()),(a=t?!a:a)?(!l&&d[E]&&E++,d[E]={s:new THREE.Shape(),p:u},d[E].s.actions=s.actions,d[E].s.curves=s.curves,l&&E++,p[E]=[]):p[E].push({h:s,p:u[0]});}if(!d[0])return r(o);if(1<d.length){for(f=!1,s=[],n=0,o=d.length;n<o;n++){h[n]=[];}for(n=0,o=d.length;n<o;n++){for(a=p[n],l=0;l<a.length;l++){for(E=a[l],u=!0,m=0;m<d.length;m++){i(E.p,d[m].p)&&(n!==m&&s.push({froms:n,tos:m,hole:l}),u?(u=!1,h[m].push(E)):f=!0);}u&&h[n].push(E);}}0<s.length&&(f||(p=h));}for(f=0,n=d.length;f<n;f++){for(h=d[f].s,c.push(h),o=0,a=(s=p[f]).length;o<a;o++){h.holes.push(s[o].h);}}return c;},THREE.Shape=function(){THREE.Path.apply(this,arguments),this.holes=[];},THREE.Shape.prototype=Object.create(THREE.Path.prototype),THREE.Shape.prototype.constructor=THREE.Shape,THREE.Shape.prototype.extrude=function(t){return new THREE.ExtrudeGeometry(this,t);},THREE.Shape.prototype.makeGeometry=function(t){return new THREE.ShapeGeometry(this,t);},THREE.Shape.prototype.getPointsHoles=function(t){for(var e=[],r=0,i=this.holes.length;r<i;r++){e[r]=this.holes[r].getPoints(t);}return e;},THREE.Shape.prototype.extractAllPoints=function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)};},THREE.Shape.prototype.extractPoints=function(t){return this.extractAllPoints(t);},THREE.LineCurve=function(t,e){this.v1=t,this.v2=e;},THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.constructor=THREE.LineCurve,THREE.LineCurve.prototype.getPoint=function(t){var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e;},THREE.LineCurve.prototype.getPointAt=function(t){return this.getPoint(t);},THREE.LineCurve.prototype.getTangent=function(t){return this.v2.clone().sub(this.v1).normalize();},THREE.QuadraticBezierCurve=function(t,e,r){this.v0=t,this.v1=e,this.v2=r;},THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.constructor=THREE.QuadraticBezierCurve,THREE.QuadraticBezierCurve.prototype.getPoint=function(t){var e=THREE.ShapeUtils.b2;return new THREE.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y));},THREE.QuadraticBezierCurve.prototype.getTangent=function(t){var e=THREE.CurveUtils.tangentQuadraticBezier;return new THREE.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y)).normalize();},THREE.CubicBezierCurve=function(t,e,r,i){this.v0=t,this.v1=e,this.v2=r,this.v3=i;},THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.constructor=THREE.CubicBezierCurve,THREE.CubicBezierCurve.prototype.getPoint=function(t){var e=THREE.ShapeUtils.b3;return new THREE.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y));},THREE.CubicBezierCurve.prototype.getTangent=function(t){var e=THREE.CurveUtils.tangentCubicBezier;return new THREE.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize();},THREE.SplineCurve=function(t){this.points=null==t?[]:t;},THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.constructor=THREE.SplineCurve,THREE.SplineCurve.prototype.getPoint=function(t){t*=(n=this.points).length-1,t-=o=Math.floor(t);var e=n[0===o?o:o-1],r=n[o],i=n[o>n.length-2?n.length-1:o+1],n=n[o>n.length-3?n.length-1:o+2],o=THREE.CurveUtils.interpolate;return new THREE.Vector2(o(e.x,r.x,i.x,n.x,t),o(e.y,r.y,i.y,n.y,t));},THREE.EllipseCurve=function(t,e,r,i,n,o,a,s){this.aX=t,this.aY=e,this.xRadius=r,this.yRadius=i,this.aStartAngle=n,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s||0;},THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.constructor=THREE.EllipseCurve,THREE.EllipseCurve.prototype.getPoint=function(t){0>(r=this.aEndAngle-this.aStartAngle)&&(r+=2*Math.PI),r>2*Math.PI&&(r-=2*Math.PI),r=!0===this.aClockwise?this.aEndAngle+(1-t)*(2*Math.PI-r):this.aStartAngle+t*r,t=this.aX+this.xRadius*Math.cos(r);var e=this.aY+this.yRadius*Math.sin(r);if(0!==this.aRotation){var r=Math.cos(this.aRotation),i=Math.sin(this.aRotation),n=t;t=(n-this.aX)*r-(e-this.aY)*i+this.aX,e=(n-this.aX)*i+(e-this.aY)*r+this.aY;}return new THREE.Vector2(t,e);},THREE.ArcCurve=function(t,e,r,i,n,o){THREE.EllipseCurve.call(this,t,e,r,r,i,n,o);},THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype),THREE.ArcCurve.prototype.constructor=THREE.ArcCurve,THREE.LineCurve3=THREE.Curve.create(function(t,e){this.v1=t,this.v2=e;},function(t){var e=new THREE.Vector3();return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e;}),THREE.QuadraticBezierCurve3=THREE.Curve.create(function(t,e,r){this.v0=t,this.v1=e,this.v2=r;},function(t){var e=THREE.ShapeUtils.b2;return new THREE.Vector3(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y),e(t,this.v0.z,this.v1.z,this.v2.z));}),THREE.CubicBezierCurve3=THREE.Curve.create(function(t,e,r,i){this.v0=t,this.v1=e,this.v2=r,this.v3=i;},function(t){var e=THREE.ShapeUtils.b3;return new THREE.Vector3(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z));}),THREE.SplineCurve3=THREE.Curve.create(function(t){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=null==t?[]:t;},function(t){t*=(n=this.points).length-1,t-=o=Math.floor(t);var e=n[0==o?o:o-1],r=n[o],i=n[o>n.length-2?n.length-1:o+1],n=n[o>n.length-3?n.length-1:o+2],o=THREE.CurveUtils.interpolate;return new THREE.Vector3(o(e.x,r.x,i.x,n.x,t),o(e.y,r.y,i.y,n.y,t),o(e.z,r.z,i.z,n.z,t));}),THREE.CatmullRomCurve3=function(){function t(){}var e=new THREE.Vector3(),r=new t(),i=new t(),n=new t();return t.prototype.init=function(t,e,r,i){this.c0=t,this.c1=r,this.c2=-3*t+3*e-2*r-i,this.c3=2*t-2*e+r+i;},t.prototype.initNonuniformCatmullRom=function(t,e,r,i,n,o,a){t=((e-t)/n-(r-t)/(n+o)+(r-e)/o)*o,i=((r-e)/o-(i-e)/(o+a)+(i-r)/a)*o,this.init(e,r,t,i);},t.prototype.initCatmullRom=function(t,e,r,i,n){this.init(e,r,n*(r-t),n*(i-e));},t.prototype.calc=function(t){var e=t*t;return this.c0+this.c1*t+this.c2*e+this.c3*e*t;},THREE.Curve.create(function(t){this.points=t||[],this.closed=!1;},function(t){var o,a,s,h,c,l=this.points;if(2>(a=l.length)&&console.log("duh, you need at least 2 points"),t*=a-(this.closed?0:1),t-=o=Math.floor(t),this.closed?o+=0<o?0:(Math.floor(Math.abs(o)/l.length)+1)*l.length:0===t&&o===a-1&&(o=a-2,t=1),this.closed||0<o?s=l[(o-1)%a]:(e.subVectors(l[0],l[1]).add(l[0]),s=e),h=l[o%a],c=l[(o+1)%a],this.closed||o+2<a?l=l[(o+2)%a]:(e.subVectors(l[a-1],l[a-2]).add(l[a-1]),l=e),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var u="chordal"===this.type?.5:.25;a=Math.pow(s.distanceToSquared(h),u),1e-4>(o=Math.pow(h.distanceToSquared(c),u))&&(o=1),1e-4>a&&(a=o),1e-4>(u=Math.pow(c.distanceToSquared(l),u))&&(u=o),r.initNonuniformCatmullRom(s.x,h.x,c.x,l.x,a,o,u),i.initNonuniformCatmullRom(s.y,h.y,c.y,l.y,a,o,u),n.initNonuniformCatmullRom(s.z,h.z,c.z,l.z,a,o,u);}else"catmullrom"===this.type&&(a=void 0!==this.tension?this.tension:.5,r.initCatmullRom(s.x,h.x,c.x,l.x,a),i.initCatmullRom(s.y,h.y,c.y,l.y,a),n.initCatmullRom(s.z,h.z,c.z,l.z,a));return new THREE.Vector3(r.calc(t),i.calc(t),n.calc(t));});}(),THREE.ClosedSplineCurve3=function(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3."),THREE.CatmullRomCurve3.call(this,t),this.type="catmullrom",this.closed=!0;},THREE.ClosedSplineCurve3.prototype=Object.create(THREE.CatmullRomCurve3.prototype),THREE.BoxGeometry=function(t,e,r,i,n,o){function a(t,e,r,i,n,o,a,h){var c,l=s.widthSegments,u=s.heightSegments,d=n/2,p=o/2,E=s.vertices.length;"x"===t&&"y"===e||"y"===t&&"x"===e?c="z":"x"===t&&"z"===e||"z"===t&&"x"===e?(c="y",u=s.depthSegments):("z"===t&&"y"===e||"y"===t&&"z"===e)&&(c="x",l=s.depthSegments);var f=l+1,m=u+1,g=n/l,T=o/u,v=new THREE.Vector3();for(v[c]=0<a?1:-1,n=0;n<m;n++){for(o=0;o<f;o++){var y=new THREE.Vector3();y[t]=(o*g-d)*r,y[e]=(n*T-p)*i,y[c]=a,s.vertices.push(y);}}for(n=0;n<u;n++){for(o=0;o<l;o++){p=o+f*n,t=o+f*(n+1),e=o+1+f*(n+1),r=o+1+f*n,i=new THREE.Vector2(o/l,1-n/u),a=new THREE.Vector2(o/l,1-(n+1)/u),c=new THREE.Vector2((o+1)/l,1-(n+1)/u),d=new THREE.Vector2((o+1)/l,1-n/u),(p=new THREE.Face3(p+E,t+E,r+E)).normal.copy(v),p.vertexNormals.push(v.clone(),v.clone(),v.clone()),p.materialIndex=h,s.faces.push(p),s.faceVertexUvs[0].push([i,a,d]),(p=new THREE.Face3(t+E,e+E,r+E)).normal.copy(v),p.vertexNormals.push(v.clone(),v.clone(),v.clone()),p.materialIndex=h,s.faces.push(p),s.faceVertexUvs[0].push([a.clone(),c,d.clone()]);}}}THREE.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:r,widthSegments:i,heightSegments:n,depthSegments:o},this.widthSegments=i||1,this.heightSegments=n||1,this.depthSegments=o||1;var s=this;n=e/2,o=r/2,a("z","y",-1,-1,r,e,i=t/2,0),a("z","y",1,-1,r,e,-i,1),a("x","z",1,1,t,r,n,2),a("x","z",1,-1,t,r,-n,3),a("x","y",1,-1,t,e,o,4),a("x","y",-1,-1,t,e,-o,5),this.mergeVertices();},THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.BoxGeometry.prototype.constructor=THREE.BoxGeometry,THREE.CubeGeometry=THREE.BoxGeometry,THREE.CircleGeometry=function(t,e,r,i){THREE.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:r,thetaLength:i},this.fromBufferGeometry(new THREE.CircleBufferGeometry(t,e,r,i));},THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CircleGeometry.prototype.constructor=THREE.CircleGeometry,THREE.CircleBufferGeometry=function(t,e,r,i){THREE.BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:r,thetaLength:i},t=t||50,e=void 0!==e?Math.max(3,e):8,r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI;var n=e+2,o=new Float32Array(3*n),a=new Float32Array(3*n);n=new Float32Array(2*n);a[2]=1,n[0]=.5,n[1]=.5;for(var s=0,h=3,c=2;s<=e;s++,h+=3,c+=2){var l=r+s/e*i;o[h]=t*Math.cos(l),o[h+1]=t*Math.sin(l),a[h+2]=1,n[c]=(o[h]/t+1)/2,n[c+1]=(o[h+1]/t+1)/2;}for(r=[],h=1;h<=e;h++){r.push(h,h+1,0);}this.setIndex(new THREE.BufferAttribute(new Uint16Array(r),1)),this.addAttribute("position",new THREE.BufferAttribute(o,3)),this.addAttribute("normal",new THREE.BufferAttribute(a,3)),this.addAttribute("uv",new THREE.BufferAttribute(n,2)),this.boundingSphere=new THREE.Sphere(new THREE.Vector3(),t);},THREE.CircleBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.CircleBufferGeometry.prototype.constructor=THREE.CircleBufferGeometry,THREE.CylinderGeometry=function(t,e,r,i,n,o,a,s){THREE.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:r,radialSegments:i,heightSegments:n,openEnded:o,thetaStart:a,thetaLength:s},t=void 0!==t?t:20,e=void 0!==e?e:20,r=void 0!==r?r:100,i=i||8,n=n||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var h,c,l=r/2,u=[],d=[];for(c=0;c<=n;c++){var p=[],E=[],f=(g=c/n)*(e-t)+t;for(h=0;h<=i;h++){var m=h/i;(T=new THREE.Vector3()).x=f*Math.sin(m*s+a),T.y=-g*r+l,T.z=f*Math.cos(m*s+a),this.vertices.push(T),p.push(this.vertices.length-1),E.push(new THREE.Vector2(m,1-g));}u.push(p),d.push(E);}for(r=(e-t)/r,h=0;h<i;h++){for(0!==t?(a=this.vertices[u[0][h]].clone(),s=this.vertices[u[0][h+1]].clone()):(a=this.vertices[u[1][h]].clone(),s=this.vertices[u[1][h+1]].clone()),a.setY(Math.sqrt(a.x*a.x+a.z*a.z)*r).normalize(),s.setY(Math.sqrt(s.x*s.x+s.z*s.z)*r).normalize(),c=0;c<n;c++){p=u[c][h],E=u[c+1][h];var g=u[c+1][h+1],T=(f=u[c][h+1],m=a.clone(),a.clone()),v=s.clone(),y=s.clone(),R=d[c][h].clone(),H=d[c+1][h].clone(),x=d[c+1][h+1].clone(),b=d[c][h+1].clone();this.faces.push(new THREE.Face3(p,E,f,[m,T,y])),this.faceVertexUvs[0].push([R,H,b]),this.faces.push(new THREE.Face3(E,g,f,[T.clone(),v,y.clone()])),this.faceVertexUvs[0].push([H.clone(),x,b.clone()]);}}if(!1===o&&0<t)for(this.vertices.push(new THREE.Vector3(0,l,0)),h=0;h<i;h++){p=u[0][h],E=u[0][h+1],g=this.vertices.length-1,m=new THREE.Vector3(0,1,0),T=new THREE.Vector3(0,1,0),v=new THREE.Vector3(0,1,0),R=d[0][h].clone(),H=d[0][h+1].clone(),x=new THREE.Vector2(H.x,0),this.faces.push(new THREE.Face3(p,E,g,[m,T,v],void 0,1)),this.faceVertexUvs[0].push([R,H,x]);}if(!1===o&&0<e)for(this.vertices.push(new THREE.Vector3(0,-l,0)),h=0;h<i;h++){p=u[n][h+1],E=u[n][h],g=this.vertices.length-1,m=new THREE.Vector3(0,-1,0),T=new THREE.Vector3(0,-1,0),v=new THREE.Vector3(0,-1,0),R=d[n][h+1].clone(),H=d[n][h].clone(),x=new THREE.Vector2(H.x,1),this.faces.push(new THREE.Face3(p,E,g,[m,T,v],void 0,2)),this.faceVertexUvs[0].push([R,H,x]);}this.computeFaceNormals();},THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry,THREE.EdgesGeometry=function(t,e){function r(t,e){return t-e;}THREE.BufferGeometry.call(this);var i,n=Math.cos(THREE.Math.degToRad(void 0!==e?e:1)),o=[0,0],a={},s=["a","b","c"];t instanceof THREE.BufferGeometry?(i=new THREE.Geometry()).fromBufferGeometry(t):i=t.clone(),i.mergeVertices(),i.computeFaceNormals();for(var h=i.vertices,c=0,l=(i=i.faces).length;c<l;c++){for(var u=i[c],d=0;3>d;d++){o[0]=u[s[d]],o[1]=u[s[(d+1)%3]],o.sort(r);var p=o.toString();void 0===a[p]?a[p]={vert1:o[0],vert2:o[1],face1:c,face2:void 0}:a[p].face2=c;}}for(p in o=[],a){(void 0===(s=a[p]).face2||i[s.face1].normal.dot(i[s.face2].normal)<=n)&&(c=h[s.vert1],o.push(c.x),o.push(c.y),o.push(c.z),c=h[s.vert2],o.push(c.x),o.push(c.y),o.push(c.z));}this.addAttribute("position",new THREE.BufferAttribute(new Float32Array(o),3));},THREE.EdgesGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.EdgesGeometry.prototype.constructor=THREE.EdgesGeometry,THREE.ExtrudeGeometry=function(t,e){void 0!==t&&(THREE.Geometry.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeFaceNormals());},THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.constructor=THREE.ExtrudeGeometry,THREE.ExtrudeGeometry.prototype.addShapeList=function(t,e){for(var r=t.length,i=0;i<r;i++){this.addShape(t[i],e);}},THREE.ExtrudeGeometry.prototype.addShape=function(t,e){function r(t,e,r){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(r).add(t);}function i(t,e,r){var i=1,n=(i=t.x-e.x,t.y-e.y),o=r.x-t.x,a=r.y-t.y,s=i*i+n*n;if(Math.abs(i*a-n*o)>Number.EPSILON){var h=Math.sqrt(s),c=Math.sqrt(o*o+a*a);s=e.x-n/h;if(e=e.y+i/h,2>=(i=(r=s+i*(o=((r.x-a/c-s)*a-(r.y+o/c-e)*o)/(i*a-n*o))-t.x)*r+(t=e+n*o-t.y)*t))return new THREE.Vector2(r,t);i=Math.sqrt(i/2);}else t=!1,i>Number.EPSILON?o>Number.EPSILON&&(t=!0):i<-Number.EPSILON?o<-Number.EPSILON&&(t=!0):Math.sign(n)===Math.sign(a)&&(t=!0),t?(r=-n,t=i,i=Math.sqrt(s)):(r=i,t=n,i=Math.sqrt(s/2));return new THREE.Vector2(r/i,t/i);}function n(t,e){var r,i;for(B=t.length;0<=--B;){r=B,0>(i=B-1)&&(i=t.length-1);var n=0,o=T+2*f;for(n=0;n<o;n++){var a=(a=e+r+(s=U*n))+M,s=(s=e+i+s)+M,h=(h=e+i+(c=U*(n+1)))+M,c=(c=e+r+c)+M;_.faces.push(new THREE.Face3(a,s,c,null,null,1)),_.faces.push(new THREE.Face3(s,h,c,null,null,1)),a=R.generateSideWallUV(_,a,s,h,c),_.faceVertexUvs[0].push([a[0],a[1],a[3]]),_.faceVertexUvs[0].push([a[1],a[2],a[3]]);}}}function o(t,e,r){_.vertices.push(new THREE.Vector3(t,e,r));}function a(t,e,r){t+=M,e+=M,r+=M,_.faces.push(new THREE.Face3(t,e,r,null,null,0)),t=R.generateTopUV(_,t,e,r),_.faceVertexUvs[0].push(t);}var s,h,c,l,u,d=void 0!==e.amount?e.amount:100,p=void 0!==e.bevelThickness?e.bevelThickness:6,E=void 0!==e.bevelSize?e.bevelSize:p-2,f=void 0!==e.bevelSegments?e.bevelSegments:3,m=void 0===e.bevelEnabled||e.bevelEnabled,g=void 0!==e.curveSegments?e.curveSegments:12,T=void 0!==e.steps?e.steps:1,v=e.extrudePath,y=!1,R=void 0!==e.UVGenerator?e.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator;v&&(s=v.getSpacedPoints(T),y=!0,m=!1,h=void 0!==e.frames?e.frames:new THREE.TubeGeometry.FrenetFrames(v,T,!1),c=new THREE.Vector3(),l=new THREE.Vector3(),u=new THREE.Vector3()),m||(E=p=f=0);var H,x,b,_=this,M=this.vertices.length,w=(g=(v=t.extractPoints(g)).shape,v.holes);if(v=!THREE.ShapeUtils.isClockWise(g)){for(g=g.reverse(),x=0,b=w.length;x<b;x++){H=w[x],THREE.ShapeUtils.isClockWise(H)&&(w[x]=H.reverse());}v=!1;}var S=THREE.ShapeUtils.triangulateShape(g,w),C=g;for(x=0,b=w.length;x<b;x++){H=w[x],g=g.concat(H);}var L,A,P,k,I,F,U=g.length,D=S.length,B=(v=[],0);for(L=(P=C.length)-1,A=B+1;B<P;B++,L++,A++){L===P&&(L=0),A===P&&(A=0),v[B]=i(C[B],C[L],C[A]);}var V,N=[],O=v.concat();for(x=0,b=w.length;x<b;x++){for(H=w[x],V=[],B=0,L=(P=H.length)-1,A=B+1;B<P;B++,L++,A++){L===P&&(L=0),A===P&&(A=0),V[B]=i(H[B],H[L],H[A]);}N.push(V),O=O.concat(V);}for(L=0;L<f;L++){for(k=p*(1-(P=L/f)),A=E*Math.sin(P*Math.PI/2),B=0,P=C.length;B<P;B++){o((I=r(C[B],v[B],A)).x,I.y,-k);}for(x=0,b=w.length;x<b;x++){for(H=w[x],V=N[x],B=0,P=H.length;B<P;B++){o((I=r(H[B],V[B],A)).x,I.y,-k);}}}for(A=E,B=0;B<U;B++){I=m?r(g[B],O[B],A):g[B],y?(l.copy(h.normals[0]).multiplyScalar(I.x),c.copy(h.binormals[0]).multiplyScalar(I.y),u.copy(s[0]).add(l).add(c),o(u.x,u.y,u.z)):o(I.x,I.y,0);}for(P=1;P<=T;P++){for(B=0;B<U;B++){I=m?r(g[B],O[B],A):g[B],y?(l.copy(h.normals[P]).multiplyScalar(I.x),c.copy(h.binormals[P]).multiplyScalar(I.y),u.copy(s[P]).add(l).add(c),o(u.x,u.y,u.z)):o(I.x,I.y,d/T*P);}}for(L=f-1;0<=L;L--){for(k=p*(1-(P=L/f)),A=E*Math.sin(P*Math.PI/2),B=0,P=C.length;B<P;B++){o((I=r(C[B],v[B],A)).x,I.y,d+k);}for(x=0,b=w.length;x<b;x++){for(H=w[x],V=N[x],B=0,P=H.length;B<P;B++){I=r(H[B],V[B],A),y?o(I.x,I.y+s[T-1].y,s[T-1].x+k):o(I.x,I.y,d+k);}}}!function(){if(m){var t;for(t=0*U,B=0;B<D;B++){a((F=S[B])[2]+t,F[1]+t,F[0]+t);}for(t=T+2*f,t*=U,B=0;B<D;B++){a((F=S[B])[0]+t,F[1]+t,F[2]+t);}}else{for(B=0;B<D;B++){a((F=S[B])[2],F[1],F[0]);}for(B=0;B<D;B++){a((F=S[B])[0]+U*T,F[1]+U*T,F[2]+U*T);}}}(),function(){var t=0;for(n(C,t),t+=C.length,x=0,b=w.length;x<b;x++){n(H=w[x],t),t+=H.length;}}();},THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function generateTopUV(t,e,r,i){return e=(t=t.vertices)[e],r=t[r],i=t[i],[new THREE.Vector2(e.x,e.y),new THREE.Vector2(r.x,r.y),new THREE.Vector2(i.x,i.y)];},generateSideWallUV:function generateSideWallUV(t,e,r,i,n){return e=(t=t.vertices)[e],r=t[r],i=t[i],n=t[n],.01>Math.abs(e.y-r.y)?[new THREE.Vector2(e.x,1-e.z),new THREE.Vector2(r.x,1-r.z),new THREE.Vector2(i.x,1-i.z),new THREE.Vector2(n.x,1-n.z)]:[new THREE.Vector2(e.y,1-e.z),new THREE.Vector2(r.y,1-r.z),new THREE.Vector2(i.y,1-i.z),new THREE.Vector2(n.y,1-n.z)];}},THREE.ShapeGeometry=function(t,e){THREE.Geometry.call(this),this.type="ShapeGeometry",!1===Array.isArray(t)&&(t=[t]),this.addShapeList(t,e),this.computeFaceNormals();},THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.constructor=THREE.ShapeGeometry,THREE.ShapeGeometry.prototype.addShapeList=function(t,e){for(var r=0,i=t.length;r<i;r++){this.addShape(t[r],e);}return this;},THREE.ShapeGeometry.prototype.addShape=function(t,e){void 0===e&&(e={});var r,i,n,o=e.material,a=void 0===e.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:e.UVGenerator,s=this.vertices.length,h=(r=t.extractPoints(void 0!==e.curveSegments?e.curveSegments:12)).shape,c=r.holes;if(!THREE.ShapeUtils.isClockWise(h))for(h=h.reverse(),r=0,i=c.length;r<i;r++){n=c[r],THREE.ShapeUtils.isClockWise(n)&&(c[r]=n.reverse());}var l=THREE.ShapeUtils.triangulateShape(h,c);for(r=0,i=c.length;r<i;r++){n=c[r],h=h.concat(n);}for(c=h.length,i=l.length,r=0;r<c;r++){n=h[r],this.vertices.push(new THREE.Vector3(n.x,n.y,0));}for(r=0;r<i;r++){h=(c=l[r])[0]+s,n=c[1]+s,c=c[2]+s,this.faces.push(new THREE.Face3(h,n,c,null,null,o)),this.faceVertexUvs[0].push(a.generateTopUV(this,h,n,c));}},THREE.LatheGeometry=function(t,e,r,i){THREE.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:r,phiLength:i},e=e||12,r=r||0,i=i||2*Math.PI;for(var n=1/(t.length-1),o=1/e,a=0,s=e;a<=s;a++){for(var h=r+a*o*i,c=Math.sin(h),l=Math.cos(h),u=(h=0,t.length);h<u;h++){var d=t[h];(p=new THREE.Vector3()).x=d.x*c,p.y=d.y,p.z=d.x*l,this.vertices.push(p);}}for(r=t.length,a=0,s=e;a<s;a++){for(h=0,u=t.length-1;h<u;h++){i=(e=h+r*a)+r;c=e+1+r,l=e+1;var p,E=(d=a*o)+o,f=(p=h*n)+n;this.faces.push(new THREE.Face3(e,i,l)),this.faceVertexUvs[0].push([new THREE.Vector2(d,p),new THREE.Vector2(E,p),new THREE.Vector2(d,f)]),this.faces.push(new THREE.Face3(i,c,l)),this.faceVertexUvs[0].push([new THREE.Vector2(E,p),new THREE.Vector2(E,f),new THREE.Vector2(d,f)]);}}this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals();},THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.LatheGeometry.prototype.constructor=THREE.LatheGeometry,THREE.PlaneGeometry=function(t,e,r,i){THREE.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:i},this.fromBufferGeometry(new THREE.PlaneBufferGeometry(t,e,r,i));},THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry,THREE.PlaneBufferGeometry=function(t,e,r,i){THREE.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:i};var n=t/2,o=e/2,a=(r=Math.floor(r)||1)+1,s=(i=Math.floor(i)||1)+1,h=t/r,c=e/i;e=new Float32Array(a*s*3),t=new Float32Array(a*s*3);for(var l=new Float32Array(a*s*2),u=0,d=0,p=0;p<s;p++){for(var E=p*c-o,f=0;f<a;f++){e[u]=f*h-n,e[u+1]=-E,t[u+2]=1,l[d]=f/r,l[d+1]=1-p/i,u+=3,d+=2;}}for(u=0,n=new(65535<e.length/3?Uint32Array:Uint16Array)(r*i*6),p=0;p<i;p++){for(f=0;f<r;f++){o=f+a*(p+1),s=f+1+a*(p+1),h=f+1+a*p,n[u]=f+a*p,n[u+1]=o,n[u+2]=h,n[u+3]=o,n[u+4]=s,n[u+5]=h,u+=6;}}this.setIndex(new THREE.BufferAttribute(n,1)),this.addAttribute("position",new THREE.BufferAttribute(e,3)),this.addAttribute("normal",new THREE.BufferAttribute(t,3)),this.addAttribute("uv",new THREE.BufferAttribute(l,2));},THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.PlaneBufferGeometry.prototype.constructor=THREE.PlaneBufferGeometry,THREE.RingGeometry=function(t,e,r,i,n,o){THREE.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:r,phiSegments:i,thetaStart:n,thetaLength:o},t=t||0,e=e||50,n=void 0!==n?n:0,o=void 0!==o?o:2*Math.PI,r=void 0!==r?Math.max(3,r):8;var a,s=[],h=t,c=(e-t)/(i=void 0!==i?Math.max(1,i):8);for(t=0;t<i+1;t++){for(a=0;a<r+1;a++){var l=new THREE.Vector3(),u=n+a/r*o;l.x=h*Math.cos(u),l.y=h*Math.sin(u),this.vertices.push(l),s.push(new THREE.Vector2((l.x/e+1)/2,(l.y/e+1)/2));}h+=c;}for(e=new THREE.Vector3(0,0,1),t=0;t<i;t++){for(n=t*(r+1),a=0;a<r;a++){o=u=a+n,c=u+r+1,l=u+r+2,this.faces.push(new THREE.Face3(o,c,l,[e.clone(),e.clone(),e.clone()])),this.faceVertexUvs[0].push([s[o].clone(),s[c].clone(),s[l].clone()]),o=u,c=u+r+2,l=u+1,this.faces.push(new THREE.Face3(o,c,l,[e.clone(),e.clone(),e.clone()])),this.faceVertexUvs[0].push([s[o].clone(),s[c].clone(),s[l].clone()]);}}this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3(),h);},THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.RingGeometry.prototype.constructor=THREE.RingGeometry,THREE.SphereGeometry=function(t,e,r,i,n,o,a){THREE.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:r,phiStart:i,phiLength:n,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new THREE.SphereBufferGeometry(t,e,r,i,n,o,a));},THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry,THREE.SphereBufferGeometry=function(t,e,r,i,n,o,a){THREE.BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:r,phiStart:i,phiLength:n,thetaStart:o,thetaLength:a},t=t||50,e=Math.max(3,Math.floor(e)||8),r=Math.max(2,Math.floor(r)||6),i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;for(var s=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),h=(e+1)*(r+1),c=new THREE.BufferAttribute(new Float32Array(3*h),3),l=new THREE.BufferAttribute(new Float32Array(3*h),3),u=(h=new THREE.BufferAttribute(new Float32Array(2*h),2),0),d=[],p=new THREE.Vector3(),E=0;E<=r;E++){for(var f=[],m=E/r,g=0;g<=e;g++){var T=g/e,v=-t*Math.cos(i+T*n)*Math.sin(o+m*a),y=t*Math.cos(o+m*a),R=t*Math.sin(i+T*n)*Math.sin(o+m*a);p.set(v,y,R).normalize(),c.setXYZ(u,v,y,R),l.setXYZ(u,p.x,p.y,p.z),h.setXY(u,T,1-m),f.push(u),u++;}d.push(f);}for(i=[],E=0;E<r;E++){for(g=0;g<e;g++){n=d[E][g+1],a=d[E][g],u=d[E+1][g],p=d[E+1][g+1],(0!==E||0<o)&&i.push(n,a,p),(E!==r-1||s<Math.PI)&&i.push(a,u,p);}}this.setIndex(new(65535<c.count?THREE.Uint32Attribute:THREE.Uint16Attribute)(i,1)),this.addAttribute("position",c),this.addAttribute("normal",l),this.addAttribute("uv",h),this.boundingSphere=new THREE.Sphere(new THREE.Vector3(),t);},THREE.SphereBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.SphereBufferGeometry.prototype.constructor=THREE.SphereBufferGeometry,THREE.TextGeometry=function(t,e){var r=(e=e||{}).font;if(!1==r instanceof THREE.Font)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new THREE.Geometry();r=r.generateShapes(t,e.size,e.curveSegments),e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),THREE.ExtrudeGeometry.call(this,r,e),this.type="TextGeometry";},THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype),THREE.TextGeometry.prototype.constructor=THREE.TextGeometry,THREE.TorusGeometry=function(t,e,r,i,n){THREE.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:r,tubularSegments:i,arc:n},t=t||100,e=e||40,r=r||8,i=i||6,n=n||2*Math.PI;for(var o=new THREE.Vector3(),a=[],s=[],h=0;h<=r;h++){for(var c=0;c<=i;c++){var l=c/i*n,u=h/r*Math.PI*2;o.x=t*Math.cos(l),o.y=t*Math.sin(l);var d=new THREE.Vector3();d.x=(t+e*Math.cos(u))*Math.cos(l),d.y=(t+e*Math.cos(u))*Math.sin(l),d.z=e*Math.sin(u),this.vertices.push(d),a.push(new THREE.Vector2(c/i,h/r)),s.push(d.clone().sub(o).normalize());}}for(h=1;h<=r;h++){for(c=1;c<=i;c++){t=(i+1)*h+c-1,e=(i+1)*(h-1)+c-1,n=(i+1)*(h-1)+c,o=(i+1)*h+c,l=new THREE.Face3(t,e,o,[s[t].clone(),s[e].clone(),s[o].clone()]),this.faces.push(l),this.faceVertexUvs[0].push([a[t].clone(),a[e].clone(),a[o].clone()]),l=new THREE.Face3(e,n,o,[s[e].clone(),s[n].clone(),s[o].clone()]),this.faces.push(l),this.faceVertexUvs[0].push([a[e].clone(),a[n].clone(),a[o].clone()]);}}this.computeFaceNormals();},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusGeometry.prototype.constructor=THREE.TorusGeometry,THREE.TorusKnotGeometry=function(t,e,r,i,n,o,a){function s(t,e,r,i,n){var o=Math.cos(t),a=Math.sin(t);return t*=e/r,o*=i*(2+(e=Math.cos(t)))*.5,a=i*(2+e)*a*.5,i=n*i*Math.sin(t)*.5,new THREE.Vector3(o,a,i);}THREE.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,radialSegments:r,tubularSegments:i,p:n,q:o,heightScale:a},t=t||100,e=e||40,r=r||64,i=i||8,n=n||2,o=o||3,a=a||1;for(var h=Array(r),c=new THREE.Vector3(),l=new THREE.Vector3(),u=new THREE.Vector3(),d=0;d<r;++d){h[d]=Array(i);var p=s(E=d/r*2*n*Math.PI,o,n,t,a),E=s(E+.01,o,n,t,a);for(c.subVectors(E,p),l.addVectors(E,p),u.crossVectors(c,l),l.crossVectors(u,c),u.normalize(),l.normalize(),E=0;E<i;++E){var f=E/i*2*Math.PI,m=-e*Math.cos(f),g=(f=e*Math.sin(f),new THREE.Vector3());g.x=p.x+m*l.x+f*u.x,g.y=p.y+m*l.y+f*u.y,g.z=p.z+m*l.z+f*u.z,h[d][E]=this.vertices.push(g)-1;}}for(d=0;d<r;++d){for(E=0;E<i;++E){n=(d+1)%r,o=(E+1)%i,t=h[d][E],e=h[n][E],n=h[n][o],o=h[d][o],a=new THREE.Vector2(d/r,E/i),c=new THREE.Vector2((d+1)/r,E/i),l=new THREE.Vector2((d+1)/r,(E+1)/i),u=new THREE.Vector2(d/r,(E+1)/i),this.faces.push(new THREE.Face3(t,e,o)),this.faceVertexUvs[0].push([a,c,u]),this.faces.push(new THREE.Face3(e,n,o)),this.faceVertexUvs[0].push([c.clone(),l,u.clone()]);}}this.computeFaceNormals(),this.computeVertexNormals();},THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry.prototype.constructor=THREE.TorusKnotGeometry,THREE.TubeGeometry=function(t,e,r,i,n,o){THREE.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:t,segments:e,radius:r,radialSegments:i,closed:n,taper:o},e=e||64,r=r||1,i=i||8,n=n||!1,o=o||THREE.TubeGeometry.NoTaper;var a,s,h,c,l,u,d,p,E,f,m=[],g=e+1,T=new THREE.Vector3();for(E=(p=new THREE.TubeGeometry.FrenetFrames(t,e,n)).normals,f=p.binormals,this.tangents=p.tangents,this.normals=E,this.binormals=f,p=0;p<g;p++){for(m[p]=[],h=p/(g-1),d=t.getPointAt(h),a=E[p],s=f[p],l=r*o(h),h=0;h<i;h++){c=h/i*2*Math.PI,u=-l*Math.cos(c),c=l*Math.sin(c),T.copy(d),T.x+=u*a.x+c*s.x,T.y+=u*a.y+c*s.y,T.z+=u*a.z+c*s.z,m[p][h]=this.vertices.push(new THREE.Vector3(T.x,T.y,T.z))-1;}}for(p=0;p<e;p++){for(h=0;h<i;h++){o=n?(p+1)%e:p+1,g=(h+1)%i,t=m[p][h],r=m[o][h],o=m[o][g],g=m[p][g],T=new THREE.Vector2(p/e,h/i),E=new THREE.Vector2((p+1)/e,h/i),f=new THREE.Vector2((p+1)/e,(h+1)/i),a=new THREE.Vector2(p/e,(h+1)/i),this.faces.push(new THREE.Face3(t,r,g)),this.faceVertexUvs[0].push([T,E,a]),this.faces.push(new THREE.Face3(r,o,g)),this.faceVertexUvs[0].push([E.clone(),f,a.clone()]);}}this.computeFaceNormals(),this.computeVertexNormals();},THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.prototype.constructor=THREE.TubeGeometry,THREE.TubeGeometry.NoTaper=function(t){return 1;},THREE.TubeGeometry.SinusoidalTaper=function(t){return Math.sin(Math.PI*t);},THREE.TubeGeometry.FrenetFrames=function(t,e,r){var i,n,o,a=new THREE.Vector3(),s=[],h=[],c=[],l=new THREE.Vector3(),u=new THREE.Matrix4();for(e+=1,this.tangents=s,this.normals=h,this.binormals=c,i=0;i<e;i++){n=i/(e-1),s[i]=t.getTangentAt(n),s[i].normalize();}for(h[0]=new THREE.Vector3(),c[0]=new THREE.Vector3(),t=Number.MAX_VALUE,i=Math.abs(s[0].x),n=Math.abs(s[0].y),o=Math.abs(s[0].z),i<=t&&(t=i,a.set(1,0,0)),n<=t&&(t=n,a.set(0,1,0)),o<=t&&a.set(0,0,1),l.crossVectors(s[0],a).normalize(),h[0].crossVectors(s[0],l),c[0].crossVectors(s[0],h[0]),i=1;i<e;i++){h[i]=h[i-1].clone(),c[i]=c[i-1].clone(),l.crossVectors(s[i-1],s[i]),l.length()>Number.EPSILON&&(l.normalize(),a=Math.acos(THREE.Math.clamp(s[i-1].dot(s[i]),-1,1)),h[i].applyMatrix4(u.makeRotationAxis(l,a))),c[i].crossVectors(s[i],h[i]);}if(r)for(a=Math.acos(THREE.Math.clamp(h[0].dot(h[e-1]),-1,1)),a/=e-1,0<s[0].dot(l.crossVectors(h[0],h[e-1]))&&(a=-a),i=1;i<e;i++){h[i].applyMatrix4(u.makeRotationAxis(s[i],a*i)),c[i].crossVectors(s[i],h[i]);}},THREE.PolyhedronGeometry=function(t,e,r,i){function n(t){var e=t.normalize().clone();e.index=h.vertices.push(e)-1;var r=Math.atan2(t.z,-t.x)/2/Math.PI+.5;return t=Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5,e.uv=new THREE.Vector2(r,1-t),e;}function o(t,e,r,i){i=new THREE.Face3(t.index,e.index,r.index,[t.clone(),e.clone(),r.clone()],void 0,i),h.faces.push(i),m.copy(t).add(e).add(r).divideScalar(3),i=Math.atan2(m.z,-m.x),h.faceVertexUvs[0].push([s(t.uv,t,i),s(e.uv,e,i),s(r.uv,r,i)]);}function a(t,e){for(var r=Math.pow(2,e),i=n(h.vertices[t.a]),a=n(h.vertices[t.b]),s=n(h.vertices[t.c]),c=[],l=t.materialIndex,u=0;u<=r;u++){c[u]=[];for(var d=n(i.clone().lerp(s,u/r)),p=n(a.clone().lerp(s,u/r)),E=r-u,f=0;f<=E;f++){c[u][f]=0===f&&u===r?d:n(d.clone().lerp(p,f/E));}}for(u=0;u<r;u++){for(f=0;f<2*(r-u)-1;f++){i=Math.floor(f/2),0==f%2?o(c[u][i+1],c[u+1][i],c[u][i],l):o(c[u][i+1],c[u+1][i+1],c[u+1][i],l);}}}function s(t,e,r){return 0>r&&1===t.x&&(t=new THREE.Vector2(t.x-1,t.y)),0===e.x&&0===e.z&&(t=new THREE.Vector2(r/2/Math.PI+.5,t.y)),t.clone();}THREE.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:r,detail:i},r=r||1,i=i||0;for(var h=this,c=0,l=t.length;c<l;c+=3){n(new THREE.Vector3(t[c],t[c+1],t[c+2]));}t=this.vertices;var u=[],d=c=0;for(l=e.length;c<l;c+=3,d++){var p=t[e[c]],E=t[e[c+1]],f=t[e[c+2]];u[d]=new THREE.Face3(p.index,E.index,f.index,[p.clone(),E.clone(),f.clone()],void 0,d);}var m=new THREE.Vector3();for(c=0,l=u.length;c<l;c++){a(u[c],i);}for(c=0,l=this.faceVertexUvs[0].length;c<l;c++){i=(e=this.faceVertexUvs[0][c])[0].x,t=e[1].x,u=e[2].x,d=Math.max(i,t,u),p=Math.min(i,t,u),.9<d&&.1>p&&(.2>i&&(e[0].x+=1),.2>t&&(e[1].x+=1),.2>u&&(e[2].x+=1));}for(c=0,l=this.vertices.length;c<l;c++){this.vertices[c].multiplyScalar(r);}this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3(),r);},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PolyhedronGeometry.prototype.constructor=THREE.PolyhedronGeometry,THREE.DodecahedronGeometry=function(t,e){var r=(1+Math.sqrt(5))/2,i=1/r;THREE.PolyhedronGeometry.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e};},THREE.DodecahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype),THREE.DodecahedronGeometry.prototype.constructor=THREE.DodecahedronGeometry,THREE.IcosahedronGeometry=function(t,e){var r=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e};},THREE.IcosahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype);THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry,THREE.OctahedronGeometry=function(t,e){THREE.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e};},THREE.OctahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype),THREE.OctahedronGeometry.prototype.constructor=THREE.OctahedronGeometry,THREE.TetrahedronGeometry=function(t,e){THREE.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e};},THREE.TetrahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype),THREE.TetrahedronGeometry.prototype.constructor=THREE.TetrahedronGeometry,THREE.ParametricGeometry=function(t,e,r){THREE.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:r};var i,n,o,a,s,h,c,l,u=this.vertices,d=this.faces,p=this.faceVertexUvs[0],E=e+1;for(i=0;i<=r;i++){for(a=i/r,n=0;n<=e;n++){o=t(o=n/e,a),u.push(o);}}for(i=0;i<r;i++){for(n=0;n<e;n++){t=i*E+n,u=i*E+n+1,a=(i+1)*E+n+1,o=(i+1)*E+n,s=new THREE.Vector2(n/e,i/r),h=new THREE.Vector2((n+1)/e,i/r),c=new THREE.Vector2((n+1)/e,(i+1)/r),l=new THREE.Vector2(n/e,(i+1)/r),d.push(new THREE.Face3(t,u,o)),p.push([s,h,l]),d.push(new THREE.Face3(u,a,o)),p.push([h.clone(),c,l.clone()]);}}this.computeFaceNormals(),this.computeVertexNormals();},THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ParametricGeometry.prototype.constructor=THREE.ParametricGeometry,THREE.WireframeGeometry=function(t){function e(t,e){return t-e;}THREE.BufferGeometry.call(this);var r=[0,0],i={},n=["a","b","c"];if(t instanceof THREE.Geometry){var o=t.vertices,a=t.faces,s=0,h=new Uint32Array(6*a.length);t=0;for(var c=a.length;t<c;t++){for(var l=a[t],u=0;3>u;u++){r[0]=l[n[u]],r[1]=l[n[(u+1)%3]],r.sort(e);var d=r.toString();void 0===i[d]&&(h[2*s]=r[0],h[2*s+1]=r[1],i[d]=!0,s++);}}for(r=new Float32Array(6*s),t=0,c=s;t<c;t++){for(u=0;2>u;u++){i=o[h[2*t+u]],r[(s=6*t+3*u)+0]=i.x,r[s+1]=i.y,r[s+2]=i.z;}}this.addAttribute("position",new THREE.BufferAttribute(r,3));}else if(t instanceof THREE.BufferGeometry){if(null!==t.index){for(c=t.index.array,o=t.attributes.position,s=0,0===(n=t.groups).length&&t.addGroup(0,c.length),h=new Uint32Array(2*c.length),a=0,l=n.length;a<l;++a){u=(t=n[a]).start,d=t.count,t=u;for(var p=u+d;t<p;t+=3){for(u=0;3>u;u++){r[0]=c[t+u],r[1]=c[t+(u+1)%3],r.sort(e),void 0===i[d=r.toString()]&&(h[2*s]=r[0],h[2*s+1]=r[1],i[d]=!0,s++);}}}for(r=new Float32Array(6*s),t=0,c=s;t<c;t++){for(u=0;2>u;u++){s=6*t+3*u,i=h[2*t+u],r[s+0]=o.getX(i),r[s+1]=o.getY(i),r[s+2]=o.getZ(i);}}}else for(h=(s=(o=t.attributes.position.array).length/3)/3,r=new Float32Array(6*s),t=0,c=h;t<c;t++){for(u=0;3>u;u++){h=9*t+3*u,r[(s=18*t+6*u)+0]=o[h],r[s+1]=o[h+1],r[s+2]=o[h+2],i=9*t+(u+1)%3*3,r[s+3]=o[i],r[s+4]=o[i+1],r[s+5]=o[i+2];}}this.addAttribute("position",new THREE.BufferAttribute(r,3));}},THREE.WireframeGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.WireframeGeometry.prototype.constructor=THREE.WireframeGeometry,THREE.AxisHelper=function(t){t=t||1;var e=new Float32Array([0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t]),r=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]);(t=new THREE.BufferGeometry()).addAttribute("position",new THREE.BufferAttribute(e,3)),t.addAttribute("color",new THREE.BufferAttribute(r,3)),e=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors}),THREE.LineSegments.call(this,t,e);},THREE.AxisHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.AxisHelper.prototype.constructor=THREE.AxisHelper,THREE.ArrowHelper=function(){var t=new THREE.Geometry();t.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0));var e=new THREE.CylinderGeometry(0,.5,1,5,1);return e.translate(0,-.5,0),function(r,i,n,o,a,s){THREE.Object3D.call(this),void 0===o&&(o=16776960),void 0===n&&(n=1),void 0===a&&(a=.2*n),void 0===s&&(s=.2*a),this.position.copy(i),this.line=new THREE.Line(t,new THREE.LineBasicMaterial({color:o})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new THREE.Mesh(e,new THREE.MeshBasicMaterial({color:o})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(r),this.setLength(n,a,s);};}(),THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.ArrowHelper.prototype.constructor=THREE.ArrowHelper,THREE.ArrowHelper.prototype.setDirection=function(){var t,e=new THREE.Vector3();return function(r){.99999<r.y?this.quaternion.set(0,0,0,1):-.99999>r.y?this.quaternion.set(1,0,0,0):(e.set(r.z,0,-r.x).normalize(),t=Math.acos(r.y),this.quaternion.setFromAxisAngle(e,t));};}(),THREE.ArrowHelper.prototype.setLength=function(t,e,r){void 0===e&&(e=.2*t),void 0===r&&(r=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(r,e,r),this.cone.position.y=t,this.cone.updateMatrix();},THREE.ArrowHelper.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t);},THREE.BoxHelper=function(t){var e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new THREE.BufferGeometry();i.setIndex(new THREE.BufferAttribute(e,1)),i.addAttribute("position",new THREE.BufferAttribute(r,3)),THREE.LineSegments.call(this,i,new THREE.LineBasicMaterial({color:16776960})),void 0!==t&&this.update(t);},THREE.BoxHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.BoxHelper.prototype.constructor=THREE.BoxHelper,THREE.BoxHelper.prototype.update=function(){var t=new THREE.Box3();return function(e){if(t.setFromObject(e),!t.isEmpty()){e=t.min;var r=t.max,i=this.geometry.attributes.position,n=i.array;n[0]=r.x,n[1]=r.y,n[2]=r.z,n[3]=e.x,n[4]=r.y,n[5]=r.z,n[6]=e.x,n[7]=e.y,n[8]=r.z,n[9]=r.x,n[10]=e.y,n[11]=r.z,n[12]=r.x,n[13]=r.y,n[14]=e.z,n[15]=e.x,n[16]=r.y,n[17]=e.z,n[18]=e.x,n[19]=e.y,n[20]=e.z,n[21]=r.x,n[22]=e.y,n[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere();}};}(),THREE.BoundingBoxHelper=function(t,e){var r=void 0!==e?e:8947848;this.object=t,this.box=new THREE.Box3(),THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:r,wireframe:!0}));},THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.BoundingBoxHelper.prototype.constructor=THREE.BoundingBoxHelper,THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position);},THREE.CameraHelper=function(t){function e(t,e,i){r(t,i),r(e,i);}function r(t,e){i.vertices.push(new THREE.Vector3()),i.colors.push(new THREE.Color(e)),void 0===o[t]&&(o[t]=[]),o[t].push(i.vertices.length-1);}var i=new THREE.Geometry(),n=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),o={};e("n1","n2",16755200),e("n2","n4",16755200),e("n4","n3",16755200),e("n3","n1",16755200),e("f1","f2",16755200),e("f2","f4",16755200),e("f4","f3",16755200),e("f3","f1",16755200),e("n1","f1",16755200),e("n2","f2",16755200),e("n3","f3",16755200),e("n4","f4",16755200),e("p","n1",16711680),e("p","n2",16711680),e("p","n3",16711680),e("p","n4",16711680),e("u1","u2",43775),e("u2","u3",43775),e("u3","u1",43775),e("c","t",16777215),e("p","c",3355443),e("cn1","cn2",3355443),e("cn3","cn4",3355443),e("cf1","cf2",3355443),e("cf3","cf4",3355443),THREE.LineSegments.call(this,i,n),this.camera=t,this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();},THREE.CameraHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.CameraHelper.prototype.constructor=THREE.CameraHelper,THREE.CameraHelper.prototype.update=function(){function t(t,o,a,s){if(i.set(o,a,s).unproject(n),void 0!==(t=r[t]))for(o=0,a=t.length;o<a;o++){e.vertices[t[o]].copy(i);}}var e,r,i=new THREE.Vector3(),n=new THREE.Camera();return function(){e=this.geometry,r=this.pointMap,n.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-1,-1,-1),t("n2",1,-1,-1),t("n3",-1,1,-1),t("n4",1,1,-1),t("f1",-1,-1,1),t("f2",1,-1,1),t("f3",-1,1,1),t("f4",1,1,1),t("u1",.7,1.1,-1),t("u2",-.7,1.1,-1),t("u3",0,2,-1),t("cf1",-1,0,1),t("cf2",1,0,1),t("cf3",0,-1,1),t("cf4",0,1,1),t("cn1",-1,0,-1),t("cn2",1,0,-1),t("cn3",0,-1,-1),t("cn4",0,1,-1),e.verticesNeedUpdate=!0;};}(),THREE.DirectionalLightHelper=function(t,e){THREE.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,e=e||1;var r=new THREE.Geometry();r.vertices.push(new THREE.Vector3(-e,e,0),new THREE.Vector3(e,e,0),new THREE.Vector3(e,-e,0),new THREE.Vector3(-e,-e,0),new THREE.Vector3(-e,e,0));var i=new THREE.LineBasicMaterial({fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new THREE.Line(r,i),this.add(this.lightPlane),(r=new THREE.Geometry()).vertices.push(new THREE.Vector3(),new THREE.Vector3()),(i=new THREE.LineBasicMaterial({fog:!1})).color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new THREE.Line(r,i),this.add(this.targetLine),this.update();},THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.DirectionalLightHelper.prototype.constructor=THREE.DirectionalLightHelper,THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose();},THREE.DirectionalLightHelper.prototype.update=function(){var t=new THREE.Vector3(),e=new THREE.Vector3(),r=new THREE.Vector3();return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),r.subVectors(e,t),this.lightPlane.lookAt(r),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(r),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color);};}(),THREE.EdgesHelper=function(t,e,r){e=void 0!==e?e:16777215,THREE.LineSegments.call(this,new THREE.EdgesGeometry(t.geometry,r),new THREE.LineBasicMaterial({color:e})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;},THREE.EdgesHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.EdgesHelper.prototype.constructor=THREE.EdgesHelper,THREE.FaceNormalsHelper=function(t,e,r,i){this.object=t,this.size=void 0!==e?e:1,t=void 0!==r?r:16776960,i=void 0!==i?i:1,e=0,(r=this.object.geometry)instanceof THREE.Geometry?e=r.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),r=new THREE.BufferGeometry(),e=new THREE.Float32Attribute(6*e,3),r.addAttribute("position",e),THREE.LineSegments.call(this,r,new THREE.LineBasicMaterial({color:t,linewidth:i})),this.matrixAutoUpdate=!1,this.update();},THREE.FaceNormalsHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.FaceNormalsHelper.prototype.constructor=THREE.FaceNormalsHelper,THREE.FaceNormalsHelper.prototype.update=function(){var t=new THREE.Vector3(),e=new THREE.Vector3(),r=new THREE.Matrix3();return function(){this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);for(var i,n=this.object.matrixWorld,o=this.geometry.attributes.position,a=(i=this.object.geometry).vertices,s=0,h=0,c=(i=i.faces).length;h<c;h++){var l=i[h],u=l.normal;t.copy(a[l.a]).add(a[l.b]).add(a[l.c]).divideScalar(3).applyMatrix4(n),e.copy(u).applyMatrix3(r).normalize().multiplyScalar(this.size).add(t),o.setXYZ(s,t.x,t.y,t.z),s+=1,o.setXYZ(s,e.x,e.y,e.z),s+=1;}return o.needsUpdate=!0,this;};}(),THREE.GridHelper=function(t,e){var r=new THREE.Geometry(),i=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924),this.color2=new THREE.Color(8947848);for(var n=-t;n<=t;n+=e){r.vertices.push(new THREE.Vector3(-t,0,n),new THREE.Vector3(t,0,n),new THREE.Vector3(n,0,-t),new THREE.Vector3(n,0,t));var o=0===n?this.color1:this.color2;r.colors.push(o,o,o,o);}THREE.LineSegments.call(this,r,i);},THREE.GridHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.GridHelper.prototype.constructor=THREE.GridHelper,THREE.GridHelper.prototype.setColors=function(t,e){this.color1.set(t),this.color2.set(e),this.geometry.colorsNeedUpdate=!0;},THREE.HemisphereLightHelper=function(t,e){THREE.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new THREE.Color(),new THREE.Color()];var r=new THREE.SphereGeometry(e,4,2);r.rotateX(-Math.PI/2);for(var i=0;8>i;i++){r.faces[i].color=this.colors[4>i?0:1];}i=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0}),this.lightSphere=new THREE.Mesh(r,i),this.add(this.lightSphere),this.update();},THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.HemisphereLightHelper.prototype.constructor=THREE.HemisphereLightHelper,THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose();},THREE.HemisphereLightHelper.prototype.update=function(){var t=new THREE.Vector3();return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0;};}(),THREE.PointLightHelper=function(t,e){this.light=t,this.light.updateMatrixWorld();var r=new THREE.SphereGeometry(e,4,2),i=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),THREE.Mesh.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1;},THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.PointLightHelper.prototype.constructor=THREE.PointLightHelper,THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose();},THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);},THREE.SkeletonHelper=function(t){this.bones=this.getBoneList(t);for(var e=new THREE.Geometry(),r=0;r<this.bones.length;r++){this.bones[r].parent instanceof THREE.Bone&&(e.vertices.push(new THREE.Vector3()),e.vertices.push(new THREE.Vector3()),e.colors.push(new THREE.Color(0,0,1)),e.colors.push(new THREE.Color(0,1,0)));}e.dynamic=!0,r=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0}),THREE.LineSegments.call(this,e,r),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update();},THREE.SkeletonHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.SkeletonHelper.prototype.constructor=THREE.SkeletonHelper,THREE.SkeletonHelper.prototype.getBoneList=function(t){var e=[];t instanceof THREE.Bone&&e.push(t);for(var r=0;r<t.children.length;r++){e.push.apply(e,this.getBoneList(t.children[r]));}return e;},THREE.SkeletonHelper.prototype.update=function(){for(var t=this.geometry,e=new THREE.Matrix4().getInverse(this.root.matrixWorld),r=new THREE.Matrix4(),i=0,n=0;n<this.bones.length;n++){var o=this.bones[n];o.parent instanceof THREE.Bone&&(r.multiplyMatrices(e,o.matrixWorld),t.vertices[i].setFromMatrixPosition(r),r.multiplyMatrices(e,o.parent.matrixWorld),t.vertices[i+1].setFromMatrixPosition(r),i+=2);}t.verticesNeedUpdate=!0,t.computeBoundingSphere();},THREE.SpotLightHelper=function(t){THREE.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,(t=new THREE.CylinderGeometry(0,1,1,8,1,!0)).translate(0,-.5,0),t.rotateX(-Math.PI/2);var e=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(t,e),this.add(this.cone),this.update();},THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.SpotLightHelper.prototype.constructor=THREE.SpotLightHelper,THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose();},THREE.SpotLightHelper.prototype.update=function(){var t=new THREE.Vector3(),e=new THREE.Vector3();return function(){var r=this.light.distance?this.light.distance:1e4,i=r*Math.tan(this.light.angle);this.cone.scale.set(i,i,r),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);};}(),THREE.VertexNormalsHelper=function(t,e,r,i){this.object=t,this.size=void 0!==e?e:1,t=void 0!==r?r:16711680,i=void 0!==i?i:1,e=0,(r=this.object.geometry)instanceof THREE.Geometry?e=3*r.faces.length:r instanceof THREE.BufferGeometry&&(e=r.attributes.normal.count),r=new THREE.BufferGeometry(),e=new THREE.Float32Attribute(6*e,3),r.addAttribute("position",e),THREE.LineSegments.call(this,r,new THREE.LineBasicMaterial({color:t,linewidth:i})),this.matrixAutoUpdate=!1,this.update();},THREE.VertexNormalsHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.VertexNormalsHelper.prototype.constructor=THREE.VertexNormalsHelper,THREE.VertexNormalsHelper.prototype.update=function(){var t=new THREE.Vector3(),e=new THREE.Vector3(),r=new THREE.Matrix3();return function(){var i=["a","b","c"];this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);var n=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a instanceof THREE.Geometry)for(var s=a.vertices,h=a.faces,c=a=0,l=h.length;c<l;c++){for(var u=h[c],d=0,p=u.vertexNormals.length;d<p;d++){var E=u.vertexNormals[d];t.copy(s[u[i[d]]]).applyMatrix4(n),e.copy(E).applyMatrix3(r).normalize().multiplyScalar(this.size).add(t),o.setXYZ(a,t.x,t.y,t.z),a+=1,o.setXYZ(a,e.x,e.y,e.z),a+=1;}}else if(a instanceof THREE.BufferGeometry)for(i=a.attributes.position,s=a.attributes.normal,d=a=0,p=i.count;d<p;d++){t.set(i.getX(d),i.getY(d),i.getZ(d)).applyMatrix4(n),e.set(s.getX(d),s.getY(d),s.getZ(d)),e.applyMatrix3(r).normalize().multiplyScalar(this.size).add(t),o.setXYZ(a,t.x,t.y,t.z),a+=1,o.setXYZ(a,e.x,e.y,e.z),a+=1;}return o.needsUpdate=!0,this;};}(),THREE.WireframeHelper=function(t,e){var r=void 0!==e?e:16777215;THREE.LineSegments.call(this,new THREE.WireframeGeometry(t.geometry),new THREE.LineBasicMaterial({color:r})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;},THREE.WireframeHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.WireframeHelper.prototype.constructor=THREE.WireframeHelper,THREE.ImmediateRenderObject=function(t){THREE.Object3D.call(this),this.material=t,this.render=function(t){};},THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype),THREE.ImmediateRenderObject.prototype.constructor=THREE.ImmediateRenderObject,THREE.MorphBlendMesh=function(t,e){THREE.Mesh.call(this,t,e),this.animationsMap={},this.animationsList=[];var r=this.geometry.morphTargets.length;this.createAnimation("__default",0,r-1,r/1),this.setAnimationWeight("__default",1);},THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.constructor=THREE.MorphBlendMesh,THREE.MorphBlendMesh.prototype.createAnimation=function(t,e,r,i){e={start:e,end:r,length:r-e+1,fps:i,duration:(r-e)/i,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1},this.animationsMap[t]=e,this.animationsList.push(e);},THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(t){for(var e,r=/([a-z]+)_?(\d+)/i,i={},n=this.geometry,o=0,a=n.morphTargets.length;o<a;o++){var s=n.morphTargets[o].name.match(r);if(s&&1<s.length){var h=s[1];i[h]||(i[h]={start:1/0,end:-1/0}),o<(s=i[h]).start&&(s.start=o),o>s.end&&(s.end=o),e||(e=h);}}for(h in i){s=i[h],this.createAnimation(h,s.start,s.end,t);}this.firstAnimation=e;},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(t){(t=this.animationsMap[t])&&(t.direction=1,t.directionBackwards=!1);},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(t){(t=this.animationsMap[t])&&(t.direction=-1,t.directionBackwards=!0);},THREE.MorphBlendMesh.prototype.setAnimationFPS=function(t,e){var r=this.animationsMap[t];r&&(r.fps=e,r.duration=(r.end-r.start)/r.fps);},THREE.MorphBlendMesh.prototype.setAnimationDuration=function(t,e){var r=this.animationsMap[t];r&&(r.duration=e,r.fps=(r.end-r.start)/r.duration);},THREE.MorphBlendMesh.prototype.setAnimationWeight=function(t,e){var r=this.animationsMap[t];r&&(r.weight=e);},THREE.MorphBlendMesh.prototype.setAnimationTime=function(t,e){var r=this.animationsMap[t];r&&(r.time=e);},THREE.MorphBlendMesh.prototype.getAnimationTime=function(t){var e=0;return(t=this.animationsMap[t])&&(e=t.time),e;},THREE.MorphBlendMesh.prototype.getAnimationDuration=function(t){var e=-1;return(t=this.animationsMap[t])&&(e=t.duration),e;},THREE.MorphBlendMesh.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()");},THREE.MorphBlendMesh.prototype.stopAnimation=function(t){(t=this.animationsMap[t])&&(t.active=!1);},THREE.MorphBlendMesh.prototype.update=function(t){for(var e=0,r=this.animationsList.length;e<r;e++){var i=this.animationsList[e];if(i.active){var n=i.duration/i.length;i.time+=i.direction*t,i.mirroredLoop?(i.time>i.duration||0>i.time)&&(i.direction*=-1,i.time>i.duration&&(i.time=i.duration,i.directionBackwards=!0),0>i.time&&(i.time=0,i.directionBackwards=!1)):(i.time%=i.duration,0>i.time&&(i.time+=i.duration));var o=i.start+THREE.Math.clamp(Math.floor(i.time/n),0,i.length-1),a=i.weight;o!==i.currentFrame&&(this.morphTargetInfluences[i.lastFrame]=0,this.morphTargetInfluences[i.currentFrame]=1*a,this.morphTargetInfluences[o]=0,i.lastFrame=i.currentFrame,i.currentFrame=o),n=i.time%n/n,i.directionBackwards&&(n=1-n),i.currentFrame!==i.lastFrame?(this.morphTargetInfluences[i.currentFrame]=n*a,this.morphTargetInfluences[i.lastFrame]=(1-n)*a):this.morphTargetInfluences[i.currentFrame]=a;}}},THREE.SpriteCanvasMaterial=function(t){THREE.Material.call(this),this.type="SpriteCanvasMaterial",this.color=new THREE.Color(16777215),this.program=function(t,e){},this.setValues(t);},THREE.SpriteCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteCanvasMaterial.prototype.constructor=THREE.SpriteCanvasMaterial,THREE.SpriteCanvasMaterial.prototype.clone=function(){var t=new THREE.SpriteCanvasMaterial();return t.copy(this),t.color.copy(this.color),t.program=this.program,t;},THREE.CanvasRenderer=function(t){function e(t,e,r){c(r.opacity),l(r.blending);var i=e.scale.x*O,n=e.scale.y*z,o=.5*Math.sqrt(i*i+n*n);if(dt.min.set(t.x-o,t.y-o),dt.max.set(t.x+o,t.y+o),r instanceof THREE.SpriteMaterial){var s=r.map;if(null!==s){var h=ct[s.id];if((void 0===h||h.version!==s.version)&&(h=a(s),ct[s.id]=h),void 0!==h.canvas){f(h.canvas);var u=s.image,d=u.width*s.offset.x,p=u.height*s.offset.y,m=u.width*s.repeat.x,g=u.height*s.repeat.y,T=i/m,v=n/g;Y.save(),Y.translate(t.x,t.y),0!==r.rotation&&Y.rotate(r.rotation),Y.translate(-i/2,-n/2),Y.scale(T,v),Y.translate(-d,-p),Y.fillRect(d,p,m,g),Y.restore();}}else f(r.color.getStyle()),Y.save(),Y.translate(t.x,t.y),0!==r.rotation&&Y.rotate(r.rotation),Y.scale(i,-n),Y.fillRect(-.5,-.5,1,1),Y.restore();}else r instanceof THREE.SpriteCanvasMaterial&&(E(r.color.getStyle()),f(r.color.getStyle()),Y.save(),Y.translate(t.x,t.y),0!==r.rotation&&Y.rotate(r.rotation),Y.scale(i,n),r.program(Y),Y.restore());}function r(t,e,r,i){if(c(i.opacity),l(i.blending),Y.beginPath(),Y.moveTo(t.positionScreen.x,t.positionScreen.y),Y.lineTo(e.positionScreen.x,e.positionScreen.y),i instanceof THREE.LineBasicMaterial){if(u(i.linewidth),d(i.linecap),p(i.linejoin),i.vertexColors!==THREE.VertexColors)E(i.color.getStyle());else{var n=r.vertexColors[0].getStyle(),o=r.vertexColors[1].getStyle();if(n===o)E(n);else{try{var a=Y.createLinearGradient(t.positionScreen.x,t.positionScreen.y,e.positionScreen.x,e.positionScreen.y);a.addColorStop(0,n),a.addColorStop(1,o);}catch(t){a=n;}E(a);}}Y.stroke(),dt.expandByScalar(2*i.linewidth);}else i instanceof THREE.LineDashedMaterial&&(u(i.linewidth),d(i.linecap),p(i.linejoin),E(i.color.getStyle()),m([i.dashSize,i.gapSize]),Y.stroke(),dt.expandByScalar(2*i.linewidth),m([]));}function i(t,e,r,i,a,h,u,d){if(U.info.render.vertices+=3,U.info.render.faces++,c(d.opacity),l(d.blending),x=t.positionScreen.x,b=t.positionScreen.y,_=e.positionScreen.x,M=e.positionScreen.y,w=r.positionScreen.x,S=r.positionScreen.y,function(t,e,r,i,n,o){Y.beginPath(),Y.moveTo(t,e),Y.lineTo(r,i),Y.lineTo(n,o),Y.closePath();}(x,b,_,M,w,S),(d instanceof THREE.MeshLambertMaterial||d instanceof THREE.MeshPhongMaterial)&&null===d.map)at.copy(d.color),st.copy(d.emissive),d.vertexColors===THREE.FaceColors&&at.multiply(u.color),ot.copy(pt),gt.copy(t.positionWorld).add(e.positionWorld).add(r.positionWorld).divideScalar(3),function(t,e,r){for(var i=0,n=v.length;n>i;i++){var o=v[i];if(ht.copy(o.color),o instanceof THREE.DirectionalLight){var a=mt.setFromMatrixPosition(o.matrixWorld).normalize();if(0>=(s=e.dot(a)))continue;s*=o.intensity,r.add(ht.multiplyScalar(s));}else if(o instanceof THREE.PointLight){var s;if(a=mt.setFromMatrixPosition(o.matrixWorld),0>=(s=e.dot(mt.subVectors(a,t).normalize())))continue;if(0==(s*=0==o.distance?1:1-Math.min(t.distanceTo(a)/o.distance,1)))continue;s*=o.intensity,r.add(ht.multiplyScalar(s));}}}(gt,u.normalModel,ot),ot.multiply(at).add(st),!0===d.wireframe?n(ot,d.wireframeLinewidth,d.wireframeLinecap,d.wireframeLinejoin):o(ot);else if(d instanceof THREE.MeshBasicMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.MeshPhongMaterial){if(null!==d.map){d.map.mapping===THREE.UVMapping&&(C=u.uvs,s(x,b,_,M,w,S,C[i].x,C[i].y,C[a].x,C[a].y,C[h].x,C[h].y,d.map));}else null!==d.envMap?d.envMap.mapping===THREE.SphericalReflectionMapping&&(Tt.copy(u.vertexNormalsModel[i]).applyMatrix3(vt),L=.5*Tt.x+.5,A=.5*Tt.y+.5,Tt.copy(u.vertexNormalsModel[a]).applyMatrix3(vt),P=.5*Tt.x+.5,k=.5*Tt.y+.5,Tt.copy(u.vertexNormalsModel[h]).applyMatrix3(vt),I=.5*Tt.x+.5,F=.5*Tt.y+.5,s(x,b,_,M,w,S,L,A,P,k,I,F,d.envMap)):(ot.copy(d.color),d.vertexColors===THREE.FaceColors&&ot.multiply(u.color),!0===d.wireframe?n(ot,d.wireframeLinewidth,d.wireframeLinecap,d.wireframeLinejoin):o(ot));}else d instanceof THREE.MeshNormalMaterial?(Tt.copy(u.normalModel).applyMatrix3(vt),ot.setRGB(Tt.x,Tt.y,Tt.z).multiplyScalar(.5).addScalar(.5),!0===d.wireframe?n(ot,d.wireframeLinewidth,d.wireframeLinecap,d.wireframeLinejoin):o(ot)):(ot.setRGB(1,1,1),!0===d.wireframe?n(ot,d.wireframeLinewidth,d.wireframeLinecap,d.wireframeLinejoin):o(ot));}function n(t,e,r,i){u(e),d(r),p(i),E(t.getStyle()),Y.stroke(),dt.expandByScalar(2*e);}function o(t){f(t.getStyle()),Y.fill();}function a(t){if(0===t.version||t instanceof THREE.CompressedTexture||t instanceof THREE.DataTexture)return{canvas:void 0,version:t.version};var e=t.image;if(!1===e.complete)return{canvas:void 0,version:0};var r=document.createElement("canvas");r.width=e.width,r.height=e.height;var i=r.getContext("2d");i.setTransform(1,0,0,-1,0,e.height),i.drawImage(e,0,0);var n=t.wrapS===THREE.RepeatWrapping,o=t.wrapT===THREE.RepeatWrapping,a="no-repeat";!0===n&&!0===o?a="repeat":!0===n?a="repeat-x":!0===o&&(a="repeat-y");var s=Y.createPattern(r,a);return t.onUpdate&&t.onUpdate(t),{canvas:s,version:t.version};}function s(t,e,r,i,n,o,s,h,c,l,u,d,p){var E=ct[p.id];if((void 0===E||E.version!==p.version)&&(E=a(p),ct[p.id]=E),void 0===E.canvas)return f("rgba( 0, 0, 0, 1)"),void Y.fill();f(E.canvas);var m,g,T,v,y,R,H,x,b=p.offset.x/p.repeat.x,_=p.offset.y/p.repeat.y,M=p.image.width*p.repeat.x,w=p.image.height*p.repeat.y;c=(c+b)*M,l=(l+_)*w,u=(u+b)*M,d=(d+_)*w,r-=t,i-=e,n-=t,o-=e,0!==(H=(c-=s=(s+b)*M)*(d-=h=(h+_)*w)-(u-=s)*(l-=h))&&(y=t-(m=(d*r-l*n)*(x=1/H))*s-(T=(c*n-u*r)*x)*h,R=e-(g=(d*i-l*o)*x)*s-(v=(c*o-u*i)*x)*h,Y.save(),Y.transform(m,g,T,v,y,R),Y.fill(),Y.restore());}function h(t,e,r){var i,n=e.x-t.x,o=e.y-t.y,a=n*n+o*o;0!==a&&(n*=i=r/Math.sqrt(a),o*=i,e.x+=n,e.y+=o,t.x-=n,t.y-=o);}function c(t){K!==t&&(Y.globalAlpha=t,K=t);}function l(t){J!==t&&(t===THREE.NormalBlending?Y.globalCompositeOperation="source-over":t===THREE.AdditiveBlending?Y.globalCompositeOperation="lighter":t===THREE.SubtractiveBlending&&(Y.globalCompositeOperation="darker"),J=t);}function u(t){et!==t&&(Y.lineWidth=t,et=t);}function d(t){rt!==t&&(Y.lineCap=t,rt=t);}function p(t){it!==t&&(Y.lineJoin=t,it=t);}function E(t){$!==t&&(Y.strokeStyle=t,$=t);}function f(t){tt!==t&&(Y.fillStyle=t,tt=t);}function m(t){nt.length!==t.length&&(Y.setLineDash(t),nt=t);}t=t||{};var g,T,v,y,R,H,x,b,_,M,w,S,C,L,A,P,k,I,F,U=this,D=new THREE.Projector(),B=void 0!==t.canvas?t.canvas:document.createElement("canvas"),V=B.width,N=B.height,O=Math.floor(V/2),z=Math.floor(N/2),G=0,j=0,W=V,X=N,q=1,Y=B.getContext("2d",{alpha:!0===t.alpha}),Z=new THREE.Color(0),Q=!0===t.alpha?0:1,K=1,J=0,$=null,tt=null,et=null,rt=null,it=null,nt=[],ot=(new THREE.RenderableVertex(),new THREE.RenderableVertex(),new THREE.Color()),at=(new THREE.Color(),new THREE.Color(),new THREE.Color(),new THREE.Color(),new THREE.Color()),st=new THREE.Color(),ht=new THREE.Color(),ct={},lt=new THREE.Box2(),ut=new THREE.Box2(),dt=new THREE.Box2(),pt=new THREE.Color(),Et=new THREE.Color(),ft=new THREE.Color(),mt=new THREE.Vector3(),gt=new THREE.Vector3(),Tt=new THREE.Vector3(),vt=new THREE.Matrix3();void 0===Y.setLineDash&&(Y.setLineDash=function(){}),this.domElement=B,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.getContext=function(){return Y;},this.getContextAttributes=function(){return Y.getContextAttributes();},this.getPixelRatio=function(){return q;},this.setPixelRatio=function(t){void 0!==t&&(q=t);},this.setSize=function(t,e,r){V=t*q,N=e*q,B.width=V,B.height=N,O=Math.floor(V/2),z=Math.floor(N/2),!1!==r&&(B.style.width=t+"px",B.style.height=e+"px"),lt.min.set(-O,-z),lt.max.set(O,z),ut.min.set(-O,-z),ut.max.set(O,z),K=1,J=0,$=null,tt=null,et=null,rt=null,it=null,this.setViewport(0,0,t,e);},this.setViewport=function(t,e,r,i){G=t*q,j=e*q,W=r*q,X=i*q;},this.setScissor=function(){},this.setScissorTest=function(){},this.setClearColor=function(t,e){Z.set(t),Q=void 0!==e?e:1,ut.min.set(-O,-z),ut.max.set(O,z);},this.setClearColorHex=function(t,e){console.warn("THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(t,e);},this.getClearColor=function(){return Z;},this.getClearAlpha=function(){return Q;},this.getMaxAnisotropy=function(){return 0;},this.clear=function(){!1===ut.isEmpty()&&(ut.intersect(lt),ut.expandByScalar(2),ut.min.x=ut.min.x+O,ut.min.y=-ut.min.y+z,ut.max.x=ut.max.x+O,ut.max.y=-ut.max.y+z,1>Q&&Y.clearRect(0|ut.min.x,0|ut.max.y,ut.max.x-ut.min.x|0,ut.min.y-ut.max.y|0),Q>0&&(l(THREE.NormalBlending),c(1),f("rgba("+Math.floor(255*Z.r)+","+Math.floor(255*Z.g)+","+Math.floor(255*Z.b)+","+Q+")"),Y.fillRect(0|ut.min.x,0|ut.max.y,ut.max.x-ut.min.x|0,ut.min.y-ut.max.y|0)),ut.makeEmpty());},this.clearColor=function(){},this.clearDepth=function(){},this.clearStencil=function(){},this.render=function(t,n){if(n instanceof THREE.Camera!=0){!0===this.autoClear&&this.clear(),U.info.render.vertices=0,U.info.render.faces=0,Y.setTransform(W/V,0,0,-X/N,G,N-j),Y.translate(O,z),g=D.projectScene(t,n,this.sortObjects,this.sortElements),T=g.elements,v=g.lights,n,vt.getNormalMatrix(n.matrixWorldInverse),function(){pt.setRGB(0,0,0),Et.setRGB(0,0,0),ft.setRGB(0,0,0);for(var t=0,e=v.length;e>t;t++){var r=v[t],i=r.color;r instanceof THREE.AmbientLight?pt.add(i):r instanceof THREE.DirectionalLight?Et.add(i):r instanceof THREE.PointLight&&ft.add(i);}}();for(var o=0,a=T.length;a>o;o++){var s=T[o],c=s.material;if(void 0!==c&&0!==c.opacity){if(dt.makeEmpty(),s instanceof THREE.RenderableSprite)(y=s).x*=O,y.y*=z,e(y,s,c);else if(s instanceof THREE.RenderableLine)y=s.v1,R=s.v2,y.positionScreen.x*=O,y.positionScreen.y*=z,R.positionScreen.x*=O,R.positionScreen.y*=z,dt.setFromPoints([y.positionScreen,R.positionScreen]),!0===lt.intersectsBox(dt)&&r(y,R,s,c);else if(s instanceof THREE.RenderableFace){if(y=s.v1,R=s.v2,H=s.v3,y.positionScreen.z<-1||y.positionScreen.z>1)continue;if(R.positionScreen.z<-1||R.positionScreen.z>1)continue;if(H.positionScreen.z<-1||H.positionScreen.z>1)continue;y.positionScreen.x*=O,y.positionScreen.y*=z,R.positionScreen.x*=O,R.positionScreen.y*=z,H.positionScreen.x*=O,H.positionScreen.y*=z,c.overdraw>0&&(h(y.positionScreen,R.positionScreen,c.overdraw),h(R.positionScreen,H.positionScreen,c.overdraw),h(H.positionScreen,y.positionScreen,c.overdraw)),dt.setFromPoints([y.positionScreen,R.positionScreen,H.positionScreen]),!0===lt.intersectsBox(dt)&&i(y,R,H,0,1,2,s,c);}ut.union(dt);}}Y.setTransform(1,0,0,1,0,0);}else console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");};},THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0,this.renderOrder=0;},THREE.RenderableFace=function(){this.id=0,this.v1=new THREE.RenderableVertex(),this.v2=new THREE.RenderableVertex(),this.v3=new THREE.RenderableVertex(),this.normalModel=new THREE.Vector3(),this.vertexNormalsModel=[new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3()],this.vertexNormalsLength=0,this.color=new THREE.Color(),this.material=null,this.uvs=[new THREE.Vector2(),new THREE.Vector2(),new THREE.Vector2()],this.z=0,this.renderOrder=0;},THREE.RenderableVertex=function(){this.position=new THREE.Vector3(),this.positionWorld=new THREE.Vector3(),this.positionScreen=new THREE.Vector4(),this.visible=!0;},THREE.RenderableVertex.prototype.copy=function(t){this.positionWorld.copy(t.positionWorld),this.positionScreen.copy(t.positionScreen);},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex(),this.v2=new THREE.RenderableVertex(),this.vertexColors=[new THREE.Color(),new THREE.Color()],this.material=null,this.z=0,this.renderOrder=0;},THREE.RenderableSprite=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new THREE.Vector2(),this.material=null,this.renderOrder=0;},THREE.Projector=function(){function t(){if(h===v){var t=new THREE.RenderableObject();return T.push(t),v++,h++,t;}return T[h++];}function e(){if(l===R){var t=new THREE.RenderableVertex();return y.push(t),R++,l++,t;}return y[l++];}function r(){if(d===x){var t=new THREE.RenderableFace();return H.push(t),x++,d++,t;}return H[d++];}function i(){if(E===_){var t=new THREE.RenderableLine();return b.push(t),_++,E++,t;}return b[E++];}function n(){if(m===w){var t=new THREE.RenderableSprite();return M.push(t),w++,m++,t;}return M[m++];}function o(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id!==e.id?t.id-e.id:0;}function a(t,e){var r=0,i=1,n=t.z+t.w,o=e.z+e.w,a=-t.z+t.w,s=-e.z+e.w;return n>=0&&o>=0&&a>=0&&s>=0||!(0>n&&0>o||0>a&&0>s)&&(0>n?r=Math.max(r,n/(n-o)):0>o&&(i=Math.min(i,n/(n-o))),0>a?r=Math.max(r,a/(a-s)):0>s&&(i=Math.min(i,a/(a-s))),!(r>i)&&(t.lerp(e,r),e.lerp(t,1-i),!0));}var s,h,c,l,u,d,p,E,f,m,g,T=[],v=0,y=[],R=0,H=[],x=0,b=[],_=0,M=[],w=0,S={objects:[],lights:[],elements:[]},C=new THREE.Vector3(),L=new THREE.Vector4(),A=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),P=new THREE.Box3(),k=new Array(3),I=(new Array(4),new THREE.Matrix4()),F=new THREE.Matrix4(),U=new THREE.Matrix4(),D=new THREE.Matrix3(),B=new THREE.Frustum(),V=new THREE.Vector4(),N=new THREE.Vector4();this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e);},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e);},this.pickingRay=function(t,e){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().");};var O=new function(){function t(t){var e=t.position,r=t.positionWorld,i=t.positionScreen;r.copy(e).applyMatrix4(g),i.copy(r).applyMatrix4(F);var n=1/i.w;i.x*=n,i.y*=n,i.z*=n,t.visible=i.x>=-1&&i.x<=1&&i.y>=-1&&i.y<=1&&i.z>=-1&&i.z<=1;}function n(t,e,r){return!0===t.visible||!0===e.visible||!0===r.visible||(k[0]=t.positionScreen,k[1]=e.positionScreen,k[2]=r.positionScreen,A.intersectsBox(P.setFromPoints(k)));}function o(t,e,r){return(r.positionScreen.x-t.positionScreen.x)*(e.positionScreen.y-t.positionScreen.y)-(r.positionScreen.y-t.positionScreen.y)*(e.positionScreen.x-t.positionScreen.x)<0;}var a=[],s=[],h=null,l=null,d=new THREE.Matrix3();return{setObject:function setObject(t){l=(h=t).material,d.getNormalMatrix(h.matrixWorld),a.length=0,s.length=0;},projectVertex:t,checkTriangleVisibility:n,checkBackfaceCulling:o,pushVertex:function pushVertex(r,i,n){(c=e()).position.set(r,i,n),t(c);},pushNormal:function pushNormal(t,e,r){a.push(t,e,r);},pushUv:function pushUv(t,e){s.push(t,e);},pushLine:function pushLine(t,e){var r=y[t],n=y[e];(p=i()).id=h.id,p.v1.copy(r),p.v2.copy(n),p.z=(r.positionScreen.z+n.positionScreen.z)/2,p.renderOrder=h.renderOrder,p.material=h.material,S.elements.push(p);},pushTriangle:function pushTriangle(t,e,i){var c=y[t],p=y[e],E=y[i];if(!1!==n(c,p,E)&&(l.side===THREE.DoubleSide||!0===o(c,p,E))){(u=r()).id=h.id,u.v1.copy(c),u.v2.copy(p),u.v3.copy(E),u.z=(c.positionScreen.z+p.positionScreen.z+E.positionScreen.z)/3,u.renderOrder=h.renderOrder,u.normalModel.fromArray(a,3*t),u.normalModel.applyMatrix3(d).normalize();for(var f=0;3>f;f++){var m=u.vertexNormalsModel[f];m.fromArray(a,3*arguments[f]),m.applyMatrix3(d).normalize(),u.uvs[f].fromArray(s,2*arguments[f]);}u.vertexNormalsLength=3,u.material=h.material,S.elements.push(u);}}};}();this.projectScene=function(c,T,v,R){d=0,E=0,m=0,S.elements.length=0,!0===c.autoUpdate&&c.updateMatrixWorld(),null===T.parent&&T.updateMatrixWorld(),I.copy(T.matrixWorldInverse.getInverse(T.matrixWorld)),F.multiplyMatrices(T.projectionMatrix,I),B.setFromMatrix(F),h=0,S.objects.length=0,S.lights.length=0,c.traverseVisible(function(e){if(e instanceof THREE.Light)S.lights.push(e);else if(e instanceof THREE.Mesh||e instanceof THREE.Line||e instanceof THREE.Sprite){if(!1===e.material.visible)return;(!1===e.frustumCulled||!0===B.intersectsObject(e))&&((s=t()).id=e.id,s.object=e,C.setFromMatrixPosition(e.matrixWorld),C.applyProjection(F),s.z=C.z,s.renderOrder=e.renderOrder,S.objects.push(s));}}),!0===v&&S.objects.sort(o);for(var H=0,x=S.objects.length;x>H;H++){var b=S.objects[H].object,_=b.geometry;if(O.setObject(b),g=b.matrixWorld,l=0,b instanceof THREE.Mesh){if(_ instanceof THREE.BufferGeometry){var M=_.attributes,w=_.groups;if(void 0===M.position)continue;for(var A=0,P=(yt=M.position.array).length;P>A;A+=3){O.pushVertex(yt[A],yt[A+1],yt[A+2]);}if(void 0!==M.normal){var k=M.normal.array;for(A=0,P=k.length;P>A;A+=3){O.pushNormal(k[A],k[A+1],k[A+2]);}}if(void 0!==M.uv){var z=M.uv.array;for(A=0,P=z.length;P>A;A+=2){O.pushUv(z[A],z[A+1]);}}if(null!==_.index){var G=_.index.array;if(w.length>0)for(H=0;H<w.length;H++){var j=w[H];for(A=j.start,P=j.start+j.count;P>A;A+=3){O.pushTriangle(G[A],G[A+1],G[A+2]);}}else for(A=0,P=G.length;P>A;A+=3){O.pushTriangle(G[A],G[A+1],G[A+2]);}}else for(A=0,P=yt.length/3;P>A;A+=3){O.pushTriangle(A,A+1,A+2);}}else if(_ instanceof THREE.Geometry){var W=_.vertices,X=_.faces,q=_.faceVertexUvs[0];D.getNormalMatrix(g);for(var Y=b.material,Z=Y instanceof THREE.MultiMaterial,Q=!0===Z?b.material:null,K=0,J=W.length;J>K;K++){var $=W[K];if(C.copy($),!0===Y.morphTargets)for(var tt=_.morphTargets,et=b.morphTargetInfluences,rt=0,it=tt.length;it>rt;rt++){var nt=et[rt];if(0!==nt){var ot=tt[rt].vertices[K];C.x+=(ot.x-$.x)*nt,C.y+=(ot.y-$.y)*nt,C.z+=(ot.z-$.z)*nt;}}O.pushVertex(C.x,C.y,C.z);}for(var at=0,st=X.length;st>at;at++){var ht=X[at];if(void 0!==(Y=!0===Z?Q.materials[ht.materialIndex]:b.material)){var ct=Y.side,lt=y[ht.a],ut=y[ht.b],dt=y[ht.c];if(!1!==O.checkTriangleVisibility(lt,ut,dt)){var pt=O.checkBackfaceCulling(lt,ut,dt);if(ct!==THREE.DoubleSide){if(ct===THREE.FrontSide&&!1===pt)continue;if(ct===THREE.BackSide&&!0===pt)continue;}(u=r()).id=b.id,u.v1.copy(lt),u.v2.copy(ut),u.v3.copy(dt),u.normalModel.copy(ht.normal),!1!==pt||ct!==THREE.BackSide&&ct!==THREE.DoubleSide||u.normalModel.negate(),u.normalModel.applyMatrix3(D).normalize();for(var Et=ht.vertexNormals,ft=0,mt=Math.min(Et.length,3);mt>ft;ft++){var gt=u.vertexNormalsModel[ft];gt.copy(Et[ft]),!1!==pt||ct!==THREE.BackSide&&ct!==THREE.DoubleSide||gt.negate(),gt.applyMatrix3(D).normalize();}u.vertexNormalsLength=Et.length;var Tt=q[at];if(void 0!==Tt)for(var vt=0;3>vt;vt++){u.uvs[vt].copy(Tt[vt]);}u.color=ht.color,u.material=Y,u.z=(lt.positionScreen.z+ut.positionScreen.z+dt.positionScreen.z)/3,u.renderOrder=b.renderOrder,S.elements.push(u);}}}}}else if(b instanceof THREE.Line){if(_ instanceof THREE.BufferGeometry){if(void 0!==(M=_.attributes).position){var yt;for(A=0,P=(yt=M.position.array).length;P>A;A+=3){O.pushVertex(yt[A],yt[A+1],yt[A+2]);}if(null!==_.index)for(A=0,P=(G=_.index.array).length;P>A;A+=2){O.pushLine(G[A],G[A+1]);}else{var Rt=b instanceof THREE.LineSegments?2:1;for(A=0,P=yt.length/3-1;P>A;A+=Rt){O.pushLine(A,A+1);}}}}else if(_ instanceof THREE.Geometry){if(U.multiplyMatrices(F,g),0===(W=b.geometry.vertices).length)continue;(lt=e()).positionScreen.copy(W[0]).applyMatrix4(U);for(Rt=b instanceof THREE.LineSegments?2:1,K=1,J=W.length;J>K;K++){(lt=e()).positionScreen.copy(W[K]).applyMatrix4(U),(K+1)%Rt>0||(ut=y[l-2],V.copy(lt.positionScreen),N.copy(ut.positionScreen),!0===a(V,N)&&(V.multiplyScalar(1/V.w),N.multiplyScalar(1/N.w),(p=i()).id=b.id,p.v1.positionScreen.copy(V),p.v2.positionScreen.copy(N),p.z=Math.max(V.z,N.z),p.renderOrder=b.renderOrder,p.material=b.material,b.material.vertexColors===THREE.VertexColors&&(p.vertexColors[0].copy(b.geometry.colors[K]),p.vertexColors[1].copy(b.geometry.colors[K-1])),S.elements.push(p)));}}}else if(b instanceof THREE.Sprite){L.set(g.elements[12],g.elements[13],g.elements[14],1),L.applyMatrix4(F);var Ht=1/L.w;L.z*=Ht,L.z>=-1&&L.z<=1&&((f=n()).id=b.id,f.x=L.x*Ht,f.y=L.y*Ht,f.z=L.z,f.renderOrder=b.renderOrder,f.object=b,f.rotation=b.rotation,f.scale.x=b.scale.x*Math.abs(f.x-(L.x+T.projectionMatrix.elements[0])/(L.w+T.projectionMatrix.elements[12])),f.scale.y=b.scale.y*Math.abs(f.y-(L.y+T.projectionMatrix.elements[5])/(L.w+T.projectionMatrix.elements[13])),f.material=b.material,S.elements.push(f));}}return!0===R&&S.elements.sort(o),S;};};var blockProcess=!0;jQuery(document).ready(function(t){if(t("body").hasClass("compose-mode")||t(".grcs_hero_container .front-content .container-mid .enter-animation").addClass("ivis"),t(window).on("load",function(){setTimeout(function(){t("#page-loader").hasClass("freeze")||t("#page-loader").addClass("hide-this"),setTimeout(function(){var e=0,r=t(".grcs_hero_container .front-content .container-mid .enter-animation").length;0!=r?t(".grcs_hero_container .front-content .container-mid .enter-animation").each(function(){var i=t(this),n=parseInt(i.attr("data-delay"));setTimeout(function(){i.removeClass("ivis"),--r||setTimeout(function(){blockProcess=!1,t(".grcs_bullet_nav").addClass("init"),t(".grcs_main_menu_button").addClass("init"),t("#canvas").addClass("init"),t(".grcs_youtube_controls").addClass("show"),t(".grcs_audio_player_toggle").addClass("show");},400);},e+=n);}):(t(".grcs_bullet_nav").addClass("init"),t(".grcs_main_menu_button").addClass("init"),t("#canvas").addClass("init"),t(".grcs_youtube_controls").addClass("show"),t(".grcs_audio_player_toggle").addClass("show"));},200);},600);}),t(".grcs_overlay").length>1&&(console.log("%c>Error: More than 1 Overlay Container found!","background: red; color: white;"),alert("Error: More than 1 Overlay Container found!")),t(".grcs_hero_container").length>1&&(console.log("%c Error: More than 1 Hero Container found!","background: red; color: white;"),alert(">Error: More than 1 Hero Container found!")),function(){if(0==t(".grcs_main_menu").length)return!1;t(".grcs_main_menu_button").click(function(){t("body").hasClass("grcs_menu_open")?t("body").removeClass("grcs_menu_open"):t("body").addClass("grcs_menu_open");}),t(".grcs_page_wrapper").click(function(){t("body").hasClass("grcs_menu_open")&&t("body").removeClass("grcs_menu_open");}),t(".grcs_main_menu li.menu-item-has-children").append('<span class="sub-trigger fa fa-angle-down"></span);'),t(".grcs_main_menu .menu").slicknav({label:"",prependTo:".grcs_main_menu",allowParentLinks:!0}),t(".grcs_main_menu_button").click(function(){t(".grcs_main_menu .menu").slicknav("toggle");});}(),t("#grcs_audio_player").length){var e=document.getElementById("grcs_audio_player"),r=!1;t(".grcs_audio_player_toggle").click(function(){r?e.pause():e.play();}),e.onplaying=function(){r=!0,t(".grcs_audio_player_toggle").removeClass("ti-control-play").addClass("ti-control-pause");},e.onpause=function(){r=!1,t(".grcs_audio_player_toggle").removeClass("ti-control-pause").addClass("ti-control-play");};}if(1==background_particle_effect_toggle&&"sphere"!=background_mode&&"waves"!=background_mode&&"space"!=background_mode&&"mesh"!=background_mode&&"abstract"!=background_mode&&"galaxy"!=background_mode&&"skyfall"!=background_mode&&"rain"!=background_mode&&1==background_parallax_effect_toggle)t(".grcs_background_content").parallax({scalarX:25,scalarY:15,frictionX:1.01-parseFloat(background_parallax_effect_friction_x),frictionY:1.01-parseFloat(background_parallax_effect_friction_y),invertX:parseFloat(background_parallax_effect_invert),invertY:parseFloat(background_parallax_effect_invert)});1==background_particle_effect_toggle&&"sphere"!=background_mode&&"waves"!=background_mode&&"space"!=background_mode&&"mesh"!=background_mode&&"abstract"!=background_mode&&"galaxy"!=background_mode&&"skyfall"!=background_mode&&"rain"!=background_mode&&function(){function e(e,r){var i=t(".grcs_background_content .level-1").width(),n=t(".grcs_background_content .level-1").height(),o=Math.round(i*n/24e3*(background_particle_effect_particle_amount/100)),a=t(e),s=e.getContext("2d"),h={star:{color:background_particle_effect_particle_color,width:1},line:{color:background_particle_effect_line_color,width:.2},position:{x:0,y:0},width:i,height:n,velocity:background_particle_effect_particle_speed/50,length:o,distance:120,radius:background_particle_effect_activation_radius,stars:[]},c=t.extend(!0,{},h,r);function l(){this.x=Math.random()*e.width,this.y=Math.random()*e.height,this.vx=c.velocity-.5*Math.random(),this.vy=c.velocity-.5*Math.random(),this.radius=Math.random()*c.star.width;}l.prototype={create:function create(){s.beginPath(),s.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),s.fill();},animate:function animate(){var t;for(t=0;t<c.length;t++){var r=c.stars[t];r.y<0||r.y>e.height?(r.vx=r.vx,r.vy=-r.vy):(r.x<0||r.x>e.width)&&(r.vx=-r.vx,r.vy=r.vy),r.x+=r.vx,r.y+=r.vy;}},line:function line(){var t,e,r,i,n=c.length;for(r=0;r<n;r++){for(i=0;i<n;i++){t=c.stars[r],e=c.stars[i],t.x-e.x<c.distance&&t.y-e.y<c.distance&&t.x-e.x>-c.distance&&t.y-e.y>-c.distance&&t.x-c.position.x<c.radius&&t.y-c.position.y<c.radius&&t.x-c.position.x>-c.radius&&t.y-c.position.y>-c.radius&&(s.beginPath(),s.moveTo(t.x,t.y),s.lineTo(e.x,e.y),s.stroke(),s.closePath());}}}},this.createStars=function(){var t,r,i=c.length;for(s.clearRect(0,0,e.width,e.height),r=0;r<i;r++){c.stars.push(new l()),(t=c.stars[r]).create();}t.line(),t.animate(),c.stars.splice(i,i);},this.setCanvas=function(){e.width=c.width,e.height=c.height,s.fillStyle=c.star.color,s.strokeStyle=c.line.color,s.lineWidth=c.line.width,r&&r.hasOwnProperty("position")||(c.position={x:.5*e.width,y:.5*e.height});},this.loop=function(t){t(),window.requestAnimationFrame(function(){this.loop(t);}.bind(this));},this.bind=function(){t(window).on("mousemove",function(t){c.position.x=t.pageX-a.offset().left,c.position.y=t.pageY-a.offset().top;});},this.init=function(){this.setCanvas(),this.loop(this.createStars),this.bind();};}t.fn.constellation=function(t){return this.each(function(){new e(this,t).init();});},t("#canvas canvas").constellation({});var r,i=(r={},function(t,e,i){i||(i="Don't call this twice without a uniqueId"),r[i]&&clearTimeout(r[i]),r[i]=setTimeout(t,e);});t(window).resize(function(){i(function(){t("#canvas canvas").constellation({});},500,"some unique string");});}();});var isMobile={Android:function Android(){return navigator.userAgent.match(/Android/i);},BlackBerry:function BlackBerry(){return navigator.userAgent.match(/BlackBerry/i);},iOS:function iOS(){return navigator.userAgent.match(/iPhone|iPad|iPod/i);},Opera:function Opera(){return navigator.userAgent.match(/Opera Mini/i);},Windows:function Windows(){return navigator.userAgent.match(/IEMobile/i);},any:function any(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows();}};isMobile.any()&&jQuery("body").addClass("is-mobile"),jQuery(document).ready(function(t){if(0!=t(".grcs_background_content").length)switch(background_mode){case"image":t(".bg-image").vegas({slides:[{src:background_image_image}],delay:10,transitionDuration:10,timer:!1});break;case"slider":t(".grcs_background_content .bg-image").vegas({slides:background_slider_slides,transition:background_slider_transition,delay:background_slider_timeout,transitionDuration:background_slider_transition_duration,firstTransitionDuration:1,timer:!1,walk:function walk(e,r){t(".grcs_text_slider").cycle("next");}});break;case"kenburns":t(".grcs_background_content .bg-image").vegas({slides:background_kenburns_slides,transition:background_kenburns_transition,delay:background_kenburns_timeout,transitionDuration:background_kenburns_transition_duration,firstTransitionDuration:1,timer:!1,animation:background_kenburns_effect,walk:function walk(e,r){t(".grcs_text_slider").cycle("next");}});break;case"youtube":!function(){if(jQuery.browser.mobile)t(".grcs_background_content .bg-image").vegas({slides:[{src:background_youtube_fallback_image}],delay:100,transitionDuration:100,timer:!1});else{1==background_youtube_controls&&t("body").append('<div class="grcs_youtube_controls"><i class="volume-button fa fa-volume-up"></i> <i class="pause-button ti-control-pause"></i></div>'),1==background_youtube_sound?background_youtube_sound=0:(background_youtube_sound=1,t(".grcs_youtube_controls .volume-button").removeClass("fa-volume-up").addClass("fa-volume-off")),t(".grcs_background_content .bg-video").append('<div id="bg-youtube" class="player showOn-video-bg"></div>'),t("#bg-youtube").attr("data-property",'{videoURL:background_youtube_url,containment:".bg-video",autoPlay:true,mute:background_youtube_sound,startAt: background_youtube_start_point,stopAt: background_youtube_end_point,opacity:1,stopMovieOnBlur:false,showControls:false,loop:true}'),t(".player").mb_YTPlayer(),t(".grcs_youtube_controls .volume-button").click(function(){t("#bg-youtube").hasClass("isMuted")?(t("#bg-youtube").YTPUnmute(),t(".grcs_youtube_controls .volume-button").removeClass("fa-volume-off").addClass("fa-volume-up")):(t("#bg-youtube").YTPMute(),t(".grcs_youtube_controls .volume-button").removeClass("fa-volume-up").addClass("fa-volume-off"));});var e=!0;t("#bg-youtube").on("YTPPause",function(){e=!1;}),t("#bg-youtube").on("YTPPlay",function(){e=!0;}),t(".grcs_youtube_controls .pause-button").click(function(){1==e?(t("#bg-youtube").YTPPause(),t(".grcs_youtube_controls .pause-button").removeClass("ti-control-pause").addClass("ti-control-play")):(t("#bg-youtube").YTPPlay(),t(".grcs_youtube_controls .pause-button").removeClass("ti-control-play").addClass("ti-control-pause"));}),t("#bg-youtube").on("YTPReady",function(e){setTimeout(function(){t("#bg-youtube").YTPPlay();},500);});}}();break;case"color":t(".grcs_background_content .bg-color").css("background",background_color_color),t(".grcs_background_content .bg-color").css("opacity","1"),t(".grcs_background_content .bg-pattern").remove(),t(".grcs_background_content .bg-overlay").remove();break;case"gradient":!function(){function e(t){t=t.replace("#","");var e=parseInt(t,16);return[e>>16&255,e>>8&255,255&e];}var r=new Array(e(background_gradient_color_1),e(background_gradient_color_2),e(background_gradient_color_3),e(background_gradient_color_4),e(background_gradient_color_5),e(background_gradient_color_6)),i=0,n=t(".grcs_background_content .bg-color"),o=[0,1,2,3],a=parseFloat(background_gradient_speed)/4e4;setInterval(function(){var t=r[o[0]],e=r[o[1]],s=r[o[2]],h=r[o[3]],c=1-i,l="rgb("+Math.round(c*t[0]+i*e[0])+","+Math.round(c*t[1]+i*e[1])+","+Math.round(c*t[2]+i*e[2])+")",u="rgb("+Math.round(c*s[0]+i*h[0])+","+Math.round(c*s[1]+i*h[1])+","+Math.round(c*s[2]+i*h[2])+")";n.css({background:"-webkit-gradient(linear, left top, right top, from("+l+"), to("+u+"))"}).css({background:"-moz-linear-gradient(left, "+l+" 0%, "+u+" 100%)"}),(i+=a)>=1&&(i%=1,o[0]=o[1],o[2]=o[3],o[1]=(o[1]+Math.floor(1+Math.random()*(r.length-1)))%r.length,o[3]=(o[3]+Math.floor(1+Math.random()*(r.length-1)))%r.length);},1),t(".grcs_background_content .bg-color").css("opacity","1"),t(".grcs_background_content .bg-pattern").remove(),t(".grcs_background_content .bg-overlay").remove();}();break;case"sphere":!function(){t(".grcs_background_content .bg-overlay").remove(),t(".grcs_background_content .bg-pattern").remove();var e,r,i,n=t(".grcs_background_content .level-1").width(),o=t(".grcs_background_content .level-1").height(),a=0,s=0,h=n/2,c=o/2;function l(){var r=t(".grcs_background_content .level-1").width(),n=t(".grcs_background_content .level-1").height();c=n/2,e.aspect=r/n,e.updateProjectionMatrix(),i.setSize(r,n);}function u(t){a=t.clientX-h,s=t.clientY-c;}!function(){var t,a;t=document.createElement("div"),document.getElementById("canvas").appendChild(t),(e=new THREE.PerspectiveCamera(75,n/o,1,1e4)).position.z=10*background_sphere_distance,r=new THREE.Scene(),(i=new THREE.CanvasRenderer()).setPixelRatio(window.devicePixelRatio),i.setSize(n,o),t.appendChild(i.domElement),i.setClearColor(background_sphere_background_color);for(var s=2*Math.PI,h=new THREE.SpriteCanvasMaterial({color:background_sphere_dot_color,program:function program(t){t.beginPath(),t.arc(0,0,.5,0,s,!0),t.fill();}}),c=0;c<1e3;c++){(a=new THREE.Sprite(h)).position.x=2*Math.random()-1,a.position.y=2*Math.random()-1,a.position.z=2*Math.random()-1,a.position.normalize(),a.position.multiplyScalar(10*Math.random()+450),a.scale.multiplyScalar(2),r.add(a);}for(var c=0;c<300;c++){var d=new THREE.Geometry(),p=new THREE.Vector3(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1);p.normalize(),p.multiplyScalar(450),d.vertices.push(p);var E=p.clone();E.multiplyScalar(.3*Math.random()+1),d.vertices.push(E);var f=new THREE.Line(d,new THREE.LineBasicMaterial({color:background_sphere_line_color,opacity:Math.random()}));r.add(f);}document.addEventListener("mousemove",u,!1),window.addEventListener("resize",l,!1);}(),function t(){requestAnimationFrame(t),e.position.x+=.05*(a-e.position.x),e.position.y+=.05*(200-s-e.position.y),e.lookAt(r.position),r.rotation.y+=background_sphere_rotation_speed/1e4,i.render(r,e);}();}();break;case"waves":!function(){t(".grcs_background_content .bg-overlay").remove(),t(".grcs_background_content .bg-pattern").remove();var e,r,i,n,o,a,s=background_waves_dot_spacing,h=background_waves_dot_amount_x,c=background_waves_dot_amount_y,l=t(".grcs_background_content .level-1").width(),u=t(".grcs_background_content .level-1").height(),d=0,p=0,E=0,f=l/2,m=u/2;function g(){var e=t(".grcs_background_content .level-1").width(),i=t(".grcs_background_content .level-1").height();f=e/2,m=i/2,r.aspect=e/i,r.updateProjectionMatrix(),n.setSize(e,i);}function T(t){p=t.clientX-f,E=t.clientY-m;}!function(){e=document.createElement("div"),document.getElementById("canvas").appendChild(e),(r=new THREE.PerspectiveCamera(75,l/u,1,1e4)).position.z=100*background_waves_distance,i=new THREE.Scene(),o=new Array();for(var t=2*Math.PI,d=new THREE.SpriteCanvasMaterial({color:background_waves_dot_color,program:function program(e){e.beginPath(),e.arc(0,0,.5,0,t,!0),e.fill();}}),p=0,E=0;E<h;E++){for(var f=0;f<c;f++){(a=o[p++]=new THREE.Sprite(d)).position.x=E*s-h*s/2,a.position.z=f*s-c*s/2,i.add(a);}}(n=new THREE.CanvasRenderer()).setPixelRatio(window.devicePixelRatio),n.setSize(l,u),e.appendChild(n.domElement),n.setClearColor(background_waves_background_color),document.addEventListener("mousemove",T,!1),window.addEventListener("resize",g,!1);}(),function t(){requestAnimationFrame(t),function(){r.position.x+=.05*(p-r.position.x),r.position.y+=.05*(-E-r.position.y),r.lookAt(i.position);for(var t=0,e=0;e<h;e++){for(var s=0;s<c;s++){(a=o[t++]).position.y=Math.sin(.3*(e+d))*background_waves_dot_intensity*5+Math.sin(.5*(s+d))*background_waves_dot_intensity*5,a.scale.x=a.scale.y=(Math.sin(.3*(e+d))+1)*(background_waves_dot_expansion/1.25)+(Math.sin(.5*(s+d))+1)*(background_waves_dot_expansion/1.25);}}n.render(i,r),d+=.1;}();}();}();break;case"mesh":!function(){var e,r,i,n,o,a,s,h,c,l,u,d,p,E,f;function m(t){this.x=t.x,this.y=t.y,this.xBase=this.x,this.yBase=this.y,this.offset=g(0,1e3),this.duration=g(20,60),this.range=g(5,5),this.dir=g(0,1)>.5?1:-1,this.rad=g(2,4);}function g(t,e){return Math.random()*(e-t)+t;}function T(){i=t(".grcs_background_content .level-1").width(),n=t(".grcs_background_content .level-1").height(),e.width=i,e.height=n,l.x=i/2,l.y=n/2,u=!1,d=0,p=0,E.length=0,f=0,function(){for(var t=-o/2;t<i+o;t+=o){d++;for(var e=-o/2;e<n+o;e+=o){t==-o/2&&p++,E.push(new m({x:~~(t+g(-a,a)),y:~~(e+g(-a,a))}));}}}(),r.strokeStyle=background_mesh_line_color,r.lineWidth=2;}function v(){requestAnimationFrame(v),u||(l.x=i/2+90*Math.cos(f/40),l.y=n/2+90*Math.sin(f/40)),E.forEach(function(t){t.step();}),f++,function(){r.clearRect(0,0,i,n),r.beginPath();for(var t=0;t<d;t++){for(var e=0;e<p;e++){s=E[t*p+e],h=t===d-1?null:E[(t+1)*p+e],c=e===p-1?null:E[t*p+e+1],h&&(r.moveTo(s.x,s.y),r.lineTo(h.x,h.y)),c&&(r.moveTo(s.x,s.y),r.lineTo(c.x,c.y));}}r.stroke(),r.fillStyle="red",E.forEach(function(t){r.save(),r.beginPath(),r.translate(t.x,t.y),r.rotate(Math.PI/4),r.rect(0,0,0,0),r.fill(),r.stroke(),r.restore();});var o=r.createRadialGradient(l.x,l.y,0,l.x,l.y,background_mesh_spotlight_size);o.addColorStop(0,"hsla(0, 0%, 0%, 0.1)"),o.addColorStop(1,"hsla(0, 0%, 0%, 0.96)"),r.fillStyle=o,r.fillRect(0,0,i,n);}();}m.prototype.step=function(){this.x=this.xBase+this.dir*Math.sin((f+this.offset)/this.duration)*this.range,this.y=this.yBase+this.dir*Math.cos((f+this.offset)/this.duration)*this.range;var t,e,r,i,n=(e=l,r=(t=this).x-e.x,i=t.y-e.y,Math.atan2(i,r));this.x=this.x+100*Math.cos(n),this.y=this.y+100*Math.sin(n);},window.addEventListener("resize",T),window.addEventListener("mousemove",function(t){u=!0,l.x=t.pageX,l.y=t.pageY;}),e=document.createElement("canvas"),r=e.getContext("2d"),l={x:0,y:0},E=[],o=parseFloat(background_mesh_line_mesh_size),a=.22*o,document.getElementById("canvas").appendChild(e),T(),v(),t(".grcs_background_content .bg-overlay").remove(),t(".grcs_background_content .bg-pattern").remove();}();break;case"space":t(".grcs_background_content .bg-pattern").remove(),function(t,e,r,i){var n,o,a,s=function s(e,r){this.el=e,this.$el=t(e),this.options=r,a=this;},h=!1,c=!1;!function(){for(var t=0,r=["ms","moz","webkit","o"],i=0;i<r.length&&!e.requestAnimationFrame;++i){e.requestAnimationFrame=e[r[i]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[r[i]+"CancelAnimationFrame"]||e[r[i]+"CancelRequestAnimationFrame"];}e.requestAnimationFrame||(e.requestAnimationFrame=function(r,i){var n=new Date().getTime(),o=Math.max(0,16-(n-t)),a=e.setTimeout(function(){r(n+o);},o);return t=n+o,a;}),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(t){clearTimeout(t);});}(),s.prototype={defaults:{starColor:background_space_star_color,bgColor:background_space_background_color,mouseMove:parseFloat(background_space_mouse_interaction),speed:background_space_star_speed/20,quantity:background_space_star_amount,ratio:background_space_star_amount/2,divclass:"starfield"},resizer:function resizer(){var t=this.star,e=this.context.canvas.width,r=this.context.canvas.height;this.w=this.$el.width(),this.h=this.$el.height(),this.x=Math.round(this.w/2),this.y=Math.round(this.h/2);var i=this.w/e,n=this.h/r;this.context.canvas.width=this.w,this.context.canvas.height=this.h;for(var o=0;o<this.n;o++){this.star[o][0]=t[o][0]*i,this.star[o][1]=t[o][1]*n,this.star[o][3]=this.x+this.star[o][0]/this.star[o][2]*this.star_ratio,this.star[o][4]=this.y+this.star[o][1]/this.star[o][2]*this.star_ratio;}a.context.fillStyle=a.settings.bgColor,this.context.strokeStyle=this.settings.starColor;},init:function init(){this.settings=t.extend({},this.defaults,this.options),r.location.href,this.n=parseInt(this.settings.quantity),this.flag=!0,this.test=!0,this.w=0,this.h=0,this.x=0,this.y=0,this.z=0,this.star_color_ratio=0,this.star_x_save=0,this.star_y_save=0,this.star_ratio=this.settings.ratio,this.star_speed=this.settings.speed,this.star_speed_save=0,this.star=new Array(this.n),this.color=this.settings.starColor,this.opacity=.1,this.cursor_x=0,this.cursor_y=0,this.mouse_x=0,this.mouse_y=0,this.canvas_x=0,this.canvas_y=0,this.canvas_w=0,this.canvas_h=0,this.fps=this.settings.fps,this.desktop=!navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|BB10|IEMobile)/),this.orientationSupport=void 0!==e.DeviceOrientationEvent,this.portrait=null,a.w=a.$el.width(),a.h=a.$el.height(),a.initW=a.w,a.initH=a.h,a.portrait=a.w<a.h,a.wrapper=t("<canvas />").addClass(a.settings.divclass),a.wrapper.appendTo(a.el),a.starz=t("canvas",a.el),a.starz[0].getContext&&(a.context=a.starz[0].getContext("2d"),c=!0),a.context.canvas.width=a.w,a.context.canvas.height=a.h,function(){if(c){a.x=Math.round(a.w/2),a.y=Math.round(a.h/2),a.z=(a.w+a.h)/2,a.star_color_ratio=1/a.z,a.cursor_x=a.x,a.cursor_y=a.y;for(var t=0;t<a.n;t++){a.star[t]=new Array(5),a.star[t][0]=Math.random()*a.w*2-2*a.x,a.star[t][1]=Math.random()*a.h*2-2*a.y,a.star[t][2]=Math.round(Math.random()*a.z),a.star[t][3]=0,a.star[t][4]=0;}a.context.fillStyle=a.settings.bgColor,a.context.strokeStyle=a.settings.starColor;}}(),h=!0;},anim:function anim(){this.mouse_x=this.cursor_x-this.x,this.mouse_y=this.cursor_y-this.y,this.context.fillRect(0,0,this.w,this.h);for(var t=0;t<this.n;t++){this.test=!0,this.star_x_save=this.star[t][3],this.star_y_save=this.star[t][4],this.star[t][0]+=this.mouse_x>>4,this.star[t][0]>this.x<<1&&(this.star[t][0]-=this.w<<1,this.test=!1),this.star[t][0]<-this.x<<1&&(this.star[t][0]+=this.w<<1,this.test=!1),this.star[t][1]+=this.mouse_y>>4,this.star[t][1]>this.y<<1&&(this.star[t][1]-=this.h<<1,this.test=!1),this.star[t][1]<-this.y<<1&&(this.star[t][1]+=this.h<<1,this.test=!1),this.star[t][2]-=this.star_speed,this.star[t][2]>this.z&&(this.star[t][2]-=this.z,this.test=!1),this.star[t][2]<0&&(this.star[t][2]+=this.z,this.test=!1),this.star[t][3]=this.x+this.star[t][0]/this.star[t][2]*this.star_ratio,this.star[t][4]=this.y+this.star[t][1]/this.star[t][2]*this.star_ratio,this.star_x_save>0&&this.star_x_save<this.w&&this.star_y_save>0&&this.star_y_save<this.h&&this.test&&(this.context.lineWidth=2*(1-this.star_color_ratio*this.star[t][2]),this.context.beginPath(),this.context.moveTo(this.star_x_save,this.star_y_save),this.context.lineTo(this.star[t][3],this.star[t][4]),this.context.stroke(),this.context.closePath());}},loop:function loop(){this.anim(),o=e.requestAnimationFrame(function(){a.loop();});},move:function move(){var t=r.documentElement;this.orientationSupport&&!this.desktop?e.addEventListener("deviceorientation",function(t){if(null!==t.beta&&null!==t.gamma){var e=t.gamma,r=t.beta;a.portrait||(e=-1*t.beta,r=t.gamma),a.cursor_x=a.w/2+5*e,a.cursor_y=a.h/2+5*r;}},!1):e.addEventListener("mousemove",function(e){a.cursor_x=e.pageX||e.clientX+t.scrollLeft-t.clientLeft,a.cursor_y=e.pageY||e.clientY+t.scrollTop-t.clientTop;},!1);},stop:function stop(){e.cancelAnimationFrame(o),n=!1;},start:function start(){return h||(h=!0,this.init()),n||(n=!0,this.loop()),e.addEventListener("resize",function(){a.resizer();},!1),e.addEventListener("orientati onchange",function(){a.resizer();},!1),this.settings.mouseMove&&this.move(),this;}},s.defaults=s.prototype.defaults,t.fn.starfield=function(t){return this.each(function(){new s(this,t).start();});},e.Starfield=s;}(jQuery,window,document),t("#canvas").starfield();break;case"abstract":!function(){t(".grcs_background_content .bg-pattern").remove(),t(".grcs_background_content .bg-overlay").remove();var e,r,i,n,o,a,s,h=setInterval(function(){t(".grcs_background_content .level-1 #canvas").offset().top<=50&&(t(".grcs_background_content .level-1 #canvas").css({WebkitTransition:"all .4s",transition:"all .4s"}),t(".grcs_background_content .level-1 #canvas").css("background",background_abstract_background_color),clearInterval(h));},50),c={width:background_abstract_shader_width/100,height:1.8,depth:60,segments:9,slices:8,xRange:background_abstract_width_expansion,yRange:.1,zRange:1,ambient:"#666666",diffuse:"#fff",speed:background_abstract_move_speed/1e4},l={count:2,xyScalar:1,zOffset:100,ambient:"#fff",diffuse:"#b3b3b3",speed:2e-4,gravity:500,dampening:.95,minLimit:10,maxLimit:null,minDistance:20,maxDistance:400,autopilot:!0,draw:!1,bounds:FSS.Vector3.create(),step:FSS.Vector3.create(Math.randomInRange(.2,1),Math.randomInRange(.2,1),Math.randomInRange(.2,1))},u={renderer:"canvas"},d=Date.now(),p=FSS.Vector3.create(),E=FSS.Vector3.create(),f=document.getElementById("canvas"),m=document.getElementById("canvas");function g(){var t,e;for(i.remove(n),r.clear(),o=new FSS.Plane(c.width*r.width,c.height*r.height,c.segments,c.slices),a=new FSS.Material(c.ambient,c.diffuse),n=new FSS.Mesh(o,a),i.add(n),t=o.vertices.length-1;t>=0;t--){(e=o.vertices[t]).anchor=FSS.Vector3.clone(e.position),e.step=FSS.Vector3.create(Math.randomInRange(.2,1),Math.randomInRange(.2,1),Math.randomInRange(.2,1)),e.time=Math.randomInRange(0,Math.PIM2);}}function T(t,e){r.setSize(t,e),FSS.Vector3.set(p,r.halfWidth,r.halfHeight),g();}function v(){e=Date.now()-d,function(){var t,r,n,a,s,h,u,d=c.depth/2;for(FSS.Vector3.copy(l.bounds,p),FSS.Vector3.multiplyScalar(l.bounds,l.xyScalar),FSS.Vector3.setZ(E,l.zOffset),l.autopilot&&(t=Math.sin(l.step[0]*e*l.speed),r=Math.cos(l.step[1]*e*l.speed),FSS.Vector3.set(E,l.bounds[0]*t,l.bounds[1]*r,l.zOffset)),a=i.lights.length-1;a>=0;a--){s=i.lights[a],FSS.Vector3.setZ(s.position,l.zOffset);var f=Math.clamp(FSS.Vector3.distanceSquared(s.position,E),l.minDistance,l.maxDistance),m=l.gravity*s.mass/f;FSS.Vector3.subtractVectors(s.force,E,s.position),FSS.Vector3.normalise(s.force),FSS.Vector3.multiplyScalar(s.force,m),FSS.Vector3.set(s.acceleration),FSS.Vector3.add(s.acceleration,s.force),FSS.Vector3.add(s.velocity,s.acceleration),FSS.Vector3.multiplyScalar(s.velocity,l.dampening),FSS.Vector3.limit(s.velocity,l.minLimit,l.maxLimit),FSS.Vector3.add(s.position,s.velocity);}for(h=o.vertices.length-1;h>=0;h--){u=o.vertices[h],t=Math.sin(u.time+u.step[0]*e*c.speed),r=Math.cos(u.time+u.step[1]*e*c.speed),n=Math.sin(u.time+u.step[2]*e*c.speed),FSS.Vector3.set(u.position,c.xRange*o.segmentWidth*t,c.yRange*o.sliceHeight*r,c.zRange*d*n-d),FSS.Vector3.add(u.position,u.anchor);}o.dirty=!0;}(),y(),requestAnimationFrame(v);}function y(){var t,e,n,o;if(r.render(i),l.draw)for(t=i.lights.length-1;t>=0;t--){e=(o=i.lights[t]).position[0],n=o.position[1],r.context.lineWidth=.5,r.context.beginPath(),r.context.arc(e,n,10,0,Math.PIM2),r.context.strokeStyle=o.ambientHex,r.context.stroke(),r.context.beginPath(),r.context.arc(e,n,4,0,Math.PIM2),r.context.fillStyle=o.diffuseHex,r.context.fill();}}function R(t){T(f.offsetWidth,f.offsetHeight),y();}if(s=new FSS.CanvasRenderer(),u.renderer,r&&m.removeChild(r.element),(r=s).setSize(f.offsetWidth,f.offsetHeight),m.appendChild(r.element),i=new FSS.Scene(),g(),function(){var t,e;for(t=i.lights.length-1;t>=0;t--){e=i.lights[t],i.remove(e);}for(r.clear(),t=0;t<l.count;t++){(e=new FSS.Light(l.ambient,l.diffuse)).ambientHex=e.ambient.format(),e.diffuseHex=e.diffuse.format(),i.add(e),e.mass=Math.randomInRange(.5,1),e.velocity=FSS.Vector3.create(),e.acceleration=FSS.Vector3.create(),e.force=FSS.Vector3.create(),e.ring=document.createElementNS(FSS.SVGNS,"circle"),e.ring.setAttributeNS(null,"stroke",e.ambientHex),e.ring.setAttributeNS(null,"stroke-width","0.5"),e.ring.setAttributeNS(null,"fill","none"),e.ring.setAttributeNS(null,"r","10"),e.core=document.createElementNS(FSS.SVGNS,"circle"),e.core.setAttributeNS(null,"fill",e.diffuseHex),e.core.setAttributeNS(null,"r","4");}}(),window.addEventListener("resize",R),T(f.offsetWidth,f.offsetHeight),v(),canvas.getContext){var H=canvas.getContext("2d"),x=!0;canvas.height=screen.height-60,canvas.width=screen.width+20,initialize(),initialize(),setInterval(function(){for(var t=1;t<=1e3;t++){H.beginPath(),x?(H.moveTo(0,randomize(canvas.height+10)),x=!1):(H.moveTo(randomize(canvas.width+10),0),x=!0),H.lineTo(randomize(canvas.width+50),randomize(canvas.height+50)),H.lineTo(randomize(canvas.width+50),randomize(canvas.height+50)),H.fillStyle=getRndColor(),H.fill();}},5e3);}}();break;case"glitch":e="background-image: url('"+background_glitch_image+"')",t(".grcs_background_content .level-2 .bg-image").append('<div class="glitch-img" style="'+e+'"></div>'),t(".grcs_background_content .glitch-img").mgGlitch({destroy:!1,glitch:!0,scale:Boolean(background_glitch_scale_toggle),blend:!0,blendModeType:"hue",glitch1TimeMin:600,glitch1TimeMax:900,glitch2TimeMin:10,glitch2TimeMax:115,zIndexStart:8});break;case"rain":!function(){var e=t("#canvas canvas")[0];if(t("#canvas canvas").css("background",background_rain_background_color),e.width=window.innerWidth,e.height=window.innerHeight,e.getContext){var r=e.getContext("2d"),i=e.width,n=e.height;r.strokeStyle=background_rain_color,r.lineWidth=background_rain_thickness,r.lineCap="round";for(var o=[],a=background_rain_amount,s=0;s<a;s++){o.push({x:Math.random()*i,y:Math.random()*n,l:1*Math.random(),xs:4*Math.random()-4+2,ys:10*Math.random()+10});}for(var h=[],c=0;c<a;c++){h[c]=o[c];}setInterval(function(){r.clearRect(0,0,i,n);for(var t=0;t<h.length;t++){var e=h[t];r.beginPath(),r.moveTo(e.x,e.y),r.lineTo(e.x+e.l*e.xs,e.y+e.l*e.ys),r.stroke();}!function(){for(var t=0;t<h.length;t++){var e=h[t];e.x+=e.xs,e.y+=e.ys,(e.x>i||e.y>n)&&(e.x=Math.random()*i,e.y=-20);}}();},26);}}();break;case"skyfall":!function(){t("#canvas canvas").attr("id","skyfallCanvas");var e=document.getElementById("skyfallCanvas"),r=e.getContext("2d"),i=e.width=window.innerWidth,n=e.height=window.innerHeight,o="rgba(0, 0, 0, .1)",a=background_skyfall_amount,s=function(t){t=t.replace("#","");var e=parseInt(t,16);return(e>>16&255)+","+(e>>8&255)+","+(255&e);}(background_skyfall_color),h=[];function c(t,e){return Math.random()*(e-t)+t;}function l(){}l.prototype={init:function init(){this.x=c(0,i),this.y=0,this.color="rgb("+s+")",this.w=2,this.h=1,this.vy=c(4,5),this.vw=3,this.vh=1,this.size=2,this.hit=c(.8*n,.9*n),this.a=1,this.va=.96;},draw:function draw(){this.y>this.hit?(r.beginPath(),r.moveTo(this.x,this.y-this.h/2),r.bezierCurveTo(this.x+this.w/2,this.y-this.h/2,this.x+this.w/2,this.y+this.h/2,this.x,this.y+this.h/2),r.bezierCurveTo(this.x-this.w/2,this.y+this.h/2,this.x-this.w/2,this.y-this.h/2,this.x,this.y-this.h/2),r.strokeStyle="rgba("+s+","+this.a+")",r.stroke(),r.closePath()):(r.fillStyle=this.color,r.fillRect(this.x,this.y,this.size,5*this.size)),this.update();},update:function update(){this.y<this.hit?this.y+=this.vy:this.a>.03?(this.w+=this.vw,this.h+=this.vh,this.w>100&&(this.a*=this.va,this.vw*=.98,this.vh*=.98)):this.init();}},window.addEventListener("resize",function(){i=e.width=window.innerWidth,n=e.height=window.innerHeight;}),function(){for(var t=0;t<a;t++){setTimeout(function(){var t=new l();t.init(),h.push(t);},200*t);}}(),function t(){for(var e in r.fillStyle=o,r.fillRect(0,0,i,n),h){h[e].draw();}requestAnimationFrame(t);}();}();break;case"galaxy":!function(){t("#canvas canvas").attr("id","canvasGalaxy");var e=document.getElementById("canvasGalaxy");t=e.getContext("2d");var r=e.height=window.innerHeight,i=e.width=window.innerWidth,n=function(t){t=t.replace("#","");var e=parseInt(t,16);return(e>>16&255)+","+(e>>8&255)+","+(255&e);}(background_galaxy_background_color),o=function o(t){return Math.random()*t;},a=new Array(background_galaxy_star_amount).fill().map(function(){return{r:o(i),s:o(.01),a:o(2*Math.PI)};});!function e(){t.fillStyle="rgba("+n+",.1)",t.fillRect(0,0,i,r),a.forEach(function(e){e.a+=e.s,t.save(),t.beginPath(),t.translate(i/2,r/2),t.rotate(e.a),t.arc(e.r,e.r,background_galaxy_star_thickness,0,2*Math.PI),t.closePath(),t.fillStyle=background_galaxy_star_color,t.fill(),t.restore();}),requestAnimationFrame(e);}(),window.addEventListener("resize",function(t){i=e.width=window.innerWidth,r=e.height=window.innerHeight;});}();break;case"custom":break;default:alert("Error! No background is set or something went wrong"),console.log("Error! No background is set or something went wrong");}var e;});